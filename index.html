<!DOCTYPE html>
<html lang="zh-CN" data-theme="light" style="--base-font: 12px;"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="systemTitle">‰∫åÊàø‰∏ú‰ºÅ‰∏öÊî∂ÁßüÁ≥ªÁªü Pro</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- ÂµåÂÖ•ÂºèÊï∞ÊçÆÂ≠òÂÇ®Âå∫ -->
    <script id="EMBEDDED_DATA" type="application/json">{"rooms":[{"id":1768245439011,"building":"Á¥´ËôπÂòâËãë","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1600,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2024/11/30 - 2025/11/29","notes":""},{"id":1768245439012,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"3Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/02/28 - 2026/02/28","notes":""},{"id":1768245439013,"building":"ÈáëÊú∫1906","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3500,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/04/28 - 2026/04/27","notes":""},{"id":1768245439014,"building":"ÈáëÊú∫2403-2404","room":"2403-B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/06/01 - 2026/05/30","notes":""},{"id":1768245439015,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1900,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/06/01 - 2026/05/30","notes":""},{"id":1768245439016,"building":"Èì∂Â∫ß","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/08/28 - 2026/08/27","notes":""},{"id":1768245439017,"building":"Â∫êËÆØ2106","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/11/01 - 2026/10/30","notes":""},{"id":1768245439018,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2200,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/10/01 - 2026/09/30","notes":""},{"id":1768245439019,"building":"Èì∂Â∫ß","room":"G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3600,"baseCost":0,"nextPayDate":"2025-12-28","status":1,"payCount":0,"contractPeriod":"2025/11/01 - 2026/05/30","notes":""},{"id":1768245439020,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2350,"baseCost":0,"nextPayDate":"2025-12-30","status":1,"payCount":0,"contractPeriod":"2025/06/02 - 2026/06/01","notes":""},{"id":1768245439021,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2025-12-30","status":1,"payCount":0,"contractPeriod":"2025/07/01 - 2026/6/31","notes":""},{"id":1768245439022,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2006-A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-01","status":1,"payCount":0,"contractPeriod":"2023/10/21 - 2024/10/20","notes":""},{"id":1768245439023,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"Y","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2026-01-01","status":1,"payCount":0,"contractPeriod":"2025/06/03 - 2026/06/02","notes":""},{"id":1768245439024,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"2Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2100,"baseCost":0,"nextPayDate":"2026-01-01","status":1,"payCount":0,"contractPeriod":"2024/07/02 - 2025/07/01","notes":""},{"id":1768245439025,"building":"ÈáëÊú∫2403-2404","room":"2404-A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2000,"baseCost":0,"nextPayDate":"2026-01-01","status":1,"payCount":0,"contractPeriod":"2022/12/01 - 2023/05/31","notes":""},{"id":1768245439026,"building":"Á¥´ËôπÂòâËãë","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"2026-01-01","status":1,"payCount":0,"contractPeriod":"2024/10/01 - 2025/09/30","notes":""},{"id":1768245439027,"building":"ÈáëÊú∫1906","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2600,"baseCost":0,"nextPayDate":"2026-01-01","status":1,"payCount":0,"contractPeriod":"2024/12/01 - 2025/05/30","notes":""},{"id":1768245439028,"building":"Á¥´ËôπÂòâËãë","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3200,"baseCost":0,"nextPayDate":"2026-01-02","status":1,"payCount":0,"contractPeriod":"2024/08/01 - 2024/12/01","notes":""},{"id":1768245439029,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2007-A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"2026-01-02","status":1,"payCount":0,"contractPeriod":"2025/09/03 - 2026/09/02","notes":""},{"id":1768245439030,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"5Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2026-01-02","status":1,"payCount":0,"contractPeriod":"2025/11/05 - 2026/05/04","notes":""},{"id":1768245439031,"building":"Ëä±Âõ≠Âüé","room":"Ëä±Âõ≠Âüé","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":27000,"baseCost":0,"nextPayDate":"2026-01-02","status":1,"payCount":0,"contractPeriod":"2025/11/08 - 2026/11/07","notes":""},{"id":1768245439032,"building":"ÈáëÊú∫2403-2404","room":"2404-E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2600,"baseCost":0,"nextPayDate":"2026-01-03","status":1,"payCount":0,"contractPeriod":"2022/12/03 - 2023/12/02","notes":""},{"id":1768245439033,"building":"Èì∂Â∫ß","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3400,"baseCost":0,"nextPayDate":"2026-01-03","status":1,"payCount":0,"contractPeriod":"2025/10/06 - 2026/10/05","notes":""},{"id":1768245439034,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2026-01-04","status":1,"payCount":0,"contractPeriod":"2024/11/04 - 2025/11/03","notes":""},{"id":1768245439035,"building":"ÈáëÊú∫1903","room":"3Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-04","status":1,"payCount":0,"contractPeriod":"2024/07/04 - 2025/07/03","notes":""},{"id":1768245439036,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"H","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1700,"baseCost":0,"nextPayDate":"2026-01-04","status":1,"payCount":0,"contractPeriod":"2025/04/04 - 2026/04/03","notes":""},{"id":1768245439037,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"8Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2000,"baseCost":0,"nextPayDate":"2026-01-04","status":1,"payCount":0,"contractPeriod":"2023/09/05 - 2024/09/04","notes":""},{"id":1768245439038,"building":"ÈáëÊú∫1903","room":"1Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2026-01-04","status":1,"payCount":0,"contractPeriod":"2025/09/05 - 2026/09/04","notes":""},{"id":1768245439039,"building":"Â∫êËÆØ702","room":"5Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1400,"baseCost":0,"nextPayDate":"2026-01-05","status":1,"payCount":0,"contractPeriod":"2023/07/05 - 2024/07/04","notes":""},{"id":1768245439040,"building":"ÈáëÊú∫2403-2404","room":"2403-F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1850,"baseCost":0,"nextPayDate":"2026-01-05","status":1,"payCount":0,"contractPeriod":"2023/06/04 - 2024/06/03","notes":""},{"id":1768245439041,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2006-D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3700,"baseCost":0,"nextPayDate":"2026-01-05","status":1,"payCount":0,"contractPeriod":"2022/10/05 - 2023/10/04","notes":""},{"id":1768245439042,"building":"Ê∞¥ÁîµË∑Ø1402","room":"Ê∞¥ÁîµË∑Ø1402","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":5700,"baseCost":0,"nextPayDate":"2026-01-05","status":1,"payCount":0,"contractPeriod":"2025/10/10 - 2026/10/09","notes":""},{"id":1768245439043,"building":"Á¥´ËôπÂòâËãë","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1750,"baseCost":0,"nextPayDate":"2026-01-06","status":1,"payCount":0,"contractPeriod":"2024/08/06 - 2025/06/05","notes":""},{"id":1768245439044,"building":"ÈáëÊú∫1906","room":"G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1400,"baseCost":0,"nextPayDate":"2026-01-07","status":1,"payCount":0,"contractPeriod":"2025/05/07 - 2026/05/06","notes":""},{"id":1768245439045,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2007-E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3400,"baseCost":0,"nextPayDate":"2026-01-08","status":1,"payCount":0,"contractPeriod":"2025/11/10 - 2026/11/09","notes":""},{"id":1768245439046,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2100,"baseCost":0,"nextPayDate":"2026-01-08","status":1,"payCount":0,"contractPeriod":"2025/02/08 - 2026/02/07","notes":""},{"id":1768245439047,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2007-C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3500,"baseCost":0,"nextPayDate":"2026-01-08","status":1,"payCount":0,"contractPeriod":"2025/02/08 - 2026/02/07","notes":""},{"id":1768245439048,"building":"ÈáëÊú∫2403-2404","room":"2404-G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1800,"baseCost":0,"nextPayDate":"2026-01-09","status":1,"payCount":0,"contractPeriod":"2023/02/09 - 2024/02/08","notes":""},{"id":1768245439049,"building":"ÈáëÊú∫1906","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1600,"baseCost":0,"nextPayDate":"2026-01-09","status":1,"payCount":0,"contractPeriod":"2025/09/12 - 2026/09/11","notes":""},{"id":1768245439050,"building":"Â∫êËÆØ702","room":"6Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2026-01-10","status":1,"payCount":0,"contractPeriod":"2024/12/10 - 2025/12/09","notes":""},{"id":1768245439051,"building":"ËôπÂè∂Ëä±Ëãë","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3500,"baseCost":0,"nextPayDate":"2026-01-10","status":1,"payCount":0,"contractPeriod":"2025/04/10 - 2026/04/09","notes":""},{"id":1768245439052,"building":"Èì∂Â∫ß","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3700,"baseCost":0,"nextPayDate":"2026-01-10","status":1,"payCount":0,"contractPeriod":"2025/05/10 - 2026/05/09","notes":""},{"id":1768245439053,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1800,"baseCost":0,"nextPayDate":"2026-01-10","status":1,"payCount":0,"contractPeriod":"2025/09/11 - 2026/09/10","notes":""},{"id":1768245439054,"building":"ÈáëÊú∫2403-2404","room":"2403-A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1700,"baseCost":0,"nextPayDate":"2026-01-11","status":1,"payCount":0,"contractPeriod":"2024/10/11 - 2025/10/10","notes":""},{"id":1768245439055,"building":"Â∫êËÆØ2106","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2025/08/12 - 2026/08/11","notes":""},{"id":1768245439056,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"4Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1300,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2023/11/12 - 2024/05/11","notes":""},{"id":1768245439057,"building":"ËôπÂè∂Ëä±Ëãë","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2000,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2025/02/12 - 2026/02/11","notes":""},{"id":1768245439058,"building":"ËôπÂè∂Ëä±Ëãë","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2200,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2024/08/12 - 2025/08/11","notes":""},{"id":1768245439059,"building":"ÈáëÊú∫1903","room":"2Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2025/05/15 - 2026/05/14","notes":""},{"id":1768245439060,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2025/06/15 - 2026/05/14","notes":""},{"id":1768245439061,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2026-01-12","status":1,"payCount":0,"contractPeriod":"2025/09/13 - 2026/09/12","notes":""},{"id":1768245439062,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"9Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2000,"baseCost":0,"nextPayDate":"2026-01-13","status":1,"payCount":0,"contractPeriod":"2025/10/16 - 2026/10/15","notes":""},{"id":1768245439063,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2006-B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3300,"baseCost":0,"nextPayDate":"2026-01-13","status":1,"payCount":0,"contractPeriod":"2025/09/16 - 2026/09/15","notes":""},{"id":1768245439064,"building":"ÈáëÊú∫2403-2404","room":"2403-G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1900,"baseCost":0,"nextPayDate":"2026-01-14","status":1,"payCount":0,"contractPeriod":"2025/02/14 - 2026/02/13","notes":""},{"id":1768245439065,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"1Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1700,"baseCost":0,"nextPayDate":"2026-01-14","status":1,"payCount":0,"contractPeriod":"2025/05/14 - 2026/05/13","notes":""},{"id":1768245439066,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"7Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2026-01-15","status":1,"payCount":0,"contractPeriod":"2023/06/05 - 2024/06/14","notes":""},{"id":1768245439067,"building":"ÈáëÊú∫1906","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1900,"baseCost":0,"nextPayDate":"2026-01-15","status":1,"payCount":0,"contractPeriod":"2024/05/15 - 2025/05/15","notes":""},{"id":1768245439068,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2800,"baseCost":0,"nextPayDate":"2026-01-15","status":1,"payCount":0,"contractPeriod":"2025/02/15 - 2026/02/14","notes":""},{"id":1768245439069,"building":"Â∫êËÆØ702","room":"4Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3350,"baseCost":0,"nextPayDate":"2026-01-15","status":1,"payCount":0,"contractPeriod":"2025/02/15 - 2026/02/14","notes":""},{"id":1768245439070,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"H","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2026-01-15","status":1,"payCount":0,"contractPeriod":"2025/08/16 - 2026/08/15","notes":""},{"id":1768245439071,"building":"Èì∂Â∫ß","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3400,"baseCost":0,"nextPayDate":"2026-01-16","status":1,"payCount":0,"contractPeriod":"2025/02/16 - 2026/02/15","notes":""},{"id":1768245439072,"building":"ÈáëÊú∫2403-2404","room":"2403-E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2600,"baseCost":0,"nextPayDate":"2026-01-17","status":1,"payCount":0,"contractPeriod":"2024/07/17 - 2025/07/16","notes":""},{"id":1768245439073,"building":"Èì∂Â∫ß","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-17","status":1,"payCount":0,"contractPeriod":"2024/07/17 - 2025/07/16","notes":""},{"id":1768245439074,"building":"Á¥´ËôπÂòâËãë","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2900,"baseCost":0,"nextPayDate":"2026-01-18","status":1,"payCount":0,"contractPeriod":"2025/02/18 - 2026/02/17","notes":""},{"id":1768245439075,"building":"ÈáëÊú∫2403-2404","room":"2404-C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3600,"baseCost":0,"nextPayDate":"2026-01-18","status":1,"payCount":0,"contractPeriod":"2024/07/18 - 2025/07/17","notes":""},{"id":1768245439076,"building":"Â∫êËÆØ702","room":"3Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"2026-01-18","status":1,"payCount":0,"contractPeriod":"2025/06/20 - 2026/06/19","notes":""},{"id":1768245439077,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2700,"baseCost":0,"nextPayDate":"2026-01-19","status":1,"payCount":0,"contractPeriod":"2025/06/19 - 2026/06/18","notes":""},{"id":1768245439078,"building":"Á¥´ËôπÂòâËãë","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2600,"baseCost":0,"nextPayDate":"2026-01-19","status":1,"payCount":0,"contractPeriod":"2024/10/19 - 2025/10/18","notes":""},{"id":1768245439079,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-19","status":1,"payCount":0,"contractPeriod":"2025/06/21 - 2026/06/20","notes":""},{"id":1768245439080,"building":"‰π¶È¶ôÂÖ¨ÂØì701","room":"G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2000,"baseCost":0,"nextPayDate":"2026-01-19","status":1,"payCount":0,"contractPeriod":"2025/05/21 - 2026/05/20","notes":""},{"id":1768245439081,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2006-C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3600,"baseCost":0,"nextPayDate":"2026-01-19","status":1,"payCount":0,"contractPeriod":"2025/08/19 - 2026/08/18","notes":""},{"id":1768245439082,"building":"ÈáëÊú∫2403-2404","room":"2404-B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-19","status":1,"payCount":0,"contractPeriod":"2025/08/20 - 2026/08/19","notes":""},{"id":1768245439083,"building":"ËôπÂè∂Ëä±Ëãë","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2700,"baseCost":0,"nextPayDate":"2026-01-20","status":1,"payCount":0,"contractPeriod":"2024/06/20 - 2025/06/19","notes":""},{"id":1768245439084,"building":"ËôπÂè∂Ëä±Ëãë","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"2026-01-22","status":1,"payCount":0,"contractPeriod":"2024/06/22 - 2025/06/21","notes":""},{"id":1768245439085,"building":"ÈáëÊú∫1903","room":"5Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2650,"baseCost":0,"nextPayDate":"2026-01-22","status":1,"payCount":0,"contractPeriod":"2023/05/22 - 2024/05/21","notes":""},{"id":1768245439086,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2007-D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3600,"baseCost":0,"nextPayDate":"2026-01-22","status":1,"payCount":0,"contractPeriod":"2024/10/22 - 2025/10/21","notes":""},{"id":1768245439087,"building":"ÈáëÊú∫1903","room":"4Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3300,"baseCost":0,"nextPayDate":"2026-01-23","status":1,"payCount":0,"contractPeriod":"2024/08/23 - 2025/08/22","notes":""},{"id":1768245439088,"building":"Â∫êËÆØ2106","room":"C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2300,"baseCost":0,"nextPayDate":"2026-01-23","status":1,"payCount":0,"contractPeriod":"2024/09/23 - 2025/09/22","notes":""},{"id":1768245439089,"building":"‰π¶È¶ôÂÖ¨ÂØì601","room":"6Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1500,"baseCost":0,"nextPayDate":"2026-01-24","status":1,"payCount":0,"contractPeriod":"2025/09/27 - 2026/09/26","notes":""},{"id":1768245439090,"building":"ÈáëÊú∫1903","room":"6Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3700,"baseCost":0,"nextPayDate":"2026-01-25","status":1,"payCount":0,"contractPeriod":"2025/07/25 - 2026/07/24","notes":""},{"id":1768245439091,"building":"ËôπÂè∂Ëä±Ëãë","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2000,"baseCost":0,"nextPayDate":"2026-01-25","status":1,"payCount":0,"contractPeriod":"2024/08/25 - 2025/08/24","notes":""},{"id":1768245439092,"building":"ÈáëÊú∫1906","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2200,"baseCost":0,"nextPayDate":"2026-01-25","status":1,"payCount":0,"contractPeriod":"2024/04/25 - 2025/04/24","notes":""},{"id":1768245439093,"building":"ÈáëÊú∫2403-2404","room":"F","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1850,"baseCost":0,"nextPayDate":"2026-01-25","status":1,"payCount":0,"contractPeriod":"2025/04/25 - 2026/04/24","notes":""},{"id":1768245439094,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2007-B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3300,"baseCost":0,"nextPayDate":"2026-01-25","status":1,"payCount":0,"contractPeriod":"2025/10/28 - 2026/10/27","notes":""},{"id":1768245439095,"building":"ÈáëÊú∫2403-2404","room":"2404-D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3200,"baseCost":0,"nextPayDate":"2026-02-25","status":1,"payCount":0,"contractPeriod":"2025/04/25 - 2026/04/24","notes":""},{"id":1768245439096,"building":"Â∫êËÆØ702","room":"1Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2800,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/09/16 - 2026/09/15","notes":""},{"id":1768245439097,"building":"Â∫êËÆØ2106","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/08/15 - 2026/08/14","notes":""},{"id":1768245439098,"building":"ÈáëÊú∫2403-2404","room":"2403-D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1700,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2024/09/19 - 2025/09/18","notes":""},{"id":1768245439099,"building":"Èì∂Â∫ß","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/07/20 - 2026/07/19","notes":""},{"id":1768245439100,"building":"ËôπÂè∂Ëä±Ëãë","room":"G","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2200,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/11/05 - 2026/02/04","notes":""},{"id":1768245439101,"building":"ÈáëÊú∫1906","room":"B","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2600,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2024/11/18 - 2025/11/17","notes":""},{"id":1768245439102,"building":"Êµ∑‰º¶ÂõΩÈôÖ","room":"A","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":1900,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/08/20 - 2026/08/19","notes":""},{"id":1768245439103,"building":"Â∫êËÆØ702","room":"2Âè∑","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2500,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/02/23 - 2026/02/22","notes":""},{"id":1768245439104,"building":"Ëç£Ê¨£Â§ßÂé¶","room":"2006-E","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2024/10/30 - 2025/10/29","notes":""},{"id":1768245439105,"building":"ÈáëÊú∫2403-2404","room":"2403-C","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3600,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2024/12/06 - 2025/12/05","notes":""},{"id":1768245439106,"building":"Â∫êËÆØ2106","room":"D","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":3400,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/08/12 - 2026/08/11","notes":""},{"id":1768245439107,"building":"Èì∂Â∫ß","room":"H","tenant":"Êó†ËÆ∞ÂΩï","phone":"Êó†ËÆ∞ÂΩï","price":2400,"baseCost":0,"nextPayDate":"","status":0,"payCount":0,"contractPeriod":"2025/10/18 - 2026/10/17","notes":""}],"plans":[{"building":"Á¥´ËôπÂòâËãë","paymentInfo":"ÂßìÂêçÔºöÊ°ÇÂ∞èÁáï\nÈì∂Ë°åÔºöÂª∫ËÆæÈì∂Ë°å‰∏äÊµ∑Âë®ÂÆ∂Âò¥Ë∑ØÊîØË°å\nË¥¶Âè∑Ôºö6217001210059856425","amount":34500,"nextPayDate":"2026-03-25","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2024Âπ¥7Êúà1Êó•-2027Âπ¥1Êúà1Êó•\n2„ÄÅÊàøÁßüÔºö11500/ÊúàÔºõ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥7Êúà1Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1","updateTime":1768906003913,"logs":[{"date":"2026/1/20 17:16:31","content":"‰∫§Áßü 30000ÂÖÉ"}],"archivedLogs":[]},{"building":"‰π¶È¶ôÂÖ¨ÂØì601","paymentInfo":"ÂßìÂêçÔºöÂçéËÆæËÆæËÆ°ÈõÜÂõ¢ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏\nÈì∂Ë°åÔºöÂ∑•Ë°åÂçó‰∫¨ÂüéÂçóÊîØË°å\nË¥¶Âè∑Ôºö4301 0129 0910 0365 164","amount":30000,"nextPayDate":"2026-04-08","payCount":0,"notes":"1„ÄÅÊàøÁßüÔºö10000/ÊúàÔºõ\n2„ÄÅÊúüÈôêÔºö2022Âπ¥12Êúà15Êó•-2025Âπ¥12Êúà14Êó•\n3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥10Êúà15Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2","updateTime":1768902270485,"logs":[],"archivedLogs":[]},{"building":"ÈáëÊú∫1906","paymentInfo":"ÂßìÂêçÔºöÂê¥ÊÉ†Ëä≥\nÈì∂Ë°åÔºö‰∏äÊµ∑ÂÜúÂïÜÈì∂Ë°å\nË¥¶Âè∑Ôºö6231 6266 3100 0075 128","amount":32400,"nextPayDate":"2026-03-25","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2024Âπ¥7Êúà1Êó•-2030Âπ¥6Êúà30Êó•\n2„ÄÅÊàøÁßüÔºö10800/ÊúàÔºõ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥7Êúà1Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2","updateTime":1768902309823,"logs":[],"archivedLogs":[]},{"building":"ÈáëÊú∫2403-2404","paymentInfo":"ÊàøÁßü72268ÂÖÉËΩ¨‰πîÈÄöÂÜçËΩ¨Êàø‰∏ú","amount":72268,"nextPayDate":"2026-04-13","payCount":0,"notes":"","updateTime":1768902358249,"logs":[],"archivedLogs":[]},{"building":"‰π¶È¶ôÂÖ¨ÂØì701","paymentInfo":"ÂßìÂêçÔºöÂçéËÆæËÆæËÆ°ÈõÜÂõ¢ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏\nÈì∂Ë°åÔºöÂ∑•Ë°åÂçó‰∫¨ÂüéÂçóÊîØË°å\nË¥¶Âè∑Ôºö4301 0129 0910 0365 164","amount":30000,"nextPayDate":"2026-04-18","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2025Âπ¥3Êúà25Êó•-2028Âπ¥3Êúà24Êó•\n2„ÄÅÊàøÁßüÔºö10000/ÊúàÔºõ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2025Âπ¥10Êúà25Êó•ÔºàÂºÄÂßã‰∫§ÊàøÁßüÔºâ\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2\n5„ÄÅÈÄÅ7‰∏™ÊúàÁ©∫ÂÖ≥ÊúüÔºå2025Âπ¥10Êúà25Êó•ÂºÄÂßã‰∫§ÊàøÁßü„ÄÇ","updateTime":1768902656442,"logs":[],"archivedLogs":[]},{"building":"Èì∂Â∫ß","paymentInfo":"‰ºçÊô®Êô®\n‰∏≠ÂõΩÂ∑•ÂïÜÈì∂Ë°å \n6212 2610 0103 1955 203\nÂéâËä≥Á∫¢\n‰∏≠ÂõΩÂÜú‰∏öÈì∂Ë°å \n6228 4503 3001 2450 117","amount":44100,"nextPayDate":"2026-04-13","payCount":0,"notes":"1„ÄÅ‰ºçÊô®Êô®Ôºö618ÂÆ§  7500*3=22500\n2„ÄÅÂéâËä≥Á∫¢Ôºö619ÂÆ§  7200*3=21600","updateTime":1768905632862,"logs":[],"archivedLogs":[]},{"building":"Â∫êËÆØ2106","paymentInfo":"ÊàøÁßü25500ÂÖÉÁî±‰πîÈÄöËΩ¨ËÄÅËß£ÂÜçËΩ¨Êàø‰∏ú","amount":25500,"nextPayDate":"2026-04-03","payCount":0,"notes":"","updateTime":1768902821247,"logs":[],"archivedLogs":[]},{"building":"Êµ∑‰º¶ÂõΩÈôÖ","paymentInfo":"ÂßìÂêçÔºöÈÇ¢Âª∫Âçé\nË¥¶Âè∑Ôºö5124 2502 1027 4495\nÈì∂Ë°åÔºöÊãõÂïÜÈì∂Ë°å","amount":30000,"nextPayDate":"2026-03-25","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2024Âπ¥10Êúà1Êó•-2031Âπ¥10Êúà1Êó•\n2„ÄÅÊàøÁßüÔºö10000/ÊúàÔºõ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥10Êúà1Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1\n5„ÄÅÊÄªÂÖ±3‰∏™ÊúàÁ©∫ÂÖ≥ÊúüÔºå24Âπ¥ÂáèÂÖç1.5‰∏™ÊúàÔºå25Âπ¥ÂáèÂÖç1‰∏™ÊúàÔºå26Âπ¥ÂáèÂÖç0.5‰∏™Êúà","updateTime":1768905607842,"logs":[],"archivedLogs":[]},{"building":"Ëç£Ê¨£Â§ßÂé¶","paymentInfo":"ÊàøÁßü65000ÂÖÉËΩ¨‰πîÈÄöÂÜçËΩ¨ÁªôÊàø‰∏ú","amount":65000,"nextPayDate":"2026-03-25","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2023Âπ¥7Êúà1Êó•-2026Âπ¥9Êúà30Êó•\n2„ÄÅÊàøÁßüÔºö23000/ÊúàÔºõ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥7Êúà1Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1","updateTime":1768905288414,"logs":[],"archivedLogs":[]},{"building":"Ëä±Âõ≠Âüé","paymentInfo":"ÂßìÂêçÔºöÁéãÊñáÊñå \nÈì∂Ë°åÔºöÂª∫ËÆæÈì∂Ë°å‰∏äÊµ∑ÂêåÂøÉË∑ØÊîØË°å\nË¥¶Âè∑Ôºö6214661180473538","amount":27000,"nextPayDate":"2026-03-26","payCount":0,"notes":"1„ÄÅÊàøÁßüÔºö9000/ÊúàÔºõ\n2„ÄÅÊúüÈôêÔºö2024Âπ¥4Êúà2Êó•-2034Âπ¥4Êúà1Êó•\n3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥4Êúà2Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1ÔºàÊØèÂπ¥ÂÖçÁßüÊúü15Â§©Ôºâ","updateTime":1768905340465,"logs":[],"archivedLogs":[]},{"building":"ÈáëÊú∫1903","paymentInfo":"ÂßìÂêçÔºöÂº†ÂØåÁîü  \nÈì∂Ë°åÔºöÊãõÂïÜÈì∂Ë°å \nË¥¶Âè∑Ôºö6214 8621 2330 7888  ","amount":32400,"nextPayDate":"2026-03-03","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2023Âπ¥6Êúà10Êó•-2029Âπ¥6Êúà9Êó•\n2„ÄÅÊàøÁßüÔºö10800/ÊúàÔºõ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥6Êúà10Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2\n5„ÄÅÂÆûÈôÖ‰∫§Êàø4Êúà10Êó•ÔºåÈÄÅ2‰∏™ÊúàÁ©∫ÂÖ≥Êúü","updateTime":1768905374320,"logs":[],"archivedLogs":[]},{"building":"Â∫êËÆØ702","paymentInfo":"Êà∑ÂêçÔºöÂÆ∞ÈôàÊùèËïæ\nÈì∂Ë°åÔºö‰∏≠ÂõΩÈì∂Ë°å\nË¥¶Âè∑Ôºö6217906100004527534","amount":27300,"nextPayDate":"2026-04-06","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2023Âπ¥7Êúà13Êó•-2031Âπ¥7Êúà12Êó•\n2„ÄÅÊàøÁßüÔºö9100/ÊúàÔºõÂæÄÂêéÊØè3Âπ¥ÈÄíÂ¢û500/Êúà\n3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥7Êúà13Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2\n5„ÄÅÂÆûÈôÖ‰∫§Êàø4Êúà13Êó•ÔºåÈÄÅ3‰∏™ÊúàÁ©∫ÂÖ≥Êúü","updateTime":1768905419710,"logs":[],"archivedLogs":[]},{"building":"Ê∞¥ÁîµË∑Ø1402","paymentInfo":"ÂßìÂêçÔºöÊùéÈìÆ \nÈì∂Ë°åÔºöÊãõÂïÜÈì∂Ë°å \nË¥¶Âè∑Ôºö9555 5002 1700 4372","amount":13500,"nextPayDate":"2026-02-01","payCount":0,"notes":"1„ÄÅÊúüÈôêÔºö2023Âπ¥8Êúà8Êó•-2029Âπ¥8Êúà7Êó•ÔºàÈÄÅÁ©∫ÂÖ≥Êúü3‰∏™ÊúàÔºâ‰ª•ÂêéÊØèÂπ¥ÈÄÅ10Â§©Á©∫ÂÖ≥Êúü\n2„ÄÅÊàøÁßüÔºö4500/ÊúàÔºõÔºà6Âπ¥‰∏çÊ∂®‰ª∑Ôºâ\n3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥8Êúà8Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1","updateTime":1768905493181,"logs":[],"archivedLogs":[]},{"building":"ËôπÂè∂Ëä±Ëãë","paymentInfo":"ÂßìÂêçÔºöÈü©Â§©Êòé\nÈì∂Ë°åÔºöÂÜú‰∏öÈì∂Ë°å\nË¥¶Âè∑Ôºö6228 4500 3804 3816 079","amount":30600,"nextPayDate":"2026-02-21","payCount":0,"notes":"1 „ÄÅÊúüÈôêÔºö2024Âπ¥8Êúà28Êó•-2028Âπ¥8Êúà27Êó•Ôºà10200ÂÖÉÔºâ\n       ÊúüÈôêÔºö2028Âπ¥8Êúà28Êó•-2032Âπ¥8Êúà27Êó•Ôºà10700ÂÖÉÔºâ\n2„ÄÅÊàøÁßüÔºö10200/Êúà„ÄÅ10700/Êúà\n3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥8Êúà28Êó•\n4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1\n5„ÄÅÂÆûÈôÖ‰∫§Êàø2024Âπ¥5Êúà18Êó•ÔºåÈÄÅ3‰∏™Êúà+10Â§©Á©∫ÂÖ≥Êúü","updateTime":1768905549049,"logs":[],"archivedLogs":[]}],"repairs":[],"paymentHistory":[{"date":"2026-01-20","amount":30000,"building":"Á¥´ËôπÂòâËãë","type":"expense_landlord","remark":"Â§ßÊàø‰∏ú‰∫§Áßü"}],"pettyCash":[],"financeOverrides":{"Á¥´ËôπÂòâËãë":{"income":0,"landlord":0,"decoration":0,"repair":0,"refund":0}},"financeLogs":{"Á¥´ËôπÂòâËãë":[{"date":"2026/1/20 17:16:31","content":"Â§ßÊàø‰∏ú‰∫§Áßü (-¬•30000)"},{"date":"2026/1/20 18:53:36","content":"ÊâãÂä®‰øÆÊ≠£: ‰∫§Áßü: 30000->0"}]},"financeArchivedLogs":{},"buildingTimestamps":{"Á¥´ËôπÂòâËãë":1768906416672},"settings":{"appTitle":"‰∫åÊàø‰∏ú‰ºÅ‰∏öÊî∂ÁßüÁ≥ªÁªü","menuNames":{"rooms":"ÊàøÊ∫êÁÆ°ÁêÜ","landlord":"‰ªòÊ¨æÊèêÈÜí","finance":"Ë¥¢Âä°Ê±áÊÄª","repair":"ÊàêÊú¨ÁÆ°ÁêÜ","petty":"Â§áÁî®ÊµÅÊ∞¥"},"backupInterval":5,"theme":"light"},"toolbarBtnOrder":["colSetup","rentShot","vacantShot","bulkEdit","addRoom","batchRent"],"roomColOrder":["chk","building","room","price","nextPayDate","rentStatus","contractPeriod","tenant","notes","op"],"roomColWidths":{"room":60,"chk":30,"building":60,"price":60,"nextPayDate":80,"rentStatus":60,"contractPeriod":80,"tenant":100,"notes":60},"planColOrder":["building","payCount","amount","status","nextPayDate","info","notes","op"],"planColWidths":{"info":180,"status":66,"op":241,"notes":180,"payCount":66,"amount":66,"building":88,"nextPayDate":100},"financeColOrder":["building","roomCount","occupancy","cumulativeIncome","cumulativeLandlord","decoration","repair","profit","op"],"financeColWidths":{"occupancy":120},"costColOrder":["building","content","date","type","amount","notes","op"],"costColWidths":{},"pettyColOrder":["date","type","amount","reason","balanceSnapshot","op"],"pettyColWidths":{},"roomHiddenCols":["contractPeriod","tenant"],"planHiddenCols":["info"],"currentRentData":{"rooms":[1768245439011],"total":1600,"count":1},"currentFontSize":12,"lastSaved":"2026/1/23 01:08:12"}</script>
    <style>
        :root { 
            --primary: #4f46e5;
            --primary-hover: #4338ca;
            --dark: #0f172a; 
            --bg: #f1f5f9; 
            --success: #16a34a; 
            --warning: #f59e0b; 
            --danger: #dc2626; 
            --orange: #f97316;
            --green: #22c55e;
            --base-font: 12px;
            --card-height: 140px;
            --card-bg: #ffffff;
            --card-border: #e2e8f0;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --input-bg: #ffffff;
            --input-border: #cbd5e1;
            --table-header-bg: #f8fafc;
            --table-row-hover: #f8fafc;
            --modal-bg: #ffffff;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
            --border-radius: 10px;
            --border-radius-sm: 6px;
            --border-radius-lg: 12px;
            --transition: 0.2s ease;
        }
        
        /* Ê∑±Ëâ≤Ê®°ÂºèÂèòÈáè */
        [data-theme="dark"] {
            --primary: #6366f1;
            --primary-hover: #818cf8;
            --dark: #0f172a;
            --bg: #0f172a;
            --card-bg: #1e293b;
            --card-border: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --input-bg: #1e293b;
            --input-border: #475569;
            --table-header-bg: #1e293b;
            --table-row-hover: #334155;
            --modal-bg: #1e293b;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.5);
        }
        
        body { 
            font-family: 'Segoe UI', "Microsoft YaHei", sans-serif;
            background: var(--bg); 
            margin: 0; 
            display: flex; 
            height: 100vh; 
            overflow: hidden;
            font-size: var(--base-font);
            color: var(--text-primary);
            transition: background var(--transition), color var(--transition);
        }
        
        /* ‰æßËæπÊ†è */
        aside { 
            width: 240px;
            background: var(--dark); 
            color: #e2e8f0; 
            display: flex; 
            flex-direction: column; 
            padding: 20px; 
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            flex-shrink: 0;
            transition: width 0.3s;
        }
        
        aside h2 { font-size: 18px; margin-bottom: 10px; color: white; display: flex; align-items: center; gap: 10px; }
        
        /* Ê∑±Ëâ≤Ê®°ÂºèÂàáÊç¢ */
        .theme-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255,255,255,0.08);
            padding: 10px 12px;
            border-radius: var(--border-radius-sm);
            margin-bottom: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .theme-toggle-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
            color: #94a3b8;
        }
        .theme-switch {
            position: relative;
            width: 48px;
            height: 24px;
        }
        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #475569;
            transition: 0.3s;
            border-radius: 24px;
        }
        .theme-slider:before {
            position: absolute;
            content: "‚òÄÔ∏è";
            font-size: 12px;
            line-height: 18px;
            text-align: center;
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        .theme-switch input:checked + .theme-slider {
            background-color: var(--primary);
        }
        .theme-switch input:checked + .theme-slider:before {
            transform: translateX(24px);
            content: "üåô";
        }
        
        .sidebar-font-control {
            background: rgba(255,255,255,0.08);
            padding: 10px 12px;
            border-radius: var(--border-radius-sm);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .sidebar-font-control span { font-size: 11px; color: #94a3b8; }
        .sidebar-font-btn {
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            width: 28px; height: 28px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }
        .sidebar-font-btn:hover { background: var(--primary); border-color: var(--primary); }

        .nav-item { 
            padding: 12px 14px; 
            margin-bottom: 5px; 
            cursor: pointer; 
            border-radius: var(--border-radius-sm); 
            transition: var(--transition); 
            display: flex; 
            align-items: center; 
            gap: 10px;
            border: 1px solid transparent;
        }
        .nav-item:hover { background: rgba(255,255,255,0.08); color: white; border-color: rgba(255,255,255,0.1); }
        .nav-item.active { background: rgba(79,70,229,0.3); color: white; border-color: rgba(79,70,229,0.5); }
        
        .excel-zone { 
            margin-top: auto; 
            background: rgba(255,255,255,0.05); 
            padding: 15px; 
            border-radius: var(--border-radius); 
            border: 1px dashed rgba(255,255,255,0.2); 
        }
        .excel-zone h4 { margin: 0 0 10px 0; font-size: 13px; color: #94a3b8; }
        .btn-excel { 
            width: 100%; 
            padding: 10px; 
            margin-bottom: 8px; 
            border: none; 
            border-radius: var(--border-radius-sm); 
            cursor: pointer; 
            font-size: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 6px; 
            transition: var(--transition);
            font-weight: 500;
        }
        .btn-export { background: linear-gradient(135deg, #059669, #10b981); color: white; }
        .btn-export:hover { background: linear-gradient(135deg, #047857, #059669); transform: translateY(-1px); }
        .btn-import { background: linear-gradient(135deg, #d97706, #f59e0b); color: white; }
        .btn-import:hover { background: linear-gradient(135deg, #b45309, #d97706); transform: translateY(-1px); }
        .btn-template { background: linear-gradient(135deg, #7c3aed, #8b5cf6); color: white; }
        .btn-template:hover { background: linear-gradient(135deg, #6d28d9, #7c3aed); transform: translateY(-1px); }
        .btn-backup { background: linear-gradient(135deg, #475569, #64748b); color: white; }
        .btn-backup:hover { background: linear-gradient(135deg, #334155, #475569); transform: translateY(-1px); }
        
        .history-btn-group { display: flex; gap: 5px; margin-bottom: 10px; }
        .btn-undo { background: linear-gradient(135deg, #64748b, #94a3b8); color: white; flex: 1; }
        .btn-redo { background: linear-gradient(135deg, #64748b, #94a3b8); color: white; flex: 1; }
        .btn-disabled { opacity: 0.5; cursor: not-allowed !important; transform: none !important; }

        /* ‰∏ª‰Ωì */
        main { 
            flex: 1; 
            padding: 20px; 
            overflow-y: auto; 
            display: flex; 
            flex-direction: column; 
            gap: 20px;
            background: var(--bg);
            transition: background var(--transition);
        }
        
        /* Dashboard */
        #globalDashboard { display: flex; gap: 15px; align-items: flex-start; transition: all 0.3s ease; }
        
        .dashboard-grid { flex: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; }
        .height-slider-wrapper { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background: var(--card-bg); 
            padding: 10px 5px; 
            border-radius: 20px; 
            box-shadow: var(--shadow-sm); 
            height: var(--card-height); 
            min-height: 100px;
            border: 1px solid var(--card-border);
            transition: background var(--transition), border var(--transition);
        }
        input[type=range][orient=vertical] { writing-mode: bt-lr; -webkit-appearance: slider-vertical; width: 8px; height: 100%; padding: 0 5px; }

        .card { 
            background: var(--card-bg); 
            padding: 20px; 
            border-radius: var(--border-radius); 
            box-shadow: var(--shadow-sm); 
            border: 1px solid var(--card-border); 
            border-left-width: 4px; 
            height: var(--card-height); 
            overflow: hidden; 
            display: flex; 
            flex-direction: column; 
            transition: all var(--transition);
        }
        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        .card h3 { margin: 0 0 10px 0; font-size: 15px; color: var(--text-secondary); text-align: center; flex-shrink: 0; }
        
        .alert-box { flex: 1; overflow-y: auto; font-size: 12px; padding-right: 5px; }
        .alert-item { display: flex; justify-content: space-between; padding: 8px 10px; margin-bottom: 5px; border-radius: var(--border-radius-sm); }
        .alert-normal { background: #dcfce7; color: #166534; border-left: 3px solid #16a34a; }
        .alert-warning { background: #fef3c7; color: #92400e; border-left: 3px solid #f59e0b; }
        .alert-danger { background: #fee2e2; color: #991b1b; border-left: 3px solid #dc2626; }
        
        [data-theme="dark"] .alert-normal { background: rgba(22, 163, 74, 0.2); color: #86efac; }
        [data-theme="dark"] .alert-warning { background: rgba(245, 158, 11, 0.2); color: #fcd34d; }
        [data-theme="dark"] .alert-danger { background: rgba(220, 38, 38, 0.2); color: #fca5a5; }
        
        /* ÁªüËÆ°ÁúãÊùø */
        .summary-board { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 10px; 
            background: var(--card-bg); 
            padding: 15px; 
            border-radius: var(--border-radius); 
            margin-bottom: 10px; 
            box-shadow: var(--shadow-sm); 
            border: 1px solid var(--card-border);
            transition: background var(--transition), border var(--transition);
        }
        .summary-item { 
            text-align: center; 
            padding: 12px; 
            border-radius: var(--border-radius-sm); 
            background: var(--table-header-bg); 
            border: 1px solid transparent; 
            transition: all var(--transition);
        }
        .summary-item:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .summary-label { font-size: 11px; color: var(--text-secondary); margin-bottom: 5px; display: block;}
        .summary-value { font-size: 16px; font-weight: bold; display: block; }
        
        .si-total { border-color: #cbd5e1; } .si-total .summary-value { color: #334155; }
        .si-overdue { background: #fef2f2; border-color: #fecaca; } .si-overdue .summary-value { color: #dc2626; }
        .si-urgency { background: #fffbeb; border-color: #fde68a; } .si-urgency .summary-value { color: #d97706; }
        .si-wait { background: #f0fdf4; border-color: #bbf7d0; } .si-wait .summary-value { color: #16a34a; }
        .si-vacant { background: #f1f5f9; border-color: #e2e8f0; } .si-vacant .summary-value { color: #94a3b8; }
        .si-current-rent { background: #eff6ff; border-color: #bfdbfe; } .si-current-rent .summary-value { color: #2563eb; }
        .si-income { background: #f0fdf4; border-color: #bbf7d0; } .si-income .summary-value { color: #16a34a; }
        
        /* Êú¨Ê¨°Êî∂ÁßüÊåâÈíÆÊ†∑Âºè */
        .btn-mini { padding: 4px 12px; font-size: 11px; border: none; border-radius: 4px; cursor: pointer; transition: all 0.2s; }
        .btn-clear { background: #fee2e2; color: #991b1b; }
        .btn-clear:hover { background: #fecaca; }
        .btn-restore { background: #dbeafe; color: #1e40af; }
        .btn-restore:hover { background: #bfdbfe; }
        [data-theme="dark"] .btn-clear { background: rgba(220, 38, 38, 0.2); color: #fca5a5; }
        [data-theme="dark"] .btn-restore { background: rgba(37, 99, 235, 0.2); color: #93c5fd; }

        .si-expense { background: #fef2f2; border-color: #fecaca; } .si-expense .summary-value { color: #dc2626; }
        .si-profit { background: #eff6ff; border-color: #bfdbfe; } .si-profit .summary-value { color: #2563eb; }

        [data-theme="dark"] .si-total { border-color: #475569; background: #334155; } [data-theme="dark"] .si-total .summary-value { color: #e2e8f0; }
        [data-theme="dark"] .si-overdue { background: rgba(220,38,38,0.15); border-color: rgba(220,38,38,0.3); }
        [data-theme="dark"] .si-urgency { background: rgba(245,158,11,0.15); border-color: rgba(245,158,11,0.3); }
        [data-theme="dark"] .si-wait { background: rgba(22,163,74,0.15); border-color: rgba(22,163,74,0.3); }
        [data-theme="dark"] .si-vacant { background: #334155; border-color: #475569; }
        [data-theme="dark"] .si-income { background: rgba(22,163,74,0.15); border-color: rgba(22,163,74,0.3); }
        [data-theme="dark"] .si-expense { background: rgba(220,38,38,0.15); border-color: rgba(220,38,38,0.3); }
        [data-theme="dark"] .si-profit { background: rgba(37,99,235,0.15); border-color: rgba(37,99,235,0.3); }

        /* Ë°®Ê†ºÂå∫Âüü */
        .table-wrapper { 
            background: var(--card-bg); 
            border-radius: var(--border-radius); 
            padding: 15px; 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            box-shadow: var(--shadow-sm); 
            overflow: hidden;
            border: 1px solid var(--card-border);
            transition: background var(--transition), border var(--transition);
        }
        
        /* ÊàøÊ∫êÁÆ°ÁêÜÂ∑•ÂÖ∑Ê†èÈáçÊñ∞ËÆæËÆ° */
        .toolbar { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 15px; 
            flex-wrap: wrap; 
            align-items: center; 
        }
        
        .toolbar-rooms {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .toolbar-row {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .toolbar-row-1 {
            padding-bottom: 12px;
            border-bottom: 1px solid var(--card-border);
        }
        
        .toolbar-row-2 {
            justify-content: center;
        }
        
        .toolbar-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toolbar-filters {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        /* Á¨¨‰∫åË°åÊåâÈíÆÂÆπÂô® - ÊîØÊåÅÊãñÊãΩÊéíÂ∫è */
        .toolbar-actions-container {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: linear-gradient(135deg, var(--table-header-bg), var(--card-bg));
            border-radius: var(--border-radius);
            border: 1px solid var(--card-border);
            box-shadow: var(--shadow-sm);
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .toolbar-btn-item {
            cursor: grab;
            user-select: none;
            transition: all 0.2s;
        }
        .toolbar-btn-item:active {
            cursor: grabbing;
        }
        .toolbar-btn-item.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        .toolbar-btn-item.drag-over {
            transform: translateX(5px);
        }
        
        .action-divider {
            width: 1px;
            height: 28px;
            background: var(--card-border);
            margin: 0 4px;
        }
        
        .table-scroll-container { 
            flex: 1; 
            overflow: auto; 
            position: relative; 
            border: 1px solid var(--card-border); 
            border-radius: var(--border-radius-sm); 
        }
        table { width: 100%; border-collapse: collapse; font-size: inherit; table-layout: fixed; }
        thead { background: var(--table-header-bg); color: var(--text-secondary); position: sticky; top: 0; z-index: 10; }
        th, td { padding: 10px 8px; text-align: center; border-bottom: 1px solid var(--card-border); word-wrap: break-word; position: relative; }
        tfoot tr { background: var(--table-header-bg); font-weight: bold; color: var(--text-primary); }
        tfoot td { border-top: 2px solid var(--card-border); }

        /* ÊãñÊãΩ‰∏éÊéíÂ∫èÂàóÊ†∑Âºè */
        th.draggable { cursor: grab; user-select: none; transition: background 0.2s, border 0.2s; position: relative; }
        th.draggable:active { cursor: grabbing; } 
        th.dragging { opacity: 0.5; background: var(--card-border); border: 2px dashed var(--text-muted); }
        th.drag-over { border-left: 3px solid var(--primary); background: rgba(79, 70, 229, 0.1); }
        
        th:hover { background: var(--table-row-hover); }
        
        th .sort-icon { margin-left: 5px; font-size: 10px; color: var(--text-muted); }
        th.sorted-asc .sort-icon::before { content: '\f0de'; color: var(--primary); }
        th.sorted-desc .sort-icon::before { content: '\f0dd'; color: var(--primary); }
        th:not(.sorted-asc):not(.sorted-desc) .sort-icon::before { content: '\f0dc'; }
        tr:hover { background: var(--table-row-hover); }

        .badge { 
            padding: 4px 10px; 
            border-radius: var(--border-radius-sm); 
            font-size: 11px; 
            font-weight: 600; 
            display: inline-block;
        }
        .st-0 { background: #e2e8f0; color: #64748b; }
        .rent-wait { background: #dcfce7; color: #166534; }
        .rent-urgency { background: #fef3c7; color: #92400e; }
        .rent-overdue { background: #fee2e2; color: #991b1b; animation: pulse 2s infinite; }
        .rent-confirmed { background: #e0f2fe; color: #0369a1; }
        .cost-deco { background: #fef3c7; color: #92400e; }
        .cost-main { background: #e0f2fe; color: #0369a1; }
        .cost-refund { background: #fee2e2; color: #991b1b; }

        [data-theme="dark"] .st-0 { background: #475569; color: #94a3b8; }
        [data-theme="dark"] .rent-wait { background: rgba(22,163,74,0.3); color: #86efac; }
        [data-theme="dark"] .rent-urgency { background: rgba(245,158,11,0.3); color: #fcd34d; }
        [data-theme="dark"] .rent-overdue { background: rgba(220,38,38,0.3); color: #fca5a5; }
        [data-theme="dark"] .rent-confirmed { background: rgba(14,165,233,0.3); color: #7dd3fc; }
        [data-theme="dark"] .cost-deco { background: rgba(245,158,11,0.3); color: #fcd34d; }
        [data-theme="dark"] .cost-main { background: rgba(14,165,233,0.3); color: #7dd3fc; }
        [data-theme="dark"] .cost-refund { background: rgba(220,38,38,0.3); color: #fca5a5; }

        .btn-group-uniform { display: flex; gap: 8px; justify-content: center; align-items: center; }

        button.action { 
            padding: 8px 14px; 
            border: none; 
            border-radius: var(--border-radius-sm); 
            cursor: pointer; 
            color: white; 
            font-size: 12px; 
            transition: all var(--transition); 
            white-space: nowrap;
            box-shadow: var(--shadow-sm);
            font-weight: 500;
        }
        button.action:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        button.action:active {
            transform: translateY(0);
        }
        .act-pay { background: linear-gradient(135deg, var(--success), #15803d); }
        .act-out { background: linear-gradient(135deg, var(--danger), #b91c1c); }
        .act-out:hover { background: linear-gradient(135deg, #b91c1c, #991b1b); }
        .act-in { background: linear-gradient(135deg, var(--primary), var(--primary-hover)); }
        .act-in:hover { background: linear-gradient(135deg, var(--primary-hover), #3730a3); }
        .act-edit { background: linear-gradient(135deg, var(--warning), #d97706); }
        .act-edit:hover { background: linear-gradient(135deg, #d97706, #b45309); }
        .act-confirm { background: linear-gradient(135deg, var(--green), #16a34a); }
        .act-confirm:hover { background: linear-gradient(135deg, #16a34a, #15803d); }
        .act-repair { background: linear-gradient(135deg, #0ea5e9, #0284c7); }
        .act-repair:hover { background: linear-gradient(135deg, #0284c7, #0369a1); }
        .act-log { background: linear-gradient(135deg, #7c3aed, #6d28d9); }
        .act-log:hover { background: linear-gradient(135deg, #6d28d9, #5b21b6); }
        .act-date { background: #64748b; padding: 2px 6px; font-size: 10px; margin-left: 5px; }
        .act-clear { background: #94a3b8; margin-right: 5px; }
        .act-date-small { background: #94a3b8; padding: 2px 5px; font-size: 10px; margin-left: 3px; border-radius: 4px; color: white; border: none; cursor: pointer; transition: var(--transition); }
        .act-date-small:hover { background: #64748b; }
        .act-cols { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
        .act-cols:hover { background: linear-gradient(135deg, #2563eb, #1d4ed8); }
        .act-batch { background: linear-gradient(135deg, #16a34a, #059669); color: white; border: 1px solid rgba(22, 163, 74, 0.3); }
        .act-batch:hover { background: linear-gradient(135deg, #15803d, #047857); }
        .act-disabled { background: #cbd5e1 !important; cursor: not-allowed !important; color: #64748b !important; box-shadow: none !important; }
        .act-disabled:hover { transform: none !important; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        .hidden { display: none !important; }
        
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.5); 
            align-items: center; 
            justify-content: center; 
            z-index: 999; 
            backdrop-filter: blur(4px); 
        }
        .modal-box { 
    background: var(--modal-bg); 
    width: 700px; 
    max-width: 90vw;
    padding: 25px; 
    border-radius: var(--border-radius-lg); 
    max-height: 85vh; 
    overflow-y: auto; 
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--card-border);
    animation: modalSlide 0.3s ease;
}
        @keyframes modalSlide {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .form-row { margin-bottom: 12px; }
        .form-row label { display: block; margin-bottom: 4px; font-size: 12px; color: var(--text-secondary); }
        .form-row input, .form-row select, .form-row textarea { 
            width: 100%; 
            box-sizing: border-box; 
            padding: 10px 12px; 
            border: 1px solid var(--input-border); 
            border-radius: var(--border-radius-sm); 
            font-family: inherit;
            background: var(--input-bg);
            color: var(--text-primary);
            transition: border var(--transition), box-shadow var(--transition);
        }
        .form-row input:focus, .form-row select:focus, .form-row textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.15);
        }
        
        .checkbox-list { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .checkbox-item { display: flex; align-items: center; gap: 8px; font-size: 13px; cursor: pointer; padding: 6px; border-radius: var(--border-radius-sm); transition: background 0.1s; }
        .checkbox-item:hover { background: var(--table-row-hover); }
        .checkbox-item input { width: auto; margin: 0; cursor: pointer; }
        /* ÊâπÈáèÈÄâÊã©Â§çÈÄâÊ°ÜÊ†∑Âºè */
        .room-check { cursor: pointer; transform: scale(1.2); }

        .search-box { 
            padding: 8px 12px; 
            border: 1px solid var(--input-border); 
            border-radius: var(--border-radius-sm); 
            width: 150px; 
            background: var(--input-bg); 
            color: var(--text-primary);
            transition: border var(--transition);
        }
        .search-box:focus { border-color: var(--primary); outline: none; }
        .date-filter { 
            padding: 8px 10px; 
            border: 1px solid var(--input-border); 
            border-radius: var(--border-radius-sm); 
            width: 120px; 
            background: var(--input-bg); 
            color: var(--text-primary);
        }
        .date-filter:focus { border-color: var(--primary); outline: none; }

        .finance-table .income-row { background: #f0fdf4 !important; font-weight: bold; color: #166534; }
        .finance-table .cost-row { background: #fff7ed !important; font-weight: bold; color: #c2410c; } 
        .finance-table .expense-row { background: #fef2f2 !important; }
        .finance-table .profit-row { background: #eff6ff !important; font-weight: bold; }
        .finance-table td { vertical-align: middle; }

        [data-theme="dark"] .finance-table .income-row { background: rgba(22,163,74,0.15) !important; color: #86efac; }
        [data-theme="dark"] .finance-table .cost-row { background: rgba(249,115,22,0.15) !important; color: #fdba74; }
        [data-theme="dark"] .finance-table .expense-row { background: rgba(220,38,38,0.15) !important; }
        [data-theme="dark"] .finance-table .profit-row { background: rgba(37,99,235,0.15) !important; }

        .progress-bg { background-color: var(--card-border); border-radius: 4px; height: 6px; width: 80%; margin: 5px auto 0 auto; overflow: hidden; }
        .progress-bar-gradient { height: 100%; background: linear-gradient(90deg, #f87171, #fbbf24, #34d399); transition: width 0.5s ease; }

        .settings-container { max-width: 800px; margin: 0; margin-left: 20px; text-align: left; }
        .settings-group { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--card-border); }
        .settings-group h4 { margin-top:0; color: var(--primary); margin-bottom: 15px;}
        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .copyright-footer { margin-top: 50px; color: var(--text-muted); font-size: 11px; border-top: 1px solid var(--card-border); padding-top: 10px; text-align: left; width: 100%;}
        
        .wrap-cell { white-space: pre-wrap; text-align: left; line-height: 1.4; }

        .log-list { list-style: none; padding: 0; margin: 0; max-height: 300px; overflow-y: auto; border: 1px solid var(--card-border); border-radius: var(--border-radius-sm); }
        .log-item { padding: 10px; border-bottom: 1px solid var(--table-row-hover); font-size: 13px; display: flex; gap: 10px; align-items: start; }
        .log-item:last-child { border-bottom: none; }
        .log-idx { color: var(--primary); font-weight: bold; min-width: 20px; }
        .log-content { color: var(--text-primary); line-height: 1.4; }
        .log-date { color: var(--text-secondary); font-size: 11px; display: block; margin-bottom: 2px; }
        .log-highlight { color: #dc2626; font-weight: bold; }

        .petty-header { display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%); color: white; padding: 20px; border-radius: var(--border-radius); margin-bottom: 20px; transition: background 0.3s; }
        .petty-header.negative { background: linear-gradient(135deg, #b91c1c 0%, #ef4444 100%); }
        .petty-balance { font-size: 32px; font-weight: bold; }
        .petty-label { font-size: 12px; opacity: 0.8; margin-bottom: 5px; }
        .petty-btn-group { display: flex; gap: 10px; }
        .btn-petty { border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; padding: 10px 18px; border-radius: var(--border-radius-sm); cursor: pointer; transition: var(--transition); font-weight: 500; }
        .btn-petty:hover { background: rgba(255,255,255,0.2); transform: translateY(-1px); }
        .trans-in { color: #16a34a; font-weight: bold; }
        .trans-out { color: #dc2626; font-weight: bold; }
        
        [data-theme="dark"] .trans-in { color: #86efac; }
        [data-theme="dark"] .trans-out { color: #fca5a5; }

        .wipe-alert { background: #fef2f2; border: 1px solid #dc2626; color: #991b1b; padding: 15px; border-radius: var(--border-radius-sm); margin-bottom: 15px; font-size: 13px; text-align: center; }
        .wipe-timer { font-size: 24px; font-weight: bold; margin: 10px 0; color: #dc2626; }

        /* ÈÄâÊã©Ê°ÜÊ†∑Âºè */
        select {
            padding: 8px 12px;
            border: 1px solid var(--input-border);
            border-radius: var(--border-radius-sm);
            background: var(--input-bg);
            color: var(--text-primary);
            cursor: pointer;
            transition: border var(--transition);
        }
        select:hover { border-color: var(--primary); }
        select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }

        /* ÊªöÂä®Êù°ÁæéÂåñ */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--table-header-bg); border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--text-muted); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }
    </style>
</head>
<body>

<aside>
    <h2><i class="fas fa-building"></i> <span id="appTitle">‰∫åÊàø‰∏ú‰ºÅ‰∏öÊî∂ÁßüÁ≥ªÁªü</span></h2>
    
    <!-- Ê∑±Ëâ≤Ê®°ÂºèÂàáÊç¢ -->
    <div class="theme-toggle">
        <div class="theme-toggle-label">
            <i class="fas fa-adjust"></i>
            <span>Ê∑±Ëâ≤Ê®°Âºè</span>
        </div>
        <label class="theme-switch">
            <input type="checkbox" id="themeToggle" onchange="toggleTheme()">
            <span class="theme-slider"></span>
        </label>
    </div>
    
    <div class="sidebar-font-control">
        <span><i class="fas fa-text-height"></i> Â≠óÂè∑Ë∞ÉËäÇ</span>
        <div style="display:flex; gap:5px;">
            <button class="sidebar-font-btn" onclick="adjustFont(-1)">‚àí</button>
            <button class="sidebar-font-btn" onclick="adjustFont(1)">+</button>
        </div>
    </div>

    <div class="nav-item active" onclick="switchTab('rooms')"><i class="fas fa-home"></i> <span id="menu-rooms">ÊàøÊ∫êÁÆ°ÁêÜ</span></div>
    <div class="nav-item" onclick="switchTab('landlord')"><i class="fas fa-hand-holding-usd"></i> <span id="menu-landlord">‰ªòÊ¨æÊèêÈÜí</span></div>
    <div class="nav-item" onclick="switchTab('finance')"><i class="fas fa-chart-pie"></i> <span id="menu-finance">Ë¥¢Âä°Ê±áÊÄª</span></div>
    <div class="nav-item" onclick="switchTab('cost')"><i class="fas fa-tools"></i> <span id="menu-repair">ÊàêÊú¨ÁÆ°ÁêÜ</span></div>
    <div class="nav-item" onclick="switchTab('petty')"><i class="fas fa-wallet"></i> <span id="menu-petty">Â§áÁî®ÊµÅÊ∞¥</span></div>
    <div class="nav-item" onclick="switchTab('settings')"><i class="fas fa-cog"></i> <span id="menu-settings">Á≥ªÁªüËÆæÁΩÆ</span></div>
    
    <div class="excel-zone">
        <h4><i class="fas fa-history"></i> ÂéÜÂè≤Êìç‰Ωú</h4>
        <div class="history-btn-group">
            <button class="btn-excel btn-undo btn-disabled" id="btnUndo" onclick="performUndo()" disabled=""><i class="fas fa-undo"></i> Êí§ÈîÄ</button>
            <button class="btn-excel btn-redo" id="btnRedo" onclick="performRedo()"><i class="fas fa-redo"></i> ÊÅ¢Â§ç</button>
        </div>

        <h4><i class="fas fa-database"></i> Êï∞ÊçÆ‰∏é Excel</h4>
        <button class="btn-excel btn-template" onclick="downloadTemplate()"><i class="fas fa-file-download"></i> ‰∏ãËΩΩÂØºÂÖ•Ê®°Êùø</button>
        <button class="btn-excel btn-import" onclick="document.getElementById('excelInput').click()"><i class="fas fa-file-import"></i> ÊâπÈáèÂØºÂÖ•ÊàøÊ∫ê</button>
        <button class="btn-excel btn-export" onclick="exportToExcel()"><i class="fas fa-file-export"></i> ÂØºÂá∫ÂÖ®ÈÉ®Êï∞ÊçÆ</button>
        <div style="height: 1px; background: rgba(255,255,255,0.2); margin: 8px 0;"></div>
        <button class="btn-excel btn-backup" onclick="backupData()"><i class="fas fa-save"></i> Â§á‰ªΩÂÖ®ÈÉ®Êï∞ÊçÆ</button>
        <button class="btn-excel btn-backup" onclick="document.getElementById('backupInput').click()"><i class="fas fa-history"></i> ÊÅ¢Â§çÂ§á‰ªΩ</button>
        
        <input type="file" id="excelInput" accept=".xlsx, .xls" style="display:none" onchange="importExcel(this)">
        <input type="file" id="backupInput" accept=".json" style="display:none" onchange="restoreData(this)">
    </div>
</aside>

<main>
    <div id="globalDashboard" class="dashboard-container" style="display: none;">
        <div class="dashboard-grid">
            <div class="card" style="border-left-color: var(--warning);">
                <h3>üîî ÁßüÂÆ¢‰∫§ÁßüÈ¢ÑË≠¶</h3>
                <div id="rentAlerts" class="alert-box"><div class="alert-item alert-danger"><span>Á¥´ËôπÂòâËãë-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-3Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1906-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2403-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Èì∂Â∫ß-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ2106-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-G</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Èì∂Â∫ß-G</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2006-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-Y</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-2Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2404-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Á¥´ËôπÂòâËãë-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1906-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Á¥´ËôπÂòâËãë-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2007-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-5Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëä±Âõ≠Âüé-Ëä±Âõ≠Âüé</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2404-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Èì∂Â∫ß-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-F</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1903-3Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-H</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-8Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1903-1Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ702-5Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2403-F</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2006-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ê∞¥ÁîµË∑Ø1402-Ê∞¥ÁîµË∑Ø1402</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Á¥´ËôπÂòâËãë-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1906-G</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2007-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2007-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2404-G</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1906-F</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ702-6Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ËôπÂè∂Ëä±Ëãë-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Èì∂Â∫ß-F</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-F</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2403-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ2106-A</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-4Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ËôπÂè∂Ëä±Ëãë-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ËôπÂè∂Ëä±Ëãë-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1903-2Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-9Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2006-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2403-G</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-1Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì601-7Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1906-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ702-4Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-H</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Èì∂Â∫ß-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2403-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Èì∂Â∫ß-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Á¥´ËôπÂòâËãë-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2404-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ702-3Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Êµ∑‰º¶ÂõΩÈôÖ-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Á¥´ËôπÂòâËãë-F</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-E</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>‰π¶È¶ôÂÖ¨ÂØì701-G</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2006-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫2403-2404-2404-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ËôπÂè∂Ëä±Ëãë-B</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ËôπÂè∂Ëä±Ëãë-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1903-5Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Ëç£Ê¨£Â§ßÂé¶-2007-D</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>ÈáëÊú∫1903-4Âè∑</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-danger"><span>Â∫êËÆØ2106-C</span><b>Â∑≤Ë∂ÖÊúü</b></div><div class="alert-item alert-warning"><span>‰π¶È¶ôÂÖ¨ÂØì601-6Âè∑</span><b>ÂèØÂÇ¨Áßü</b></div><div class="alert-item alert-warning"><span>ÈáëÊú∫1903-6Âè∑</span><b>ÂèØÂÇ¨Áßü</b></div><div class="alert-item alert-warning"><span>ËôπÂè∂Ëä±Ëãë-F</span><b>ÂèØÂÇ¨Áßü</b></div><div class="alert-item alert-warning"><span>ÈáëÊú∫1906-D</span><b>ÂèØÂÇ¨Áßü</b></div><div class="alert-item alert-warning"><span>ÈáëÊú∫2403-2404-F</span><b>ÂèØÂÇ¨Áßü</b></div><div class="alert-item alert-warning"><span>Ëç£Ê¨£Â§ßÂé¶-2007-B</span><b>ÂèØÂÇ¨Áßü</b></div></div>
            </div>
            <div class="card" style="border-left-color: var(--danger);">
                <h3>üìÜ ÁªôÂ§ßÊàø‰∏ú‰∫§Èí± (7Â§©ÂÜÖ)</h3>
                <div id="landlordAlerts" class="alert-box"><div style="text-align:center;color:var(--text-muted);padding:10px">Êó†Á¥ßÊÄ•‰∫ãÈ°π</div></div>
            </div>
            <div class="card" style="border-left-color: var(--success);">
                <h3>üí∞ Êú¨ÊúàÈ¢Ñ‰º∞ÂáÄÂà© (Á≤óÁÆó)</h3>
                <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
                    <div style="font-size:24px; font-weight:bold; color:var(--text-primary); text-align: center;">
                        ¬•<span id="totalBalance">0</span>
                    </div>
                    <div style="margin-top:10px; font-size:12px; color: var(--text-secondary);">
                        <div style="text-align: center;">Êú¨ÊúàÂÆûÊî∂Áßü: ¬•<span id="monthlyIncome">0</span></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="height-slider-wrapper" title="Ë∞ÉÊï¥Âç°ÁâáÈ´òÂ∫¶">
            <input type="range" min="100" max="400" value="140" oninput="adjustCardHeight(this.value)" orient="vertical">
        </div>
    </div>

        <div id="tab-rooms" class="table-wrapper">
        <div id="roomSummaryBoard" class="summary-board">
            <div class="summary-item si-total"><span class="summary-label">ÂΩìÂâçÁ≠õÈÄâÊÄªÈ¢ù</span><span class="summary-value" id="sum-total">¬•264000 <span style="font-size:11px;color:var(--text-muted);">(97Èó¥)</span></span></div>
            <div class="summary-item si-overdue"><span class="summary-label"><i class="fas fa-exclamation-circle"></i> Â∑≤Ë∂ÖÊúü</span><span class="summary-value" id="sum-overdue">¬•215850 <span style="font-size:11px;color:var(--text-muted);">(78Èó¥)</span></span></div>
            <div class="summary-item si-urgency"><span class="summary-label"><i class="fas fa-clock"></i> ÂèØÂÇ¨Áßü</span><span class="summary-value" id="sum-urgency">¬•14550 <span style="font-size:11px;color:var(--text-muted);">(6Èó¥)</span></span></div>
            <div class="summary-item si-wait"><span class="summary-label"><i class="fas fa-check-circle"></i> ÂÜçÁ≠âÁ≠â</span><span class="summary-value" id="sum-wait">¬•3200 <span style="font-size:11px;color:var(--text-muted);">(1Èó¥)</span></span></div>
            <div class="summary-item si-vacant"><span class="summary-label"><i class="fas fa-box-open"></i> Á©∫ÁΩÆÊçüÂ§±</span><span class="summary-value" id="sum-vacant">¬•30400 <span style="font-size:11px;color:var(--text-muted);">(12Èó¥)</span></span></div>
            <div class="summary-item si-current-rent"><span class="summary-label"><i class="fas fa-hand-holding-usd"></i> Êú¨Ê¨°Êî∂Áßü</span><span class="summary-value" id="sum-current-rent">¬•1600 <span style="font-size:11px;color:var(--text-muted);">(1Èó¥)</span></span><div style="margin-top:8px;display:flex;gap:5px;justify-content:center;"><button class="btn-mini btn-clear" onclick="clearCurrentRent()">Ê∏ÖÁ©∫</button><button class="btn-mini btn-restore" onclick="restoreCurrentRent()">ÊÅ¢Â§ç</button></div></div>
        </div>


        <!-- ÈáçÊñ∞ËÆæËÆ°ÁöÑÂ∑•ÂÖ∑Ê†è -->
        <div class="toolbar-rooms">
            <!-- Á¨¨‰∏ÄË°åÔºöÊ†áÈ¢ò„ÄÅÁ≠õÈÄâÂô® -->
            <div class="toolbar-row toolbar-row-1">
                <h3 id="title-rooms" class="toolbar-title">üè† ÊàøÊ∫êÁÆ°ÁêÜ</h3>
                
                <div class="toolbar-filters">
                    <select id="filterBuilding" onchange="renderRooms()"><option value="">ÂÖ®ÈÉ®Ê•ºÊ†ã</option><option value="Á¥´ËôπÂòâËãë">Á¥´ËôπÂòâËãë</option><option value="‰π¶È¶ôÂÖ¨ÂØì601">‰π¶È¶ôÂÖ¨ÂØì601</option><option value="ÈáëÊú∫1906">ÈáëÊú∫1906</option><option value="ÈáëÊú∫2403-2404">ÈáëÊú∫2403-2404</option><option value="‰π¶È¶ôÂÖ¨ÂØì701">‰π¶È¶ôÂÖ¨ÂØì701</option><option value="Èì∂Â∫ß">Èì∂Â∫ß</option><option value="Â∫êËÆØ2106">Â∫êËÆØ2106</option><option value="Êµ∑‰º¶ÂõΩÈôÖ">Êµ∑‰º¶ÂõΩÈôÖ</option><option value="Ëç£Ê¨£Â§ßÂé¶">Ëç£Ê¨£Â§ßÂé¶</option><option value="Ëä±Âõ≠Âüé">Ëä±Âõ≠Âüé</option><option value="ÈáëÊú∫1903">ÈáëÊú∫1903</option><option value="Â∫êËÆØ702">Â∫êËÆØ702</option><option value="Ê∞¥ÁîµË∑Ø1402">Ê∞¥ÁîµË∑Ø1402</option><option value="ËôπÂè∂Ëä±Ëãë">ËôπÂè∂Ëä±Ëãë</option></select>
                    <select id="filterStatus" onchange="renderRooms()">
                        <option value="">ÂÖ®ÈÉ®Êî∂ÁßüÁä∂ÊÄÅ</option>
                        <option value="Â∑≤Ë∂ÖÊúü">üö® Â∑≤Ë∂ÖÊúü</option>
                        <option value="ÂèØÂÇ¨Áßü">‚ö†Ô∏è ÂèØÂÇ¨Áßü</option>
                        <option value="ÂÜçÁ≠âÁ≠â">‚úÖ ÂÜçÁ≠âÁ≠â</option>
                        <option value="Á©∫ÁΩÆ">‚¨ú Á©∫ÁΩÆ</option>
                    </select>
                    
                    <span style="color:var(--text-secondary); font-size:11px; margin-left:5px;">‰∫§ÁßüÊó•ËåÉÂõ¥:</span>
                    <input type="date" id="searchStart" class="date-filter" onchange="renderRooms()">
                    <span style="color:var(--text-secondary)">-</span>
                    <input type="date" id="searchEnd" class="date-filter" onchange="renderRooms()">
                </div>
            </div>
            
            <!-- Á¨¨‰∫åË°åÔºöÂèØÊãñÊãΩÊéíÂ∫èÁöÑÊìç‰ΩúÊåâÈíÆÁªÑ -->
            <div class="toolbar-row toolbar-row-2">
                <div class="toolbar-actions-container" id="toolbarActions"><div class="toolbar-btn-item" draggable="true" data-btn-id="colSetup"><button class="action act-cols" onclick="openColumnSetup()"><i class="fas fa-eye"></i> ÊòæÁ§∫ËÆæÁΩÆ</button></div><div class="action-divider"></div><div class="toolbar-btn-item" draggable="true" data-btn-id="rentShot"><button class="action act-out" onclick="screenshotRent()"><i class="fas fa-camera"></i> ÂÇ¨ÁßüÊà™Âõæ</button></div><div class="action-divider"></div><div class="toolbar-btn-item" draggable="true" data-btn-id="vacantShot"><button class="action act-in" onclick="screenshotVacant()"><i class="fas fa-bullhorn"></i> ÊãõÁßüÊà™Âõæ</button></div><div class="action-divider"></div><div class="toolbar-btn-item" draggable="true" data-btn-id="bulkEdit"><button class="action act-repair" onclick="openBulkEditModal()"><i class="fas fa-edit"></i> ÊàøÊ∫ê‰øÆÊîπ</button></div><div class="action-divider"></div><div class="toolbar-btn-item" draggable="true" data-btn-id="addRoom"><button class="action act-in" onclick="openRoomModal()"><i class="fas fa-plus"></i> Êñ∞Â¢ûÊàøÊ∫ê</button></div><div class="action-divider"></div><div class="toolbar-btn-item" draggable="true" data-btn-id="batchRent"><button class="action act-batch" onclick="batchConfirmRent()"><i class="fas fa-check-double"></i> ‰∏ÄÈîÆÊî∂Áßü</button></div></div>
            </div>
        </div>
        
        <div class="table-scroll-container">
            <table id="roomTable">
                <thead id="roomHead"><tr><th class="draggable " draggable="true" style="width: 30px;" data-col="chk" data-type="room" ondragstart="handleDragStart(event, 'chk', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'chk', 'room')">
              <input type="checkbox" id="roomSelectAll" class="room-check" onclick="toggleSelectAll()">
              </th><th class="draggable " draggable="true" style="width: 60px;" data-col="building" data-type="room" onclick="handleSort('room', 'building')" ondragstart="handleDragStart(event, 'building', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'building', 'room')">
              Ê•ºÊ†ã/Â∞èÂå∫<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 60px;" data-col="room" data-type="room" onclick="handleSort('room', 'room')" ondragstart="handleDragStart(event, 'room', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'room', 'room')">
              ÊàøÂè∑<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 60px;" data-col="price" data-type="room" onclick="handleSort('room', 'price')" ondragstart="handleDragStart(event, 'price', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'price', 'room')">
              ÊúàÁßüÈáë<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 80px;" data-col="nextPayDate" data-type="room" onclick="handleSort('room', 'nextPayDate')" ondragstart="handleDragStart(event, 'nextPayDate', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'nextPayDate', 'room')">
              ‰∏ãÊ¨°‰∫§ÁßüÊó•<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 60px;" data-col="rentStatus" data-type="room" onclick="handleSort('room', 'rentStatus')" ondragstart="handleDragStart(event, 'rentStatus', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'rentStatus', 'room')">
              Êî∂ÁßüÁä∂ÊÄÅ<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 60px;" data-col="notes" data-type="room" onclick="handleSort('room', 'notes')" ondragstart="handleDragStart(event, 'notes', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'notes', 'room')">
              Â§áÊ≥®<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="op" data-type="room" onclick="handleSort('room', 'op')" ondragstart="handleDragStart(event, 'op', 'room')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'op', 'room')">
              Êìç‰Ωú<span class="sort-icon fa"></span>
              </th></tr></thead>
                <tbody id="roomBody"><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439011)"></td><td>Á¥´ËôπÂòâËãë</td><td><b>A</b></td><td>¬•1600</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439011)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439011)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439011)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439011)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439012)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>3Âè∑</b></td><td>¬•2300</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439012)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439012)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439012)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439012)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439013)"></td><td>ÈáëÊú∫1906</td><td><b>A</b></td><td>¬•3500</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439013)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439013)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439013)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439013)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439014)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-B</b></td><td>¬•2400</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439014)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439014)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439014)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439014)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439015)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>A</b></td><td>¬•1900</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439015)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439015)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439015)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439015)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439016)"></td><td>Èì∂Â∫ß</td><td><b>D</b></td><td>¬•2400</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439016)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439016)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439016)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439016)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439017)"></td><td>Â∫êËÆØ2106</td><td><b>E</b></td><td>¬•1500</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439017)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439017)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439017)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439017)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439018)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>G</b></td><td>¬•2200</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439018)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439018)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439018)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439018)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439019)"></td><td>Èì∂Â∫ß</td><td><b>G</b></td><td>¬•3600</td><td>2025-12-28 <button class="act-date-small" onclick="openDateModal(1768245439019)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439019)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439019)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439019)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439020)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>C</b></td><td>¬•2350</td><td>2025-12-30 <button class="act-date-small" onclick="openDateModal(1768245439020)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439020)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439020)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439020)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439021)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>C</b></td><td>¬•2500</td><td>2025-12-30 <button class="act-date-small" onclick="openDateModal(1768245439021)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439021)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439021)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439021)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439022)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2006-A</b></td><td>¬•2500</td><td>2026-01-01 <button class="act-date-small" onclick="openDateModal(1768245439022)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439022)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439022)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439022)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439023)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>Y</b></td><td>¬•2300</td><td>2026-01-01 <button class="act-date-small" onclick="openDateModal(1768245439023)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439023)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439023)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439023)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439024)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>2Âè∑</b></td><td>¬•2100</td><td>2026-01-01 <button class="act-date-small" onclick="openDateModal(1768245439024)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439024)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439024)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439024)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439025)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2404-A</b></td><td>¬•2000</td><td>2026-01-01 <button class="act-date-small" onclick="openDateModal(1768245439025)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439025)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439025)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439025)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439026)"></td><td>Á¥´ËôπÂòâËãë</td><td><b>C</b></td><td>¬•2400</td><td>2026-01-01 <button class="act-date-small" onclick="openDateModal(1768245439026)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439026)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439026)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439026)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439027)"></td><td>ÈáëÊú∫1906</td><td><b>C</b></td><td>¬•2600</td><td>2026-01-01 <button class="act-date-small" onclick="openDateModal(1768245439027)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439027)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439027)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439027)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439028)"></td><td>Á¥´ËôπÂòâËãë</td><td><b>E</b></td><td>¬•3200</td><td>2026-01-02 <button class="act-date-small" onclick="openDateModal(1768245439028)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439028)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439028)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439028)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439029)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2007-A</b></td><td>¬•2400</td><td>2026-01-02 <button class="act-date-small" onclick="openDateModal(1768245439029)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439029)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439029)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439029)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439030)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>5Âè∑</b></td><td>¬•2300</td><td>2026-01-02 <button class="act-date-small" onclick="openDateModal(1768245439030)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439030)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439030)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439030)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439031)"></td><td>Ëä±Âõ≠Âüé</td><td><b>Ëä±Âõ≠Âüé</b></td><td>¬•27000</td><td>2026-01-02 <button class="act-date-small" onclick="openDateModal(1768245439031)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439031)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439031)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439031)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439032)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2404-E</b></td><td>¬•2600</td><td>2026-01-03 <button class="act-date-small" onclick="openDateModal(1768245439032)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439032)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439032)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439032)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439033)"></td><td>Èì∂Â∫ß</td><td><b>C</b></td><td>¬•3400</td><td>2026-01-03 <button class="act-date-small" onclick="openDateModal(1768245439033)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439033)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439033)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439033)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439034)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>F</b></td><td>¬•2300</td><td>2026-01-04 <button class="act-date-small" onclick="openDateModal(1768245439034)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439034)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439034)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439034)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439035)"></td><td>ÈáëÊú∫1903</td><td><b>3Âè∑</b></td><td>¬•2500</td><td>2026-01-04 <button class="act-date-small" onclick="openDateModal(1768245439035)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439035)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439035)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439035)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439036)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>H</b></td><td>¬•1700</td><td>2026-01-04 <button class="act-date-small" onclick="openDateModal(1768245439036)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439036)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439036)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439036)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439037)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>8Âè∑</b></td><td>¬•2000</td><td>2026-01-04 <button class="act-date-small" onclick="openDateModal(1768245439037)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439037)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439037)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439037)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439038)"></td><td>ÈáëÊú∫1903</td><td><b>1Âè∑</b></td><td>¬•1500</td><td>2026-01-04 <button class="act-date-small" onclick="openDateModal(1768245439038)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439038)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439038)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439038)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439039)"></td><td>Â∫êËÆØ702</td><td><b>5Âè∑</b></td><td>¬•1400</td><td>2026-01-05 <button class="act-date-small" onclick="openDateModal(1768245439039)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439039)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439039)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439039)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439040)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-F</b></td><td>¬•1850</td><td>2026-01-05 <button class="act-date-small" onclick="openDateModal(1768245439040)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439040)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439040)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439040)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439041)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2006-D</b></td><td>¬•3700</td><td>2026-01-05 <button class="act-date-small" onclick="openDateModal(1768245439041)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439041)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439041)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439041)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439042)"></td><td>Ê∞¥ÁîµË∑Ø1402</td><td><b>Ê∞¥ÁîµË∑Ø1402</b></td><td>¬•5700</td><td>2026-01-05 <button class="act-date-small" onclick="openDateModal(1768245439042)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439042)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439042)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439042)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439043)"></td><td>Á¥´ËôπÂòâËãë</td><td><b>B</b></td><td>¬•1750</td><td>2026-01-06 <button class="act-date-small" onclick="openDateModal(1768245439043)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439043)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439043)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439043)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439044)"></td><td>ÈáëÊú∫1906</td><td><b>G</b></td><td>¬•1400</td><td>2026-01-07 <button class="act-date-small" onclick="openDateModal(1768245439044)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439044)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439044)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439044)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439045)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2007-E</b></td><td>¬•3400</td><td>2026-01-08 <button class="act-date-small" onclick="openDateModal(1768245439045)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439045)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439045)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439045)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439046)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>B</b></td><td>¬•2100</td><td>2026-01-08 <button class="act-date-small" onclick="openDateModal(1768245439046)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439046)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439046)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439046)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439047)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2007-C</b></td><td>¬•3500</td><td>2026-01-08 <button class="act-date-small" onclick="openDateModal(1768245439047)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439047)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439047)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439047)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439048)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2404-G</b></td><td>¬•1800</td><td>2026-01-09 <button class="act-date-small" onclick="openDateModal(1768245439048)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439048)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439048)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439048)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439049)"></td><td>ÈáëÊú∫1906</td><td><b>F</b></td><td>¬•1600</td><td>2026-01-09 <button class="act-date-small" onclick="openDateModal(1768245439049)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439049)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439049)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439049)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439050)"></td><td>Â∫êËÆØ702</td><td><b>6Âè∑</b></td><td>¬•1500</td><td>2026-01-10 <button class="act-date-small" onclick="openDateModal(1768245439050)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439050)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439050)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439050)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439051)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>A</b></td><td>¬•3500</td><td>2026-01-10 <button class="act-date-small" onclick="openDateModal(1768245439051)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439051)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439051)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439051)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439052)"></td><td>Èì∂Â∫ß</td><td><b>F</b></td><td>¬•3700</td><td>2026-01-10 <button class="act-date-small" onclick="openDateModal(1768245439052)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439052)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439052)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439052)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439053)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>F</b></td><td>¬•1800</td><td>2026-01-10 <button class="act-date-small" onclick="openDateModal(1768245439053)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439053)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439053)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439053)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439054)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-A</b></td><td>¬•1700</td><td>2026-01-11 <button class="act-date-small" onclick="openDateModal(1768245439054)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439054)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439054)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439054)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439055)"></td><td>Â∫êËÆØ2106</td><td><b>A</b></td><td>¬•2500</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439055)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439055)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439055)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439055)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439056)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>4Âè∑</b></td><td>¬•1300</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439056)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439056)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439056)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439056)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439057)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>D</b></td><td>¬•2000</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439057)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439057)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439057)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439057)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439058)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>E</b></td><td>¬•2200</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439058)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439058)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439058)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439058)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439059)"></td><td>ÈáëÊú∫1903</td><td><b>2Âè∑</b></td><td>¬•1500</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439059)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439059)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439059)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439059)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439060)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>B</b></td><td>¬•2300</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439060)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439060)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439060)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439060)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439061)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>D</b></td><td>¬•1500</td><td>2026-01-12 <button class="act-date-small" onclick="openDateModal(1768245439061)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439061)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439061)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439061)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439062)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>9Âè∑</b></td><td>¬•2000</td><td>2026-01-13 <button class="act-date-small" onclick="openDateModal(1768245439062)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439062)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439062)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439062)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439063)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2006-B</b></td><td>¬•3300</td><td>2026-01-13 <button class="act-date-small" onclick="openDateModal(1768245439063)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439063)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439063)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439063)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439064)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-G</b></td><td>¬•1900</td><td>2026-01-14 <button class="act-date-small" onclick="openDateModal(1768245439064)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439064)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439064)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439064)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439065)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>1Âè∑</b></td><td>¬•1700</td><td>2026-01-14 <button class="act-date-small" onclick="openDateModal(1768245439065)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439065)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439065)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439065)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439066)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>7Âè∑</b></td><td>¬•1500</td><td>2026-01-15 <button class="act-date-small" onclick="openDateModal(1768245439066)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439066)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439066)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439066)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439067)"></td><td>ÈáëÊú∫1906</td><td><b>E</b></td><td>¬•1900</td><td>2026-01-15 <button class="act-date-small" onclick="openDateModal(1768245439067)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439067)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439067)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439067)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439068)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>E</b></td><td>¬•2800</td><td>2026-01-15 <button class="act-date-small" onclick="openDateModal(1768245439068)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439068)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439068)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439068)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439069)"></td><td>Â∫êËÆØ702</td><td><b>4Âè∑</b></td><td>¬•3350</td><td>2026-01-15 <button class="act-date-small" onclick="openDateModal(1768245439069)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439069)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439069)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439069)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439070)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>H</b></td><td>¬•2300</td><td>2026-01-15 <button class="act-date-small" onclick="openDateModal(1768245439070)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439070)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439070)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439070)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439071)"></td><td>Èì∂Â∫ß</td><td><b>B</b></td><td>¬•3400</td><td>2026-01-16 <button class="act-date-small" onclick="openDateModal(1768245439071)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439071)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439071)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439071)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439072)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-E</b></td><td>¬•2600</td><td>2026-01-17 <button class="act-date-small" onclick="openDateModal(1768245439072)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439072)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439072)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439072)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439073)"></td><td>Èì∂Â∫ß</td><td><b>E</b></td><td>¬•2500</td><td>2026-01-17 <button class="act-date-small" onclick="openDateModal(1768245439073)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439073)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439073)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439073)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439074)"></td><td>Á¥´ËôπÂòâËãë</td><td><b>D</b></td><td>¬•2900</td><td>2026-01-18 <button class="act-date-small" onclick="openDateModal(1768245439074)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439074)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439074)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439074)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439075)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2404-C</b></td><td>¬•3600</td><td>2026-01-18 <button class="act-date-small" onclick="openDateModal(1768245439075)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439075)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439075)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439075)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439076)"></td><td>Â∫êËÆØ702</td><td><b>3Âè∑</b></td><td>¬•2400</td><td>2026-01-18 <button class="act-date-small" onclick="openDateModal(1768245439076)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439076)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439076)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439076)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439077)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>D</b></td><td>¬•2700</td><td>2026-01-19 <button class="act-date-small" onclick="openDateModal(1768245439077)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439077)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439077)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439077)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439078)"></td><td>Á¥´ËôπÂòâËãë</td><td><b>F</b></td><td>¬•2600</td><td>2026-01-19 <button class="act-date-small" onclick="openDateModal(1768245439078)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439078)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439078)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439078)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439079)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>E</b></td><td>¬•2500</td><td>2026-01-19 <button class="act-date-small" onclick="openDateModal(1768245439079)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439079)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439079)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439079)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439080)"></td><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td><b>G</b></td><td>¬•2000</td><td>2026-01-19 <button class="act-date-small" onclick="openDateModal(1768245439080)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439080)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439080)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439080)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439081)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2006-C</b></td><td>¬•3600</td><td>2026-01-19 <button class="act-date-small" onclick="openDateModal(1768245439081)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439081)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439081)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439081)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439082)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2404-B</b></td><td>¬•2500</td><td>2026-01-19 <button class="act-date-small" onclick="openDateModal(1768245439082)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439082)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439082)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439082)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439083)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>B</b></td><td>¬•2700</td><td>2026-01-20 <button class="act-date-small" onclick="openDateModal(1768245439083)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439083)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439083)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439083)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439084)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>C</b></td><td>¬•2500</td><td>2026-01-22 <button class="act-date-small" onclick="openDateModal(1768245439084)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439084)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439084)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439084)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439085)"></td><td>ÈáëÊú∫1903</td><td><b>5Âè∑</b></td><td>¬•2650</td><td>2026-01-22 <button class="act-date-small" onclick="openDateModal(1768245439085)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439085)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439085)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439085)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439086)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2007-D</b></td><td>¬•3600</td><td>2026-01-22 <button class="act-date-small" onclick="openDateModal(1768245439086)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439086)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439086)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439086)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439087)"></td><td>ÈáëÊú∫1903</td><td><b>4Âè∑</b></td><td>¬•3300</td><td>2026-01-23 <button class="act-date-small" onclick="openDateModal(1768245439087)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439087)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439087)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439087)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439088)"></td><td>Â∫êËÆØ2106</td><td><b>C</b></td><td>¬•2300</td><td>2026-01-23 <button class="act-date-small" onclick="openDateModal(1768245439088)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-overdue">Â∑≤Ë∂ÖÊúü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-confirm" onclick="confirmRent(1768245439088)">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439088)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439088)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439089)"></td><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td><b>6Âè∑</b></td><td>¬•1500</td><td>2026-01-24 <button class="act-date-small" onclick="openDateModal(1768245439089)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-urgency">ÂèØÂÇ¨Áßü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439089)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439089)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439090)"></td><td>ÈáëÊú∫1903</td><td><b>6Âè∑</b></td><td>¬•3700</td><td>2026-01-25 <button class="act-date-small" onclick="openDateModal(1768245439090)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-urgency">ÂèØÂÇ¨Áßü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439090)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439090)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439091)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>F</b></td><td>¬•2000</td><td>2026-01-25 <button class="act-date-small" onclick="openDateModal(1768245439091)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-urgency">ÂèØÂÇ¨Áßü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439091)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439091)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439092)"></td><td>ÈáëÊú∫1906</td><td><b>D</b></td><td>¬•2200</td><td>2026-01-25 <button class="act-date-small" onclick="openDateModal(1768245439092)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-urgency">ÂèØÂÇ¨Áßü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439092)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439092)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439093)"></td><td>ÈáëÊú∫2403-2404</td><td><b>F</b></td><td>¬•1850</td><td>2026-01-25 <button class="act-date-small" onclick="openDateModal(1768245439093)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-urgency">ÂèØÂÇ¨Áßü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439093)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439093)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439094)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2007-B</b></td><td>¬•3300</td><td>2026-01-25 <button class="act-date-small" onclick="openDateModal(1768245439094)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-urgency">ÂèØÂÇ¨Áßü</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439094)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439094)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439095)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2404-D</b></td><td>¬•3200</td><td>2026-02-25 <button class="act-date-small" onclick="openDateModal(1768245439095)"><i class="fas fa-edit"></i></button></td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439095)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439095)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439096)"></td><td>Â∫êËÆØ702</td><td><b>1Âè∑</b></td><td>¬•2800</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439096)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439096)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439096)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439097)"></td><td>Â∫êËÆØ2106</td><td><b>B</b></td><td>¬•2500</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439097)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439097)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439097)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439098)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-D</b></td><td>¬•1700</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439098)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439098)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439098)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439099)"></td><td>Èì∂Â∫ß</td><td><b>A</b></td><td>¬•2400</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439099)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439099)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439099)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439100)"></td><td>ËôπÂè∂Ëä±Ëãë</td><td><b>G</b></td><td>¬•2200</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439100)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439100)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439100)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439101)"></td><td>ÈáëÊú∫1906</td><td><b>B</b></td><td>¬•2600</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439101)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439101)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439101)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439102)"></td><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td><b>A</b></td><td>¬•1900</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439102)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439102)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439102)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439103)"></td><td>Â∫êËÆØ702</td><td><b>2Âè∑</b></td><td>¬•2500</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439103)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439103)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439103)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439104)"></td><td>Ëç£Ê¨£Â§ßÂé¶</td><td><b>2006-E</b></td><td>¬•2400</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439104)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439104)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439104)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439105)"></td><td>ÈáëÊú∫2403-2404</td><td><b>2403-C</b></td><td>¬•3600</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439105)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439105)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439105)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439106)"></td><td>Â∫êËÆØ2106</td><td><b>D</b></td><td>¬•3400</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439106)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439106)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439106)">ËÆ∞ÂΩï</button></div></td></tr><tr><td><input type="checkbox" class="room-check" onclick="toggleSelectRow(1768245439107)"></td><td>Èì∂Â∫ß</td><td><b>H</b></td><td>¬•2400</td><td><span style="color:var(--text-muted)">Êó†</span> <button class="act-date-small" onclick="openDateModal(1768245439107)"><i class="fas fa-edit"></i></button></td><td><span class="badge st-0">Á©∫ÁΩÆ</span></td><td><span style="color:var(--text-secondary); font-size:11px;"></span></td><td><div class="btn-group-uniform"><button class="action act-disabled" disabled="">Êî∂Áßü</button> <button class="action act-edit" onclick="openRoomModal(1768245439107)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', 1768245439107)">ËÆ∞ÂΩï</button></div></td></tr></tbody>
                <tfoot id="roomFoot" style="display:none;"></tfoot> 
            </table>
        </div>
        <div style="color:var(--text-muted); font-size:11px; margin-top:5px; text-align:right;">
    <i class="fas fa-hand-pointer"></i> ÊèêÁ§∫ÔºöÁÇπÂáªË°®Â§¥ÂèØ<b>ÊéíÂ∫è</b>ÔºåÊåâ‰ΩèË°®Â§¥ÂèØ<b>ÊãñÂä®‰ΩçÁΩÆ</b>ÔºåÂú®<b>ÊòæÁ§∫ËÆæÁΩÆ</b>‰∏≠ÂèØË∞ÉÊï¥ÂàóÂÆΩÔºõÂ∑•ÂÖ∑Ê†èÊåâÈíÆ‰πüÂèØÊãñÊãΩÊéíÂ∫è
</div>
    </div>

    <div id="tab-landlord" class="table-wrapper hidden">
        <div class="toolbar">
            <h3 id="title-landlord" style="margin:0; margin-right:20px;">üìÜ ‰ªòÊ¨æÊèêÈÜí</h3>
            <input type="text" id="searchPlan" class="search-box" placeholder="ÊêúÁ¥¢‰ø°ÊÅØ..." onkeyup="renderPlans()">
            <div style="flex:1"></div>
            <button class="action act-cols" onclick="openPlanColumnSetup()"><i class="fas fa-eye"></i> ÊòæÁ§∫ËÆæÁΩÆ</button>
            <button class="action act-in" onclick="openPlanModal()">+ Êñ∞Â¢ûËÆ°Âàí</button>
        </div>

        <div class="table-scroll-container">
            <table id="planTable">
                <thead id="planHead"><tr><th class="draggable " draggable="true" style="width: 88px;" data-col="building" data-type="plan" onclick="handleSort('plan', 'building')" ondragstart="handleDragStart(event, 'building', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'building', 'plan')">
              ÂØπÂ∫îÊ•ºÊ†ã<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 66px;" data-col="payCount" data-type="plan" onclick="handleSort('plan', 'payCount')" ondragstart="handleDragStart(event, 'payCount', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'payCount', 'plan')">
              ‰∫§ÁßüÊ¨°Êï∞<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 66px;" data-col="amount" data-type="plan" onclick="handleSort('plan', 'amount')" ondragstart="handleDragStart(event, 'amount', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'amount', 'plan')">
              Â∫î‰ªòÈáëÈ¢ù<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 66px;" data-col="status" data-type="plan" onclick="handleSort('plan', 'status')" ondragstart="handleDragStart(event, 'status', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'status', 'plan')">
              Áä∂ÊÄÅ<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="nextPayDate" data-type="plan" onclick="handleSort('plan', 'nextPayDate')" ondragstart="handleDragStart(event, 'nextPayDate', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'nextPayDate', 'plan')">
              ‰∏ãÊ¨°‰∫§ÁßüÊó•<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 180px;" data-col="notes" data-type="plan" onclick="handleSort('plan', 'notes')" ondragstart="handleDragStart(event, 'notes', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'notes', 'plan')">
              Â§áÊ≥®<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 241px;" data-col="op" data-type="plan" onclick="handleSort('plan', 'op')" ondragstart="handleDragStart(event, 'op', 'plan')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'op', 'plan')">
              Êìç‰Ωú<span class="sort-icon fa"></span>
              </th></tr></thead>
                <tbody id="planBody"><tr><td>Á¥´ËôπÂòâËãë</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•34500</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-03-25 <button class="act-date-small" onclick="openPlanDateModalWrapper(0)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2024Âπ¥7Êúà1Êó•-2027Âπ¥1Êúà1Êó•
2„ÄÅÊàøÁßüÔºö11500/ÊúàÔºõ
3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥7Êúà1Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(0)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 0)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Èì∂Â∫ß</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•44100</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-04-13 <button class="act-date-small" onclick="openPlanDateModalWrapper(5)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅ‰ºçÊô®Êô®Ôºö618ÂÆ§  7500*3=22500
2„ÄÅÂéâËä≥Á∫¢Ôºö619ÂÆ§  7200*3=21600</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(5)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 5)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•30000</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-03-25 <button class="act-date-small" onclick="openPlanDateModalWrapper(7)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2024Âπ¥10Êúà1Êó•-2031Âπ¥10Êúà1Êó•
2„ÄÅÊàøÁßüÔºö10000/ÊúàÔºõ
3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥10Êúà1Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1
5„ÄÅÊÄªÂÖ±3‰∏™ÊúàÁ©∫ÂÖ≥ÊúüÔºå24Âπ¥ÂáèÂÖç1.5‰∏™ÊúàÔºå25Âπ¥ÂáèÂÖç1‰∏™ÊúàÔºå26Âπ¥ÂáèÂÖç0.5‰∏™Êúà</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(7)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 7)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ËôπÂè∂Ëä±Ëãë</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•30600</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-02-21 <button class="act-date-small" onclick="openPlanDateModalWrapper(13)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1 „ÄÅÊúüÈôêÔºö2024Âπ¥8Êúà28Êó•-2028Âπ¥8Êúà27Êó•Ôºà10200ÂÖÉÔºâ
       ÊúüÈôêÔºö2028Âπ¥8Êúà28Êó•-2032Âπ¥8Êúà27Êó•Ôºà10700ÂÖÉÔºâ
2„ÄÅÊàøÁßüÔºö10200/Êúà„ÄÅ10700/Êúà
3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥8Êúà28Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1
5„ÄÅÂÆûÈôÖ‰∫§Êàø2024Âπ¥5Êúà18Êó•ÔºåÈÄÅ3‰∏™Êúà+10Â§©Á©∫ÂÖ≥Êúü</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(13)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 13)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Ê∞¥ÁîµË∑Ø1402</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•13500</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-02-01 <button class="act-date-small" onclick="openPlanDateModalWrapper(12)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2023Âπ¥8Êúà8Êó•-2029Âπ¥8Êúà7Êó•ÔºàÈÄÅÁ©∫ÂÖ≥Êúü3‰∏™ÊúàÔºâ‰ª•ÂêéÊØèÂπ¥ÈÄÅ10Â§©Á©∫ÂÖ≥Êúü
2„ÄÅÊàøÁßüÔºö4500/ÊúàÔºõÔºà6Âπ¥‰∏çÊ∂®‰ª∑Ôºâ
3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥8Êúà8Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(12)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 12)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Â∫êËÆØ702</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•27300</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-04-06 <button class="act-date-small" onclick="openPlanDateModalWrapper(11)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2023Âπ¥7Êúà13Êó•-2031Âπ¥7Êúà12Êó•
2„ÄÅÊàøÁßüÔºö9100/ÊúàÔºõÂæÄÂêéÊØè3Âπ¥ÈÄíÂ¢û500/Êúà
3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥7Êúà13Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2
5„ÄÅÂÆûÈôÖ‰∫§Êàø4Êúà13Êó•ÔºåÈÄÅ3‰∏™ÊúàÁ©∫ÂÖ≥Êúü</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(11)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 11)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ÈáëÊú∫1903</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•32400</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-03-03 <button class="act-date-small" onclick="openPlanDateModalWrapper(10)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2023Âπ¥6Êúà10Êó•-2029Âπ¥6Êúà9Êó•
2„ÄÅÊàøÁßüÔºö10800/ÊúàÔºõ
3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥6Êúà10Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2
5„ÄÅÂÆûÈôÖ‰∫§Êàø4Êúà10Êó•ÔºåÈÄÅ2‰∏™ÊúàÁ©∫ÂÖ≥Êúü</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(10)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 10)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Ëä±Âõ≠Âüé</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•27000</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-03-26 <button class="act-date-small" onclick="openPlanDateModalWrapper(9)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊàøÁßüÔºö9000/ÊúàÔºõ
2„ÄÅÊúüÈôêÔºö2024Âπ¥4Êúà2Êó•-2034Âπ¥4Êúà1Êó•
3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥4Êúà2Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1ÔºàÊØèÂπ¥ÂÖçÁßüÊúü15Â§©Ôºâ</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(9)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 9)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Ëç£Ê¨£Â§ßÂé¶</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•65000</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-03-25 <button class="act-date-small" onclick="openPlanDateModalWrapper(8)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2023Âπ¥7Êúà1Êó•-2026Âπ¥9Êúà30Êó•
2„ÄÅÊàøÁßüÔºö23000/ÊúàÔºõ
3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥7Êúà1Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº1</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(8)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 8)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Â∫êËÆØ2106</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•25500</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-04-03 <button class="act-date-small" onclick="openPlanDateModalWrapper(6)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;"></div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(6)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 6)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•30000</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-04-18 <button class="act-date-small" onclick="openPlanDateModalWrapper(4)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2025Âπ¥3Êúà25Êó•-2028Âπ¥3Êúà24Êó•
2„ÄÅÊàøÁßüÔºö10000/ÊúàÔºõ
3„ÄÅËµ∑ÁßüÊó•Ôºö2025Âπ¥10Êúà25Êó•ÔºàÂºÄÂßã‰∫§ÊàøÁßüÔºâ
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2
5„ÄÅÈÄÅ7‰∏™ÊúàÁ©∫ÂÖ≥ÊúüÔºå2025Âπ¥10Êúà25Êó•ÂºÄÂßã‰∫§ÊàøÁßü„ÄÇ</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(4)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 4)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ÈáëÊú∫2403-2404</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•72268</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-04-13 <button class="act-date-small" onclick="openPlanDateModalWrapper(3)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;"></div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(3)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 3)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ÈáëÊú∫1906</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•32400</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-03-25 <button class="act-date-small" onclick="openPlanDateModalWrapper(2)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊúüÈôêÔºö2024Âπ¥7Êúà1Êó•-2030Âπ¥6Êúà30Êó•
2„ÄÅÊàøÁßüÔºö10800/ÊúàÔºõ
3„ÄÅËµ∑ÁßüÊó•Ôºö2024Âπ¥7Êúà1Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(2)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 2)">ËÆ∞ÂΩï</button></div></td></tr><tr><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td>0Ê¨°</td><td style="font-weight:bold; color:#dc2626">¬•30000</td><td><span class="badge rent-wait">ÂÜçÁ≠âÁ≠â</span></td><td>2026-04-08 <button class="act-date-small" onclick="openPlanDateModalWrapper(1)"><i class="fas fa-edit"></i></button></td><td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">1„ÄÅÊàøÁßüÔºö10000/ÊúàÔºõ
2„ÄÅÊúüÈôêÔºö2022Âπ¥12Êúà15Êó•-2025Âπ¥12Êúà14Êó•
3„ÄÅËµ∑ÁßüÊó•Ôºö2023Âπ¥10Êúà15Êó•
4„ÄÅÁßüÈáëÊîØ‰ªòÊñπÂºèÔºö‰∫§3Êäº2</div></td><td><div class="btn-group-uniform"><button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button> <button class="action act-edit" onclick="editPlan(1)">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', 1)">ËÆ∞ÂΩï</button></div></td></tr></tbody>
            </table>
        </div>
        <div style="color:var(--text-muted); font-size:11px; margin-top:5px; text-align:right;">
     <i class="fas fa-hand-pointer"></i> ÊèêÁ§∫ÔºöÁÇπÂáªË°®Â§¥ÂèØ<b>ÊéíÂ∫è</b>ÔºåÊåâ‰ΩèË°®Â§¥ÂèØ<b>ÊãñÂä®‰ΩçÁΩÆ</b>ÔºåÂú®<b>ÊòæÁ§∫ËÆæÁΩÆ</b>‰∏≠ÂèØË∞ÉÊï¥ÂàóÂÆΩ
</div>

    </div>

        <div id="tab-finance" class="table-wrapper hidden">
        <div class="toolbar">
            <h3 id="title-finance">üí∞ Ë¥¢Âä°Ê±áÊÄª (Á¥ØËÆ°ÂÖ®Âë®Êúü)</h3>
            <div style="flex:1"></div>
            <button class="action act-in" onclick="renderFinance()"><i class="fas fa-sync-alt"></i> Âà∑Êñ∞Êï∞ÊçÆ</button>
        </div>
        
        <div id="financeHeaderStats" class="summary-board"><div class="summary-item si-income"><span class="summary-label">Á¥ØËÆ°ÂÆûÊî∂ÁßüÈáë</span><span class="summary-value">¬•0</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°ÂÆû‰∫§ÊàøÁßü</span><span class="summary-value">¬•0</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°Ë£Ö‰øÆÊàêÊú¨</span><span class="summary-value">¬•0</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°Áª¥Êä§ÊàêÊú¨</span><span class="summary-value">¬•0</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°ÈÄÄÁßüÊäºÈáë</span><span class="summary-value">¬•0</span></div><div class="summary-item si-profit"><span class="summary-label">ÂéÜÂè≤ÊÄªÂà©Ê∂¶</span><span class="summary-value">¬•0</span></div></div>

        <div style="background:#fff7ed; color:#c2410c; padding:10px; font-size:12px; margin-bottom:10px; border-radius:var(--border-radius-sm);">
            <div style="margin-bottom:5px;"><i class="fas fa-info-circle"></i> <b>Á≥ªÁªüËØ¥ÊòéÔºö</b></div>
            <ul style="margin:0; padding-left:20px;">
                <li><b>Êô∫ËÉΩÊéíÂ∫èÔºö</b>ÂΩì‰ªªÊÑèÊ•ºÊ†ã‰∫ßÁîüÊñ∞ÁöÑËµÑÈáëÂèòÂä®ÔºàÊî∂Áßü„ÄÅ‰∫§Áßü„ÄÅÁª¥‰øÆÁ≠âÔºâÊàñÁºñËæëÊó∂ÔºåËØ•Ê•ºÊ†ã‰ºöËá™Âä®‰∏äÊµÆËá≥È°∂ÈÉ®„ÄÇ</li>
                <li><b>Êï∞ÊçÆÂÖ≥ËÅîÔºö</b>ÊâÄÊúâÊï∞ÊçÆÂ∑≤Ëá™Âä®ÂÆûÊó∂ÂÖ≥ËÅî„ÄÇÂè™Ë¶ÅÂú®ÊàøÊ∫êÁÆ°ÁêÜ‰∏≠Êî∂Áßü„ÄÅÂú®‰ªòÊ¨æÊèêÈÜí‰∏≠‰∫§Áßü„ÄÅÊàñÊ∑ªÂä†ÊàêÊú¨ÔºåÊ≠§Â§Ñ‰ºöËá™Âä®Êõ¥Êñ∞„ÄÇ</li>
                <li><b>Á≤æÁ°ÆËÆ∞ÂΩïÔºö</b>ÁÇπÂáªÊìç‰ΩúÂàóÁöÑ"ËÆ∞ÂΩï"ÊåâÈíÆÔºåÂèØÊü•ÁúãËØ•Ê•ºÊ†ãÊØè‰∏ÄÁ¨îËµÑÈáëÂèòÂä®ÁöÑÁ≤æÁ°ÆÊó∂Èó¥ÔºàÊó∂:ÂàÜ:ÁßíÔºâ„ÄÇ</li>
            </ul>
        </div>
        <div class="table-scroll-container">
            <table class="finance-table" id="financeTable">
                <thead id="financeHead"><tr><th class="draggable " draggable="true" style="width: 100px;" data-col="building" data-type="finance" onclick="handleSort('finance', 'building')" ondragstart="handleDragStart(event, 'building', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'building', 'finance')">
              Ê•ºÊ†ã/Â∞èÂå∫<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="roomCount" data-type="finance" onclick="handleSort('finance', 'roomCount')" ondragstart="handleDragStart(event, 'roomCount', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'roomCount', 'finance')">
              ÊàøÈó¥Êï∞<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 120px;" data-col="occupancy" data-type="finance" onclick="handleSort('finance', 'occupancy')" ondragstart="handleDragStart(event, 'occupancy', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'occupancy', 'finance')">
              Âá∫ÁßüÁéá<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="cumulativeIncome" data-type="finance" onclick="handleSort('finance', 'cumulativeIncome')" ondragstart="handleDragStart(event, 'cumulativeIncome', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'cumulativeIncome', 'finance')">
              Á¥ØËÆ°ÂÆûÊî∂ÁßüÈáë<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="cumulativeLandlord" data-type="finance" onclick="handleSort('finance', 'cumulativeLandlord')" ondragstart="handleDragStart(event, 'cumulativeLandlord', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'cumulativeLandlord', 'finance')">
              Á¥ØËÆ°ÂÆû‰∫§ÊàøÁßü<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="decoration" data-type="finance" onclick="handleSort('finance', 'decoration')" ondragstart="handleDragStart(event, 'decoration', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'decoration', 'finance')">
              Á¥ØËÆ°Ë£Ö‰øÆÊàêÊú¨<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="repair" data-type="finance" onclick="handleSort('finance', 'repair')" ondragstart="handleDragStart(event, 'repair', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'repair', 'finance')">
              Á¥ØËÆ°Áª¥Êä§ÊàêÊú¨<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="profit" data-type="finance" onclick="handleSort('finance', 'profit')" ondragstart="handleDragStart(event, 'profit', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'profit', 'finance')">
              ÂéÜÂè≤ÊÄªÂà©Ê∂¶<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="op" data-type="finance" onclick="handleSort('finance', 'op')" ondragstart="handleDragStart(event, 'op', 'finance')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'op', 'finance')">
              Êìç‰Ωú<span class="sort-icon fa"></span>
              </th></tr></thead>
                <tbody id="financeBody"><tr><td>Á¥´ËôπÂòâËãë</td><td>6</td><td><div>100%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:100%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Á¥´ËôπÂòâËãë')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Á¥´ËôπÂòâËãë')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>‰π¶È¶ôÂÖ¨ÂØì601</td><td>9</td><td><div>100%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:100%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('‰π¶È¶ôÂÖ¨ÂØì601')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', '‰π¶È¶ôÂÖ¨ÂØì601')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ÈáëÊú∫1906</td><td>7</td><td><div>86%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:86%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('ÈáëÊú∫1906')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'ÈáëÊú∫1906')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ÈáëÊú∫2403-2404</td><td>14</td><td><div>86%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:86%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('ÈáëÊú∫2403-2404')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'ÈáëÊú∫2403-2404')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>‰π¶È¶ôÂÖ¨ÂØì701</td><td>9</td><td><div>100%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:100%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('‰π¶È¶ôÂÖ¨ÂØì701')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', '‰π¶È¶ôÂÖ¨ÂØì701')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Èì∂Â∫ß</td><td>8</td><td><div>75%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:75%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Èì∂Â∫ß')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Èì∂Â∫ß')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Â∫êËÆØ2106</td><td>5</td><td><div>60%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:60%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Â∫êËÆØ2106')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Â∫êËÆØ2106')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Êµ∑‰º¶ÂõΩÈôÖ</td><td>8</td><td><div>88%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:88%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Êµ∑‰º¶ÂõΩÈôÖ')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Êµ∑‰º¶ÂõΩÈôÖ')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Ëç£Ê¨£Â§ßÂé¶</td><td>10</td><td><div>90%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:90%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Ëç£Ê¨£Â§ßÂé¶')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Ëç£Ê¨£Â§ßÂé¶')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Ëä±Âõ≠Âüé</td><td>1</td><td><div>100%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:100%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Ëä±Âõ≠Âüé')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Ëä±Âõ≠Âüé')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ÈáëÊú∫1903</td><td>6</td><td><div>100%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:100%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('ÈáëÊú∫1903')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'ÈáëÊú∫1903')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Â∫êËÆØ702</td><td>6</td><td><div>67%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:67%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Â∫êËÆØ702')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Â∫êËÆØ702')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>Ê∞¥ÁîµË∑Ø1402</td><td>1</td><td><div>100%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:100%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('Ê∞¥ÁîµË∑Ø1402')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'Ê∞¥ÁîµË∑Ø1402')">ËÆ∞ÂΩï</button></div></td></tr><tr><td>ËôπÂè∂Ëä±Ëãë</td><td>7</td><td><div>86%</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:86%"></div></div></td><td class="income-row">¬•0</td><td class="cost-row">¬•0</td><td class="expense-row">¬•0</td><td class="expense-row">¬•0</td><td class="profit-row" style="color:#166534">¬•0</td><td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('ËôπÂè∂Ëä±Ëãë')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', 'ËôπÂè∂Ëä±Ëãë')">ËÆ∞ÂΩï</button></div></td></tr></tbody>
            </table>
        </div>
        <div style="color:var(--text-muted); font-size:11px; margin-top:5px; text-align:right;">
             <i class="fas fa-hand-pointer"></i> ÊèêÁ§∫ÔºöÁÇπÂáªË°®Â§¥ÂèØ<b>ÊéíÂ∫è</b>ÔºåÊåâ‰ΩèË°®Â§¥ÂèØ<b>ÊãñÂä®‰ΩçÁΩÆ</b>ÔºåÊãñÊãΩËæπÁºòÂèØ<b>Ë∞ÉÊï¥ÂàóÂÆΩ</b>
        </div>
    </div>

    <div id="tab-cost" class="table-wrapper hidden">
        <div class="toolbar">
            <h3 id="title-repair">üîß ÊàêÊú¨ÁÆ°ÁêÜ</h3>
            <div style="display:flex; align-items:center; gap:5px; margin-left:10px;">
                <span style="color:var(--text-secondary); font-size:11px;">Êó∂Èó¥ËåÉÂõ¥:</span>
                <input type="date" id="filterCostStart" class="date-filter" onchange="renderCosts()">
                <span style="color:var(--text-secondary);">-</span>
                <input type="date" id="filterCostEnd" class="date-filter" onchange="renderCosts()">
            </div>
            <select id="filterCostBuilding" onchange="renderCosts()" style="margin-left:10px;"><option value="">ÂÖ®ÈÉ®Ê•ºÊ†ã</option><option value="Á¥´ËôπÂòâËãë">Á¥´ËôπÂòâËãë</option><option value="‰π¶È¶ôÂÖ¨ÂØì601">‰π¶È¶ôÂÖ¨ÂØì601</option><option value="ÈáëÊú∫1906">ÈáëÊú∫1906</option><option value="ÈáëÊú∫2403-2404">ÈáëÊú∫2403-2404</option><option value="‰π¶È¶ôÂÖ¨ÂØì701">‰π¶È¶ôÂÖ¨ÂØì701</option><option value="Èì∂Â∫ß">Èì∂Â∫ß</option><option value="Â∫êËÆØ2106">Â∫êËÆØ2106</option><option value="Êµ∑‰º¶ÂõΩÈôÖ">Êµ∑‰º¶ÂõΩÈôÖ</option><option value="Ëç£Ê¨£Â§ßÂé¶">Ëç£Ê¨£Â§ßÂé¶</option><option value="Ëä±Âõ≠Âüé">Ëä±Âõ≠Âüé</option><option value="ÈáëÊú∫1903">ÈáëÊú∫1903</option><option value="Â∫êËÆØ702">Â∫êËÆØ702</option><option value="Ê∞¥ÁîµË∑Ø1402">Ê∞¥ÁîµË∑Ø1402</option><option value="ËôπÂè∂Ëä±Ëãë">ËôπÂè∂Ëä±Ëãë</option></select>
            <select id="filterCostType" onchange="renderCosts()" style="margin-left:5px;">
                <option value="">ÂÖ®ÈÉ®Ë¥πÁî®Á±ªÂûã</option>
                <option value="decoration">Ë£Ö‰øÆÊàêÊú¨</option>
                <option value="maintenance">Áª¥Êä§ÊàêÊú¨</option>
                <option value="refund">ÈÄÄÁßüÊäºÈáë</option>
            </select>
            <div style="flex:1"></div>
            <button class="action act-repair" onclick="openCostModal()">+ Êñ∞Â¢ûÊàêÊú¨</button>
        </div>
        <div class="table-scroll-container">
            <table id="costTable">
                <thead id="costHead"><tr><th class="draggable " draggable="true" style="width: 100px;" data-col="building" data-type="cost" onclick="handleSort('cost', 'building')" ondragstart="handleDragStart(event, 'building', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'building', 'cost')">
              Ê•ºÊ†ã<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="content" data-type="cost" onclick="handleSort('cost', 'content')" ondragstart="handleDragStart(event, 'content', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'content', 'cost')">
              ÂÜÖÂÆπ<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="date" data-type="cost" onclick="handleSort('cost', 'date')" ondragstart="handleDragStart(event, 'date', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'date', 'cost')">
              Êó•Êúü<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="type" data-type="cost" onclick="handleSort('cost', 'type')" ondragstart="handleDragStart(event, 'type', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'type', 'cost')">
              Ë¥πÁî®Á±ªÂûã<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="amount" data-type="cost" onclick="handleSort('cost', 'amount')" ondragstart="handleDragStart(event, 'amount', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'amount', 'cost')">
              Ë¥πÁî®<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="notes" data-type="cost" onclick="handleSort('cost', 'notes')" ondragstart="handleDragStart(event, 'notes', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'notes', 'cost')">
              Â§áÊ≥®<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="op" data-type="cost" onclick="handleSort('cost', 'op')" ondragstart="handleDragStart(event, 'op', 'cost')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'op', 'cost')">
              Êìç‰Ωú<span class="sort-icon fa"></span>
              </th></tr></thead>
                <tbody id="costBody"></tbody>
                <tfoot id="costFoot"></tfoot>
            </table>
        </div>
        <div style="color:var(--text-muted); font-size:11px; margin-top:5px; text-align:right;">
             <i class="fas fa-hand-pointer"></i> ÊèêÁ§∫ÔºöÁÇπÂáªË°®Â§¥ÂèØ<b>ÊéíÂ∫è</b>ÔºåÊåâ‰ΩèË°®Â§¥ÂèØ<b>ÊãñÂä®‰ΩçÁΩÆ</b>ÔºåÊãñÊãΩËæπÁºòÂèØ<b>Ë∞ÉÊï¥ÂàóÂÆΩ</b>
        </div>
    </div>

    <div id="tab-petty" class="table-wrapper hidden">
        <div class="petty-header" id="pettyHeader">
            <div>
                <div class="petty-label">Â§áÁî®ÈáëËµÑÈáëÊ±†‰ΩôÈ¢ù</div>
                <div class="petty-balance" id="pettyBalanceDisplay">¬•0</div>
            </div>
            <div class="petty-btn-group">
                <button class="btn-petty" onclick="openPettyModal('in')"><i class="fas fa-plus-circle"></i> Â§áÁî®ÈáëÂÄüÁî®</button>
                <button class="btn-petty" onclick="openPettyModal('out')"><i class="fas fa-minus-circle"></i> Â§áÁî®ÈáëÊîØÂá∫</button>
            </div>
        </div>
        <div class="toolbar">
            <h3 id="title-petty">üìù Â§áÁî®ÊµÅÊ∞¥ËÆ∞ÂΩï</h3>
            <div style="flex:1"></div>
        </div>
        <div class="table-scroll-container">
            <table id="pettyTable">
                <thead id="pettyHead"><tr><th class="draggable " draggable="true" style="width: 100px;" data-col="date" data-type="petty" onclick="handleSort('petty', 'date')" ondragstart="handleDragStart(event, 'date', 'petty')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'date', 'petty')">
              Êó•Êúü<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="type" data-type="petty" onclick="handleSort('petty', 'type')" ondragstart="handleDragStart(event, 'type', 'petty')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'type', 'petty')">
              Á±ªÂûã<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="amount" data-type="petty" onclick="handleSort('petty', 'amount')" ondragstart="handleDragStart(event, 'amount', 'petty')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'amount', 'petty')">
              ÈáëÈ¢ù<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="reason" data-type="petty" onclick="handleSort('petty', 'reason')" ondragstart="handleDragStart(event, 'reason', 'petty')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'reason', 'petty')">
              ‰∫ãÁî±/Â§áÊ≥®<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="balanceSnapshot" data-type="petty" onclick="handleSort('petty', 'balanceSnapshot')" ondragstart="handleDragStart(event, 'balanceSnapshot', 'petty')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'balanceSnapshot', 'petty')">
              ÂèòÂä®Âêé‰ΩôÈ¢ù<span class="sort-icon fa"></span>
              </th><th class="draggable " draggable="true" style="width: 100px;" data-col="op" data-type="petty" onclick="handleSort('petty', 'op')" ondragstart="handleDragStart(event, 'op', 'petty')" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'op', 'petty')">
              Êìç‰Ωú<span class="sort-icon fa"></span>
              </th></tr></thead>
                <tbody id="pettyBody"></tbody>
            </table>
        </div>
        <div style="color:var(--text-muted); font-size:11px; margin-top:5px; text-align:right;">
             <i class="fas fa-hand-pointer"></i> ÊèêÁ§∫ÔºöÁÇπÂáªË°®Â§¥ÂèØ<b>ÊéíÂ∫è</b>ÔºåÊåâ‰ΩèË°®Â§¥ÂèØ<b>ÊãñÂä®‰ΩçÁΩÆ</b>ÔºåÊãñÊãΩËæπÁºòÂèØ<b>Ë∞ÉÊï¥ÂàóÂÆΩ</b>
        </div>
    </div>

    <div id="tab-settings" class="table-wrapper hidden">
        <div class="toolbar">
            <h3 id="title-settings">‚öôÔ∏è Á≥ªÁªüËÆæÁΩÆ</h3>
            <span style="font-size: 12px; color: var(--text-secondary); margin-left: 15px; font-weight: normal; margin-top: 5px;">Êú¨Á≥ªÁªüÁî±Âº†ËåÇÊàêËÆæËÆ°ÂºÄÂèëÔºåÊú™ÁªèÊú¨‰∫∫ÂêåÊÑèÔºåÁ¶ÅÊ≠¢‰øÆÊîπ„ÄÅ‰æµÊùÉ„ÄÅ‰º†Êí≠</span>
        </div>
        <div class="settings-container">
            <div class="settings-group">
                <h4>Âü∫Êú¨‰ø°ÊÅØ</h4>
                <div class="form-row"><label>Á≥ªÁªüÂ§ßÊ†áÈ¢ò</label><input type="text" id="settingAppTitle" onchange="updateSettings()"></div>
            </div>
            
            <div class="settings-grid">
                <div class="settings-group" style="border:none;">
                    <h4>ËèúÂçïËá™ÂÆö‰πâÂëΩÂêç</h4>
                    <div class="form-row"><label>ÊàøÊ∫êÁÆ°ÁêÜ</label><input type="text" id="set_menu_rooms" onchange="updateSettings()"></div>
                    <div class="form-row"><label>‰ªòÊ¨æÊèêÈÜí</label><input type="text" id="set_menu_landlord" onchange="updateSettings()"></div>
                    <div class="form-row"><label>Ë¥¢Âä°Ê±áÊÄª</label><input type="text" id="set_menu_finance" onchange="updateSettings()"></div>
                    <div class="form-row"><label>ÊàêÊú¨ÁÆ°ÁêÜ</label><input type="text" id="set_menu_repair" onchange="updateSettings()"></div>
                    <div class="form-row"><label>Â§áÁî®ÊµÅÊ∞¥</label><input type="text" id="set_menu_petty" onchange="updateSettings()"></div>
                </div>

                <div class="settings-group" style="border:none;">
                    <h4>üíæ Ëá™Âä®Â§á‰ªΩ‰∏éÊï∞ÊçÆ</h4>
                    <div class="form-row">
                        <label>Ëá™Âä®Â§á‰ªΩÂë®Êúü (Â§á‰ªΩÂ∞Ü‰ª•Êñá‰ª∂‰∏ãËΩΩÂΩ¢Âºè‰øùÂ≠ò)</label>
                        <select id="settingBackupInterval" onchange="updateSettings()">
                            <option value="0">ÂÖ≥Èó≠Ëá™Âä®Â§á‰ªΩ</option>
                            <option value="1">ÊØè 1 ÂàÜÈíü</option>
                            <option value="5">ÊØè 5 ÂàÜÈíü</option>
                            <option value="10">ÊØè 10 ÂàÜÈíü</option>
                        </select>
                    </div>
                    
                    <div style="margin-top: 20px; border-top: 1px dashed var(--card-border); padding-top: 15px;">
                        <button class="action act-out" style="width:100%; padding:12px;" onclick="initiateSafeWipe()">
                            <i class="fas fa-trash"></i> Ê∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆ (ÊÖéÁî®)
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="copyright-footer">
                Êú¨Á≥ªÁªüÁî±Âº†ËåÇÊàêËÆæËÆ°ÂºÄÂèëÔºåÊú™ÁªèÊú¨‰∫∫ÂêåÊÑèÔºåÁ¶ÅÊ≠¢‰øÆÊîπ„ÄÅ‰æµÊùÉ„ÄÅ‰º†Êí≠
            </div>
        </div>
    </div>
</main>

<div id="columnSetupModal" class="modal" style="display: none;"><div class="modal-box">
    <h3>üëÄ È°µÈù¢ÂàóÊòæÁ§∫ËÆæÁΩÆ</h3>
    <div id="colSetupContainer" class="checkbox-list">
        <h4 style="margin-top:0; margin-bottom:20px; text-align:center; color:var(--primary);">
            <i class="fas fa-bell"></i> ‰ªòÊ¨æÊèêÈÜíÈ°µÈù¢ÂàóËÆæÁΩÆ
        </h4>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px 25px; padding: 10px;">
    </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="building" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">ÂØπÂ∫îÊ•ºÊ†ã</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="building" data-type="plan" value="88" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="payCount" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">‰∫§ÁßüÊ¨°Êï∞</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="payCount" data-type="plan" value="66" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="amount" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">Â∫î‰ªòÈáëÈ¢ù</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="amount" data-type="plan" value="66" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="status" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">Áä∂ÊÄÅ</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="status" data-type="plan" value="66" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="nextPayDate" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">‰∏ãÊ¨°‰∫§ÁßüÊó•</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="nextPayDate" data-type="plan" value="100" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="info" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">Êî∂Ê¨æ‰ø°ÊÅØ</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="info" data-type="plan" value="180" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div><div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;">
            <input type="checkbox" value="notes" data-type="plan" checked="" style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">Â§áÊ≥®</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" class="col-width-input" data-col="notes" data-type="plan" value="180" min="30" max="500" style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        </div></div>
    <div style="text-align:right; border-top:1px solid var(--card-border); padding-top:15px;">
        <button class="action act-out" onclick="closeModal('columnSetupModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="saveColumnSetup()">Á°ÆËÆ§Â∫îÁî®</button>
    </div>
</div></div>

<div id="bulkEditModal" class="modal"><div class="modal-box">
    <h3><i class="fas fa-edit"></i> ÊàøÊ∫êÊâπÈáè‰øÆÊîπ</h3>
    <p style="font-size:12px; color:var(--text-secondary); margin-bottom:15px;">Ê≠§Êìç‰ΩúÂ∞Ü‰øÆÊîπÊ•ºÊ†ãÂêçÁß∞ÔºåÂπ∂Ëá™Âä®ÂêåÊ≠•Êõ¥Êñ∞ËØ•Ê•ºÊ†ãÂÖ≥ËÅîÁöÑÊâÄÊúâÂéÜÂè≤Ë¥¶Âçï„ÄÅËÆ°ÂàíÂíåÊàêÊú¨ËÆ∞ÂΩïÔºåÁ°Æ‰øùË¥¢Âä°Êï∞ÊçÆ‰∏çÊñ≠Ë£Ç„ÄÇ</p>
    
    <div class="form-row">
        <label>ÈÄâÊã©ÂéüÊ•ºÊ†ãÂêçÁß∞</label>
        <select id="bulk_old_building"></select>
    </div>
    <div class="form-row">
        <label>‰øÆÊîπ‰∏∫Êñ∞ÂêçÁß∞ (ÂøÖÂ°´)</label>
        <input type="text" id="bulk_new_building" placeholder="ËæìÂÖ•Êñ∞ÁöÑÊ•ºÊ†ãÂêçÁß∞">
    </div>

    <div style="text-align:right; margin-top:20px;">
        <button class="action act-out" onclick="closeModal('bulkEditModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="saveBulkEdit()">Á°ÆËÆ§‰øÆÊîπ</button>
    </div>
</div></div>

<div id="roomModal" class="modal"><div class="modal-box"><h3 id="modalTitle">üè† ÊàøÊ∫ê‰ø°ÊÅØ</h3>
    <input type="hidden" id="m_id">
    <div class="form-row"><label>Ê•ºÊ†ã/Â∞èÂå∫ (ÂøÖÂ°´)</label><input type="text" id="m_building" list="buildList" placeholder="‰æãÔºöÂπ∏Á¶èÂÖ¨ÂØìAÊ†ã"></div>
    <div class="form-row"><label>ÊàøÂè∑ (ÂøÖÂ°´)</label><input type="text" id="m_room" placeholder="‰æãÔºö101"></div>
    <div class="form-row"><label>Âá∫Áßü‰ª∑Ê†º (ÊúàÁßüÈáë)</label><input type="number" id="m_price"></div>
    <div class="form-row"><label>ÁßüÂÆ¢ÂßìÂêç</label><input type="text" id="m_tenant"></div>
    <div class="form-row"><label>ËÅîÁ≥ªÁîµËØù</label><input type="text" id="m_phone"></div>
    <div class="form-row"><label>Â§áÊ≥®</label><input type="text" id="m_notes"></div>
    <div style="display:flex; gap:10px;">
        <div class="form-row" style="flex:1"><label>‰∏ãÊ¨°‰∫§ÁßüÊó•Êúü</label><input type="date" id="m_nextPayDate"></div>
        <div class="form-row" style="flex:1"><label>ÂêàÂêåËµ∑Ê≠¢Êó∂Èó¥</label><input type="text" id="m_contractPeriod"></div>
    </div>
    <div style="display:flex; justify-content: space-between; margin-top:20px;">
        <button id="btnDeleteRoom" class="action act-out" style="display:none;" onclick="deleteRoom()">Âà†Èô§Ê≠§ÊàøÊ∫ê</button>
        <div style="text-align:right; flex:1;">
            <button class="action act-out" onclick="closeModal('roomModal')">ÂèñÊ∂à</button>
            <button class="action act-in" onclick="saveRoom()">‰øùÂ≠ò</button>
        </div>
    </div>
</div></div>

<div id="dateModal" class="modal"><div class="modal-box" style="width:300px;">
    <h3>üìÖ ‰øÆÊîπ‰∫§ÁßüÊó•Êúü</h3>
    <input type="hidden" id="d_roomId">
    <div class="form-row"><label>Êñ∞ÁöÑ‰∏ãÊ¨°‰∫§ÁßüÊó•</label><input type="date" id="d_newDate"></div>
    <div style="text-align:right; margin-top:20px;">
        <button class="action act-clear" onclick="clearDateInput()">Ê∏ÖÁ©∫Êó•Êúü</button>
        <button class="action act-out" onclick="closeModal('dateModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="saveNewDate()">Á°ÆËÆ§‰øÆÊîπ</button>
    </div>
</div></div>

<div id="planModal" class="modal"><div class="modal-box"><h3>üìÖ Â§ßÊàø‰∏ú‰ªòÊ¨æËÆ°Âàí</h3>
    <input type="hidden" id="p_index">
    <div class="form-row"><label>ÂØπÂ∫îÊ•ºÊ†ã</label><input type="text" id="p_building" list="buildList"></div>
    <div class="form-row"><label>Êî∂Ê¨æ‰ø°ÊÅØ</label><textarea id="p_info" rows="4"></textarea></div>
    <div class="form-row"><label>Â∫î‰ªòÈáëÈ¢ù</label><input type="number" id="p_amount"></div>
    <div class="form-row"><label>Â§áÊ≥®</label><textarea id="p_notes" rows="4"></textarea></div>

    <div style="display:flex; gap:10px;">
        <div class="form-row" style="flex:1"><label>‰∏ãÊ¨°‰∫§ÁßüÊó•Êúü</label><input type="date" id="p_date"></div>
        <div class="form-row" style="flex:1"><label>Â∑≤‰∫§ÁßüÊ¨°Êï∞</label><input type="number" id="p_payCount" value="0"></div>
    </div>
    <div style="display:flex; justify-content: space-between; margin-top:20px;">
        <button id="btnDeletePlan" class="action act-out" style="display:none;" onclick="deletePlan()">Âà†Èô§Ê≠§ËÆ°Âàí</button>
        <div style="text-align:right; flex:1;">
            <button class="action act-out" onclick="closeModal('planModal')">ÂèñÊ∂à</button>
            <button class="action act-in" onclick="savePlan()">‰øùÂ≠ò</button>
        </div>
    </div>
</div></div>

<div id="planDateModal" class="modal"><div class="modal-box" style="width:300px;">
    <h3>üìÖ ‰øÆÊîπÂ§ßÊàø‰∏ú‰∫§ÁßüÊó•</h3>
    <input type="hidden" id="pd_index">
    <div class="form-row"><label>Êñ∞ÁöÑ‰∏ãÊ¨°‰∫§ÁßüÊó•</label><input type="date" id="pd_newDate"></div>
    <div style="text-align:right; margin-top:20px;">
        <button class="action act-out" onclick="closeModal('planDateModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="savePlanNewDate()">Á°ÆËÆ§‰øÆÊîπ</button>
    </div>
</div></div>

<div id="logModal" class="modal" style="display: none;"><div class="modal-box" style="width:500px;">
    <h3 id="logModalTitle">üìú Êìç‰ΩúËÆ∞ÂΩï</h3>
    <input type="hidden" id="log_type" value="room"><input type="hidden" id="log_id" value="1768245439011">
    <ul id="logList" class="log-list"><li style="padding:20px;text-align:center;color:var(--text-muted)">ÊöÇÊó†ËÆ∞ÂΩï</li></ul>
    <div style="margin-top:20px; display:flex; justify-content: space-between;">
        <div><button class="action act-out" onclick="clearLogs()">Ê∏ÖÁ©∫ËÆ∞ÂΩï</button><button class="action act-in" id="btnRestoreLogs" onclick="restoreLogs()" style="display:none;">ÊÅ¢Â§çËÆ∞ÂΩï</button></div>
        <button class="action act-in" onclick="closeModal('logModal')">ÂÖ≥Èó≠</button>
    </div>
</div></div>

<div id="financeEditModal" class="modal" style="display: none;"><div class="modal-box">
    <h3>‚úé ‰øÆÊîπË¥¢Âä°Êï∞ÊçÆ</h3>
    <p style="font-size:12px; color:var(--text-secondary);">‰øÆÊîπÂ∞ÜË¶ÜÁõñËá™Âä®ËÆ°ÁÆóÂÄºÔºåÂπ∂ÁîüÊàêÁ≤æÁ°ÆÊó∂Èó¥Êó•Âøó„ÄÇ</p>
    <input type="hidden" id="fe_building" value="‰π¶È¶ôÂÖ¨ÂØì601">
    <div class="form-row"><label>Á¥ØËÆ°ÂÆûÊî∂ÁßüÈáë</label><input type="number" id="fe_income"></div>
    <div class="form-row"><label>Á¥ØËÆ°ÂÆû‰∫§ÊàøÁßü</label><input type="number" id="fe_landlord"></div>
    <div class="form-row"><label>Á¥ØËÆ°Ë£Ö‰øÆÊàêÊú¨</label><input type="number" id="fe_deco"></div>
    <div class="form-row"><label>Á¥ØËÆ°Áª¥Êä§ÊàêÊú¨</label><input type="number" id="fe_repair"></div>
    <div class="form-row"><label>Á¥ØËÆ°ÈÄÄÁßüÊäºÈáë</label><input type="number" id="fe_refund"></div>
    <div style="text-align:right; margin-top:20px;">
        <button class="action act-out" onclick="closeModal('financeEditModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="saveFinanceEdit()">‰øùÂ≠ò‰øÆÊîπ</button>
    </div>
</div></div>

<div id="costModal" class="modal" style="display: none;"><div class="modal-box"><h3>üîß ÊàêÊú¨ÂΩïÂÖ•</h3>
    <input type="hidden" id="c_id" value="">
    <div class="form-row"><label>Ê•ºÊ†ã</label><input type="text" id="c_building" list="buildList"></div>
    <div class="form-row"><label>ÂÜÖÂÆπ (ÂøÖÂ°´)</label><input type="text" id="c_content"></div>
    <div style="display:flex; gap:10px;">
        <div class="form-row" style="flex:1"><label>Ë¥πÁî®Á±ªÂûã</label><select id="c_type"><option value="maintenance">Áª¥Êä§ÊàêÊú¨</option><option value="decoration">Ë£Ö‰øÆÊàêÊú¨</option><option value="refund">ÈÄÄÁßüÊäºÈáë</option></select></div>
        <div class="form-row" style="flex:1"><label>Êó•Êúü</label><input type="date" id="c_date"></div>
    </div>
    <div class="form-row"><label>ÈáëÈ¢ù</label><input type="number" id="c_amount"></div>
    <div class="form-row"><label>Â§áÊ≥®</label><textarea id="c_notes" rows="2"></textarea></div>
    <div style="text-align:right; margin-top:20px;">
        <button class="action act-out" onclick="closeModal('costModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="saveCost()">‰øùÂ≠ò</button>
    </div>
</div></div>

<div id="pettyModal" class="modal"><div class="modal-box"><h3>üíµ Â§áÁî®ÈáëÊìç‰Ωú</h3>
    <input type="hidden" id="pt_id"> <input type="hidden" id="pt_type">
    <div class="form-row"><label>Êìç‰ΩúÁ±ªÂûã</label><div id="pt_type_display" style="font-weight:bold; font-size:16px; margin-bottom:10px;"></div></div>
    <div class="form-row"><label>ÈáëÈ¢ù</label><input type="number" id="pt_amount"></div>
    <div class="form-row"><label>‰∫ãÁî±/Â§áÊ≥®</label><textarea id="pt_reason" rows="2"></textarea></div>
    <div class="form-row"><label>Êó•Êúü</label><input type="date" id="pt_date"></div>
    <div style="text-align:right; margin-top:20px;">
        <button class="action act-out" onclick="closeModal('pettyModal')">ÂèñÊ∂à</button>
        <button class="action act-in" onclick="savePettyTrans()">Á°ÆËÆ§</button>
    </div>
</div></div>

<div id="wipeModal" class="modal"><div class="modal-box" style="text-align:center;">
    <h3 style="color:#dc2626"><i class="fas fa-exclamation-triangle"></i> Âç±Èô©Êìç‰Ωú</h3>
    <div class="wipe-alert">ÊÇ®Ê≠£Âú®Â∞ùËØïÊ∏ÖÁ©∫Á≥ªÁªü‰∏≠ÁöÑ<b>ÊâÄÊúâÊï∞ÊçÆ</b>„ÄÇ<br>Ê≠§Êìç‰Ωú<b>Êó†Ê≥ïÊí§ÈîÄ</b>ÔºÅ</div>
    <p>‰∏∫‰∫ÜÈò≤Ê≠¢ËØØÊìç‰ΩúÔºåËØ∑Á≠âÂæÖÂÄíËÆ°Êó∂ÁªìÊùüÔºö</p>
    <div id="wipeTimer" class="wipe-timer">30</div>
    <div style="margin-top:20px; display:flex; gap:10px; justify-content:center;">
        <button class="action act-in" style="background:#64748b; width:100px;" onclick="cancelWipe()">ÂèñÊ∂à</button>
        <button id="btnConfirmWipe" class="action act-out act-disabled" style="width:100px;" disabled="" onclick="executeWipe()">Á°ÆËÆ§Ê∏ÖÁ©∫</button>
    </div>
</div></div>

<datalist id="buildList"><option value="Á¥´ËôπÂòâËãë"></option><option value="‰π¶È¶ôÂÖ¨ÂØì601"></option><option value="ÈáëÊú∫1906"></option><option value="ÈáëÊú∫2403-2404"></option><option value="‰π¶È¶ôÂÖ¨ÂØì701"></option><option value="Èì∂Â∫ß"></option><option value="Â∫êËÆØ2106"></option><option value="Êµ∑‰º¶ÂõΩÈôÖ"></option><option value="Ëç£Ê¨£Â§ßÂé¶"></option><option value="Ëä±Âõ≠Âüé"></option><option value="ÈáëÊú∫1903"></option><option value="Â∫êËÆØ702"></option><option value="Ê∞¥ÁîµË∑Ø1402"></option><option value="ËôπÂè∂Ëä±Ëãë"></option></datalist>

<script>
    // ========== Êñá‰ª∂Á≥ªÁªüËá™Âä®‰øùÂ≠òÊ†∏ÂøÉ ==========
    let _fileHandle = null;
    let _saveTimer = null;
    let _isSaving = false;
    
    function loadEmbeddedData() {
        try {
            const el = document.getElementById('EMBEDDED_DATA');
            if (el) {
                const data = JSON.parse(el.textContent);
                if (data && typeof data === 'object' && data.rooms) return data;
            }
        } catch (e) {}
        return null;
    }
    
    const _embedded = loadEmbeddedData();
    
    // --- Êï∞ÊçÆÂàùÂßãÂåñ ---
    let rooms = (_embedded && _embedded.rooms) || [];
    let plans = (_embedded && _embedded.plans) || [];
    let repairs = (_embedded && _embedded.repairs) || [];
    let paymentHistory = (_embedded && _embedded.paymentHistory) || []; 
    let pettyCash = (_embedded && _embedded.pettyCash) || []; 
    let financeOverrides = (_embedded && _embedded.financeOverrides) || {}; 
    let financeLogs = (_embedded && _embedded.financeLogs) || {}; 
    let financeArchivedLogs = (_embedded && _embedded.financeArchivedLogs) || {};
    let buildingTimestamps = (_embedded && _embedded.buildingTimestamps) || {};

    let roomHiddenCols = (_embedded && _embedded.roomHiddenCols) || [];
    let planHiddenCols = (_embedded && _embedded.planHiddenCols) || [];
    let undoStack = [], redoStack = [];

    let selectedRoomIds = new Set();

    let settings = (_embedded && _embedded.settings) || {
        appTitle: '‰∫åÊàø‰∏ú‰ºÅ‰∏öÊî∂ÁßüÁ≥ªÁªü',
        menuNames: { rooms:'ÊàøÊ∫êÁÆ°ÁêÜ', landlord:'‰ªòÊ¨æÊèêÈÜí', finance:'Ë¥¢Âä°Ê±áÊÄª', repair:'ÊàêÊú¨ÁÆ°ÁêÜ', petty:'Â§áÁî®ÊµÅÊ∞¥' },
        backupInterval: 0,
        theme: 'auto'
    };

    let currentFontSize = (_embedded && _embedded.currentFontSize) || 12;

    // --- Â∑•ÂÖ∑Ê†èÊåâÈíÆÈÖçÁΩÆ‰∏éÊéíÂ∫è ---
    const defaultToolbarBtnOrder = ['colSetup', 'batchRent', 'rentShot', 'vacantShot', 'bulkEdit', 'addRoom'];
    let toolbarBtnOrder = (_embedded && _embedded.toolbarBtnOrder) || defaultToolbarBtnOrder;

    
    const toolbarBtnDefs = {
        'colSetup': { label: 'ÊòæÁ§∫ËÆæÁΩÆ', icon: 'fa-eye', class: 'act-cols', action: 'openColumnSetup()' },
        'batchRent': { label: '‰∏ÄÈîÆÊî∂Áßü', icon: 'fa-check-double', class: 'act-batch', action: 'batchConfirmRent()' },
        'rentShot': { label: 'ÂÇ¨ÁßüÊà™Âõæ', icon: 'fa-camera', class: 'act-out', action: 'screenshotRent()' },
        'vacantShot': { label: 'ÊãõÁßüÊà™Âõæ', icon: 'fa-bullhorn', class: 'act-in', action: 'screenshotVacant()' },
        'bulkEdit': { label: 'ÊàøÊ∫ê‰øÆÊîπ', icon: 'fa-edit', class: 'act-repair', action: 'openBulkEditModal()' },
        'addRoom': { label: 'Êñ∞Â¢ûÊàøÊ∫ê', icon: 'fa-plus', class: 'act-in', action: 'openRoomModal()' }
    };

        // --- ÂàóÈÖçÁΩÆ‰∏éÊãñÊãΩÂ≠òÂÇ® ---
    const defaultRoomColOrder = ['chk', 'building', 'room', 'tenant', 'notes', 'contractPeriod', 'nextPayDate', 'rentStatus', 'price', 'op'];
    let roomColOrder = (_embedded && _embedded.roomColOrder) || defaultRoomColOrder;
    if(!roomColOrder.includes('chk')) { roomColOrder.unshift('chk'); }
    let roomColWidths = (_embedded && _embedded.roomColWidths) || { 'chk': 40 }; 

    const defaultPlanColOrder = ['building', 'info', 'amount', 'notes', 'nextPayDate', 'payCount', 'status', 'op'];
    let planColOrder = (_embedded && _embedded.planColOrder) || defaultPlanColOrder;
    let planColWidths = (_embedded && _embedded.planColWidths) || { 'info': 200 };

    const defaultFinanceColOrder = ['building', 'roomCount', 'occupancy', 'cumulativeIncome', 'cumulativeLandlord', 'decoration', 'repair', 'refund', 'profit', 'op'];
    let financeColOrder = (_embedded && _embedded.financeColOrder) || defaultFinanceColOrder;
    if(!financeColOrder.includes('op')) financeColOrder.push('op');
    let financeColWidths = (_embedded && _embedded.financeColWidths) || { 'occupancy': 120, 'building': 150 };

    const defaultCostColOrder = ['building', 'content', 'date', 'type', 'amount', 'notes', 'op'];
    let costColOrder = (_embedded && _embedded.costColOrder) || defaultCostColOrder;
    let costColWidths = (_embedded && _embedded.costColWidths) || {};

    const defaultPettyColOrder = ['date', 'type', 'amount', 'reason', 'balanceSnapshot', 'op'];
    let pettyColOrder = (_embedded && _embedded.pettyColOrder) || defaultPettyColOrder;
    let pettyColWidths = (_embedded && _embedded.pettyColWidths) || {};


    let currentSort = { type: null, col: null, dir: 1 }; 
    let autoBackupTimer = null;
    let dragSrcId = null; let dragTableType = ''; 
    let toolbarDragSrc = null;

    // --- Ê∑±Ëâ≤Ê®°Âºè ---
    function initTheme() {
        const savedTheme = settings.theme || 'auto';
        const themeToggle = document.getElementById('themeToggle');
        
        if (savedTheme === 'auto') {
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            themeToggle.checked = prefersDark;
        } else {
            document.documentElement.setAttribute('data-theme', savedTheme);
            themeToggle.checked = savedTheme === 'dark';
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (settings.theme === 'auto') {
                document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
                document.getElementById('themeToggle').checked = e.matches;
            }
        });
    }
    
    function toggleTheme() {
        const themeToggle = document.getElementById('themeToggle');
        const newTheme = themeToggle.checked ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', newTheme);
        settings.theme = newTheme;
        saveData();
    }

    function updateBuildingTs(buildingName) {
        if (!buildingName) return;
        const b = buildingName.trim();
        buildingTimestamps[b] = Date.now();
        localStorage.setItem('rent_buildingTimestamps', JSON.stringify(buildingTimestamps));
    }

    // --- ÂàóÂÆö‰πâ ---
    const roomColDefs = {
        'chk': { 
            title: '<input type="checkbox" id="roomSelectAll" class="room-check" onclick="toggleSelectAll()">', 
            render: (r) => `<td><input type="checkbox" class="room-check" ${selectedRoomIds.has(r.id) ? 'checked' : ''} onclick="toggleSelectRow(${r.id})"></td>`, 
            getValue: () => '' 
        },
        'building': { title: 'Ê•ºÊ†ã/Â∞èÂå∫', render: (r) => `<td>${r.building}</td>`, getValue: r => r.building },
        'room': { title: 'ÊàøÂè∑', render: (r) => `<td><b>${r.room}</b></td>`, getValue: r => r.room },
        'status': { title: 'Áä∂ÊÄÅ', render: (r) => `<td><span class="badge ${r.status ? 'rent-confirmed' : 'st-0'}">${r.status ? 'Â∑≤Áßü' : 'Á©∫ÁΩÆ'}</span></td>`, getValue: r => r.status ? 'Â∑≤Áßü' : 'Á©∫ÁΩÆ' },
        'tenant': { title: 'ÁßüÂÆ¢‰ø°ÊÅØ', render: (r) => `<td>${r.tenant || '-'}<br><small style="color:var(--text-muted)">${r.phone || ''}</small></td>`, getValue: r => `${r.tenant} (${r.phone})` },
        'notes': { title: 'Â§áÊ≥®', render: (r) => `<td><span style="color:var(--text-secondary); font-size:11px;">${r.notes || ''}</span></td>`, getValue: r => r.notes },
        'contractPeriod': { title: 'ÂêàÂêåËµ∑Ê≠¢Êó∂Èó¥', render: (r) => `<td><span style="font-size:11px; color:var(--text-secondary);">${r.contractPeriod || '-'}</span></td>`, getValue: r => r.contractPeriod },
        'nextPayDate': { title: '‰∏ãÊ¨°‰∫§ÁßüÊó•', render: (r) => `<td>${r.nextPayDate || '<span style="color:var(--text-muted)">Êó†</span>'} <button class="act-date-small" onclick="openDateModal(${r.id})"><i class="fas fa-edit"></i></button></td>`, getValue: r => r.nextPayDate },
        'rentStatus': { title: 'Êî∂ÁßüÁä∂ÊÄÅ', render: (r) => { const st = getRentStatus(r); return `<td><span class="badge ${st.class}">${st.text}</span></td>`; }, getValue: r => getRentStatus(r).text },
        'price': { title: 'ÊúàÁßüÈáë', render: (r) => `<td>¬•${r.price}</td>`, getValue: r => r.price },
        'op': { title: 'Êìç‰Ωú', render: (r) => { 
            const st = getRentStatus(r);
            let btnHtml = `<button class="action act-confirm" onclick="confirmRent(${r.id})">Êî∂Áßü</button>`;
            if (st.text === 'ÂÜçÁ≠âÁ≠â' || st.text === 'ÂèØÂÇ¨Áßü') btnHtml = `<button class="action act-disabled" onclick="alert('Êî∂Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁ≠â‰∏ÄÁ≠â~')">Êî∂Áßü</button>`;
            if (st.text === 'Á©∫ÁΩÆ') btnHtml = `<button class="action act-disabled" disabled>Êî∂Áßü</button>`;
            return `<td><div class="btn-group-uniform">${btnHtml} <button class="action act-edit" onclick="openRoomModal(${r.id})">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('room', ${r.id})">ËÆ∞ÂΩï</button></div></td>`; 
        }, getValue: () => '' }
    };

    // ‚òÖ‚òÖ‚òÖ ‰øÆÂ§çÔºö‰ΩøÁî® plans.indexOf(p) Ëé∑ÂèñÁúüÂÆûÁ¥¢ÂºïÔºåÈÅøÂÖçÁ≠õÈÄâ/ÊéíÂ∫èÂêéÁ¥¢ÂºïÈîô‰Ωç ‚òÖ‚òÖ‚òÖ
    const planColDefs = {
        'building': { title: 'ÂØπÂ∫îÊ•ºÊ†ã', render: (p) => `<td>${p.building}</td>`, getValue: p => p.building },
        'info': { title: 'Êî∂Ê¨æ‰ø°ÊÅØ', render: (p) => `<td><div class="wrap-cell">${p.paymentInfo || p.name || '-'}</div></td>`, getValue: p => p.paymentInfo },
        'amount': { title: 'Â∫î‰ªòÈáëÈ¢ù', render: (p) => `<td style="font-weight:bold; color:#dc2626">¬•${p.amount}</td>`, getValue: p => p.amount },
        'notes': { title: 'Â§áÊ≥®', render: (p) => `<td><div style="white-space: pre-wrap; text-align: left; color:var(--text-secondary); font-size:11px; padding: 5px;">${p.notes || ''}</div></td>`, getValue: p => p.notes },

        'nextPayDate': { title: '‰∏ãÊ¨°‰∫§ÁßüÊó•', render: (p, idx) => {
            const realIdx = plans.indexOf(p);
            return `<td>${p.nextPayDate || p.date} <button class="act-date-small" onclick="openPlanDateModalWrapper(${realIdx})"><i class="fas fa-edit"></i></button></td>`;
        }, getValue: p => p.nextPayDate },
        'payCount': { title: '‰∫§ÁßüÊ¨°Êï∞', render: (p) => `<td>${p.payCount || 0}Ê¨°</td>`, getValue: p => p.payCount },
        'status': { title: 'Áä∂ÊÄÅ', render: (p) => { const st = getPlanStatus(p); return `<td><span class="badge ${st.class}">${st.text}</span></td>`; }, getValue: p => getPlanStatus(p).text },
        'op': { title: 'Êìç‰Ωú', render: (p, idx) => {
            const realIdx = plans.indexOf(p);
            const st = getPlanStatus(p);
            let btnHtml = `<button class="action act-confirm" onclick="confirmLandlordPay(${realIdx})">Á°ÆËÆ§‰∫§Áßü</button>`;
            if (st.text === 'ÂÜçÁ≠âÁ≠â') btnHtml = `<button class="action act-disabled" onclick="alert('‰∫§Èí±‰∏çÂøÖÂ¶ÇÊ≠§ÂøÉÊÄ•ÔºåÁºì‰∏ÄÁºì~')">Á°ÆËÆ§‰∫§Áßü</button>`;
            return `<td><div class="btn-group-uniform">${btnHtml} <button class="action act-edit" onclick="editPlan(${realIdx})">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('plan', ${realIdx})">ËÆ∞ÂΩï</button></div></td>`;
        }, getValue: () => '' }
    };

    const financeColDefs = {
        'building': { title: 'Ê•ºÊ†ã/Â∞èÂå∫', render: (d) => `<td>${d.building}</td>`, getValue: d => d.building },
        'roomCount': { title: 'ÊàøÈó¥Êï∞', render: (d) => `<td>${d.roomCount}</td>`, getValue: d => d.roomCount },
        'occupancy': { title: 'Âá∫ÁßüÁéá', render: (d) => { const pct = parseFloat(d.occupancy)||0; return `<td><div>${d.occupancy}</div><div class="progress-bg"><div class="progress-bar-gradient" style="width:${pct}%"></div></div></td>`; }, getValue: d => d.occupancy },
        'cumulativeIncome': { title: 'Á¥ØËÆ°ÂÆûÊî∂ÁßüÈáë', render: (d) => `<td class="income-row">¬•${d.cumulativeIncome}</td>`, getValue: d => d.cumulativeIncome },
        'cumulativeLandlord': { title: 'Á¥ØËÆ°ÂÆû‰∫§ÊàøÁßü', render: (d) => `<td class="cost-row">¬•${d.cumulativeLandlord}</td>`, getValue: d => d.cumulativeLandlord },
        'decoration': { title: 'Á¥ØËÆ°Ë£Ö‰øÆÊàêÊú¨', render: (d) => `<td class="expense-row">¬•${d.decoration}</td>`, getValue: d => d.decoration }, 
        'repair': { title: 'Á¥ØËÆ°Áª¥Êä§ÊàêÊú¨', render: (d) => `<td class="expense-row">¬•${d.repair}</td>`, getValue: d => d.repair },
        'refund': { title: 'Á¥ØËÆ°ÈÄÄÁßüÊäºÈáë', render: (d) => `<td class="expense-row">¬•${d.refund}</td>`, getValue: d => d.refund },
        'profit': { title: 'ÂéÜÂè≤ÊÄªÂà©Ê∂¶', render: (d) => `<td class="profit-row" style="color:${d.profit>=0?'#166534':'#dc2626'}">¬•${d.profit}</td>`, getValue: d => d.profit },
        'op': { title: 'Êìç‰Ωú', render: (d) => `<td><div class="btn-group-uniform"><button class="action act-edit" onclick="openFinanceEditModal('${d.building}')">ÁºñËæë</button><button class="action act-log" onclick="openLogModal('finance', '${d.building}')">ËÆ∞ÂΩï</button></div></td>`, getValue: () => '' }
    };

    const costColDefs = {
        'building': { title: 'Ê•ºÊ†ã', render: (r) => `<td>${r.building}</td>`, getValue: r => r.building },
        'content': { title: 'ÂÜÖÂÆπ', render: (r) => `<td>${r.content || r.item}</td>`, getValue: r => r.content },
        'date': { title: 'Êó•Êúü', render: (r) => `<td>${r.date}</td>`, getValue: r => r.date },
        'type': { title: 'Ë¥πÁî®Á±ªÂûã', render: (r) => {
            let badge='cost-main'; let label='Áª¥Êä§';
            if(r.type==='decoration'){badge='cost-deco';label='Ë£Ö‰øÆ';} else if(r.type==='refund'){badge='cost-refund';label='ÈÄÄÁßü';}
            return `<td><span class="badge ${badge}">${label}</span></td>`;
        }, getValue: r => r.type==='decoration'?'Ë£Ö‰øÆ':(r.type==='refund'?'ÈÄÄÁßü':'Áª¥Êä§') },
        'amount': { title: 'Ë¥πÁî®', render: (r) => `<td style="font-weight:bold; color:#dc2626">¬•${(r.decoCost||0)+(r.mainCost||0)+(r.refundCost||0)}</td>`, getValue: r => (r.decoCost||0)+(r.mainCost||0)+(r.refundCost||0) },
        'notes': { title: 'Â§áÊ≥®', render: (r) => `<td>${r.notes || ''}</td>`, getValue: r => r.notes },
        'op': { title: 'Êìç‰Ωú', render: (r) => `<td><div class="btn-group-uniform"><button class="action act-edit" onclick="openCostModal(${r.id})">ÁºñËæë</button> <button class="action act-out" onclick="deleteCost(${r.id})">Âà†Èô§</button></div></td>`, getValue: () => '' }
    };

    const pettyColDefs = {
        'date': { title: 'Êó•Êúü', render: (r) => `<td>${r.date}</td>`, getValue: r => r.date },
        'type': { title: 'Á±ªÂûã', render: (r) => `<td><span class="${r.type==='in'?'trans-in':'trans-out'}">${r.type==='in'?'Â§áÁî®ÈáëÂÄüÁî®':'Â§áÁî®ÈáëÊîØÂá∫'}</span></td>`, getValue: r => r.type==='in'?'ÂÄüÁî®':'ÊîØÂá∫' },
        'amount': { title: 'ÈáëÈ¢ù', render: (r) => `<td style="font-weight:bold; color:${r.type==='in'?'#16a34a':'#dc2626'}">${r.type==='in'?'+':'-'} ¬•${r.amount}</td>`, getValue: r => r.amount },
        'reason': { title: '‰∫ãÁî±/Â§áÊ≥®', render: (r) => `<td>${r.reason}</td>`, getValue: r => r.reason },
        'balanceSnapshot': { title: 'ÂèòÂä®Âêé‰ΩôÈ¢ù', render: (r) => `<td>¬•${r.balanceSnapshot}</td>`, getValue: r => r.balanceSnapshot },
        'op': { title: 'Êìç‰Ωú', render: (r) => `<td><div class="btn-group-uniform"><button class="action act-edit" onclick="editPetty(${r.id})">ÁºñËæë</button><button class="action act-out" onclick="deletePetty(${r.id})">Âà†Èô§</button></div></td>`, getValue: () => '' }
    };

    window.onload = () => { initTheme(); applySettings(); applyFontSize(); initApp(); setupAutoBackup(); updateUndoRedoButtons(); renderToolbarButtons(); };

    function initApp() {
        if(rooms.length === 0) {
             const today = new Date(); const nextMonth = new Date(today); nextMonth.setMonth(today.getMonth() + 1);
             rooms = [{id: 1, building: 'Âπ∏Á¶èÂÖ¨ÂØìAÊ†ã', room: '101', price: 2500, tenant: 'Âº†‰∏â', phone: '13800138000', nextPayDate: nextMonth.toISOString().split('T')[0], status: 1, contractPeriod: '2025.01.01-2026.01.01', notes: '‰∏ÄÂπ¥ÂêàÂêå', logs: [], archivedLogs: [], updateTime: Date.now()}];
             saveData();
        }
        updateBuildingList(); renderAll();
    }

    // --- Â∑•ÂÖ∑Ê†èÊåâÈíÆÊãñÊãΩÊéíÂ∫è ---
    function renderToolbarButtons() {
        const container = document.getElementById('toolbarActions');
        container.innerHTML = '';
        
        toolbarBtnOrder.forEach((btnId, idx) => {
            const def = toolbarBtnDefs[btnId];
            if (!def) return;
            
            const item = document.createElement('div');
            item.className = 'toolbar-btn-item';
            item.draggable = true;
            item.dataset.btnId = btnId;
            
            item.innerHTML = `<button class="action ${def.class}" onclick="${def.action}"><i class="fas ${def.icon}"></i> ${def.label}</button>`;
            
            item.addEventListener('dragstart', (e) => {
                toolbarDragSrc = btnId;
                item.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            });
            
            item.addEventListener('dragend', () => {
                item.classList.remove('dragging');
            });
            
            item.addEventListener('dragover', (e) => {
                e.preventDefault();
                item.classList.add('drag-over');
            });
            
            item.addEventListener('dragleave', () => {
                item.classList.remove('drag-over');
            });
            
            item.addEventListener('drop', (e) => {
                e.preventDefault();
                item.classList.remove('drag-over');
                
                if (toolbarDragSrc && toolbarDragSrc !== btnId) {
                    const fromIdx = toolbarBtnOrder.indexOf(toolbarDragSrc);
                    const toIdx = toolbarBtnOrder.indexOf(btnId);
                    if (fromIdx > -1 && toIdx > -1) {
                        toolbarBtnOrder.splice(toIdx, 0, toolbarBtnOrder.splice(fromIdx, 1)[0]);
                        saveData();
                        renderToolbarButtons();
                    }
                }
                toolbarDragSrc = null;
            });
            
            container.appendChild(item);
            
            // Ê∑ªÂä†ÂàÜÈöîÁ∫øÔºàÈô§‰∫ÜÊúÄÂêé‰∏Ä‰∏™Ôºâ
            if (idx < toolbarBtnOrder.length - 1) {
                const divider = document.createElement('div');
                divider.className = 'action-divider';
                container.appendChild(divider);
            }
        });
    }

    function renderTableGeneric(type, dataArray, colOrder, colDefs, colWidths, headEl, bodyEl, filterFn) {
        let headHtml = '<tr>';
        const visibleCols = colOrder.filter(colId => {
            if (type === 'room') return !roomHiddenCols.includes(colId);
            if (type === 'plan') return !planHiddenCols.includes(colId);
            return true;
        });

        visibleCols.forEach((colId) => {
            const def = colDefs[colId]; if (!def) return;
            const widthStyle = colWidths[colId] ? `width: ${colWidths[colId]}px;` : 'width: 100px;';
            let sortClass = '';
            if (currentSort.type === type && currentSort.col === colId) sortClass = currentSort.dir === 1 ? 'sorted-asc' : 'sorted-desc';
            
            const isChk = colId === 'chk';
            const sortAttr = isChk ? '' : `onclick="handleSort('${type}', '${colId}')"`;
            const sortIcon = isChk ? '' : `<span class="sort-icon fa"></span>`;

            headHtml += `<th class="draggable ${sortClass}" draggable="true" style="${widthStyle}" data-col="${colId}" data-type="${type}"
              ${sortAttr} ondragstart="handleDragStart(event, '${colId}', '${type}')" 
              ondragover="handleDragOver(event)" ondrop="handleDrop(event, '${colId}', '${type}')">
              ${def.title}${sortIcon}
              </th>`;

        });
        headEl.innerHTML = headHtml + '</tr>';
        bodyEl.innerHTML = '';
        dataArray.forEach((item, idx) => {
            if (filterFn(item)) {
                const row = document.createElement('tr');
                let rowHtml = ''; visibleCols.forEach(colId => { if(colDefs[colId]) rowHtml += colDefs[colId].render(item, idx); });
                row.innerHTML = rowHtml; bodyEl.appendChild(row);
            }
        });
    }


    function handleDragStart(e, colId, type) { dragSrcId = colId; dragTableType = type; e.target.classList.add('dragging'); e.dataTransfer.effectAllowed = 'move'; }
    function handleDragOver(e) { e.preventDefault(); e.dataTransfer.dropEffect = 'move'; return false; }
    function handleDrop(e, targetColId, type) {
        e.stopPropagation(); e.preventDefault(); document.querySelectorAll('th').forEach(th => th.classList.remove('dragging'));
        if (dragSrcId !== targetColId && dragTableType === type) {
            let arr;
            if(type==='room') arr=roomColOrder; else if(type==='plan') arr=planColOrder; else if(type==='finance') arr=financeColOrder; else if(type==='cost') arr=costColOrder; else if(type==='petty') arr=pettyColOrder;
            const from = arr.indexOf(dragSrcId), to = arr.indexOf(targetColId);
            if (from > -1 && to > -1) { arr.splice(to, 0, arr.splice(from, 1)[0]); saveData(); renderAll(); }
        }
        return false;
    }

        function calculateFinanceData() {
        const allBuildings = new Set();
        rooms.forEach(r => { if(r.building) allBuildings.add(r.building.trim()); });
        plans.forEach(p => { if(p.building) allBuildings.add(p.building.trim()); });
        repairs.forEach(r => { if(r.building) allBuildings.add(r.building.trim()); });
        paymentHistory.forEach(ph => { if(ph.building) allBuildings.add(ph.building.trim()); }); 

        return Array.from(allBuildings).map(b => {
            let bRooms = rooms.filter(r => r.building.trim() === b);
            let rentedRooms = bRooms.filter(r => r.status === 1);
            
            let cumulativeIncome = paymentHistory.filter(ph => ph.building.trim() === b && ph.type === 'income').reduce((sum, ph) => sum + (parseFloat(ph.amount) || 0), 0);
            let cumulativeLandlord = paymentHistory.filter(ph => ph.building.trim() === b && ph.type === 'expense_landlord').reduce((sum, ph) => sum + (parseFloat(ph.amount) || 0), 0);
            
            // ‚òÖ‚òÖ‚òÖ ÊàêÊú¨Êï∞ÊçÆÂßãÁªà‰ªé repairs Êï∞ÁªÑÂÆûÊó∂ËÆ°ÁÆóÔºàÈïúÂÉèÂêåÊ≠•Ôºâ ‚òÖ‚òÖ‚òÖ
            let decoration = repairs.filter(r => r.building.trim() === b && r.type === 'decoration').reduce((sum, r) => sum + (parseFloat(r.decoCost)||0), 0);
            let repairCost = repairs.filter(r => r.building.trim() === b && (r.type === 'maintenance' || !r.type)).reduce((sum, r) => sum + (parseFloat(r.mainCost)||0), 0);
            let refundCost = repairs.filter(r => r.building.trim() === b && r.type === 'refund').reduce((sum, r) => sum + (parseFloat(r.refundCost)||0), 0);

            // ‚òÖ‚òÖ‚òÖ financeOverrides Âè™Áî®‰∫éË¶ÜÁõñÊî∂ÂÖ•Âíå‰∫§ÁßüÔºå‰∏çÂÜçË¶ÜÁõñÊàêÊú¨Êï∞ÊçÆ ‚òÖ‚òÖ‚òÖ
            if (financeOverrides && financeOverrides[b]) {
                const ov = financeOverrides[b];
                if (ov.income !== undefined) cumulativeIncome = parseFloat(ov.income);
                if (ov.landlord !== undefined) cumulativeLandlord = parseFloat(ov.landlord);
                // ÊàêÊú¨Êï∞ÊçÆ‰∏çÂÜçË¢´Ë¶ÜÁõñÔºåÂßãÁªà‰ªé repairs ÂÆûÊó∂ËÆ°ÁÆó
            }

            return {
                building: b,
                roomCount: bRooms.length,
                occupancy: bRooms.length ? Math.round((rentedRooms.length/bRooms.length)*100) + '%' : '0%',
                cumulativeIncome: cumulativeIncome,
                cumulativeLandlord: cumulativeLandlord,
                decoration: decoration,
                repair: repairCost,
                refund: refundCost,
                profit: cumulativeIncome - cumulativeLandlord - decoration - repairCost - refundCost,
                lastModified: buildingTimestamps[b] || 0 
            };
        });
    }


    function addFinanceLog(building, content) {
        if(!building) return;
        const b = building.trim();
        if(!financeLogs[b]) financeLogs[b] = [];
        const timeStr = new Date().toLocaleString('zh-CN', { hour12: false }); 
        financeLogs[b].push({ date: timeStr, content: content });
    }

    function getCurrentFilteredRooms() {
        const start = document.getElementById('searchStart').value;
        const end = document.getElementById('searchEnd').value;
        const buildFilter = document.getElementById('filterBuilding').value;
        const statusFilter = document.getElementById('filterStatus').value;
        return rooms.filter(r => {
            const mB = !buildFilter || r.building === buildFilter;
            const mS = !start || (r.nextPayDate && r.nextPayDate >= start);
            const mE = !end || (r.nextPayDate && r.nextPayDate <= end);
            let mSt = true; if(statusFilter) mSt = (getRentStatus(r).text === statusFilter);
            return mB && mSt && mS && mE;
        });
    }

    function toggleSelectAll() {
        const masterChk = document.getElementById('roomSelectAll');
        const currentList = getCurrentFilteredRooms();
        
        if (masterChk.checked) {
            currentList.forEach(r => selectedRoomIds.add(r.id));
        } else {
            currentList.forEach(r => selectedRoomIds.delete(r.id));
        }
        renderRooms();
    }

    function toggleSelectRow(id) {
        if (selectedRoomIds.has(id)) {
            selectedRoomIds.delete(id);
        } else {
            selectedRoomIds.add(id);
        }
        renderRooms();
    }

    function batchConfirmRent() {
        if (selectedRoomIds.size === 0) {
            alert('ËØ∑ÂÖàÂãæÈÄâÈúÄË¶ÅÊî∂ÁßüÁöÑÊàøÊ∫ê');
            return;
        }

        const targets = rooms.filter(r => selectedRoomIds.has(r.id));
        const validTargets = targets.filter(r => {
            const st = getRentStatus(r);
            return st.text === 'Â∑≤Ë∂ÖÊúü'; 
        });

        if (validTargets.length === 0) {
            alert('Âú®ÊÇ®ÈÄâ‰∏≠ÁöÑÊàøÊ∫ê‰∏≠ÔºåÊ≤°Êúâ"Â∑≤Ë∂ÖÊúü"ÁöÑÊàøÊ∫ê„ÄÇ\n\nÁ≥ªÁªüÈôêÂà∂Ôºö‰∏ÄÈîÆÊî∂ÁßüÂäüËÉΩ‰ªÖÂØπÂ∑≤Ë∂ÖÊúüÁöÑÊàøÊ∫êÁîüÊïà„ÄÇ');
            return;
        }

        const totalAmount = validTargets.reduce((sum, r) => sum + (parseFloat(r.price) || 0), 0);
        
        if (!confirm(`Âç≥Â∞ÜÂØπÈÄâ‰∏≠ÁöÑ ${validTargets.length} ‰∏™„ÄêÂ∑≤Ë∂ÖÊúü„ÄëÊàøÊ∫êËøõË°åÊî∂Áßü„ÄÇ\n(Â∑≤Ëá™Âä®ËøáÊª§ÊéâÊú™Ë∂ÖÊúüÁöÑÊàøÊ∫ê)\n\nÊÄªÈáëÈ¢ùÔºö¬•${totalAmount}\n\nÊ≥®ÊÑèÔºöËøôÂ∞ÜÊâπÈáèÊõ¥Êñ∞‰∏ãÊ¨°‰∫§ÁßüÊó•ÊúüÂπ∂ÁîüÊàêË¥¢Âä°ËÆ∞ÂΩï„ÄÇÁ°ÆÂÆöÁªßÁª≠ÂêóÔºü`)) {
            return;
        }

        pushHistory();
        const todayStr = new Date().toISOString().split('T')[0];
        const timeStr = new Date().toLocaleString('zh-CN', {hour12:false});

                   validTargets.forEach(r => {
            r.payCount = (r.payCount || 0) + 1; 
            const amountVal = parseFloat(r.price);
            
            paymentHistory.push({ date: todayStr, amount: amountVal, building: r.building.trim(), room: r.room, type: 'income' });
            
            // ‚òÖ‚òÖ‚òÖ ‰øÆÂ§çÔºöÊâπÈáèÊî∂ÁßüÊó∂‰πüÈúÄË¶ÅÂêåÊ≠•Êõ¥Êñ∞ financeOverrides ‚òÖ‚òÖ‚òÖ
            if (financeOverrides && financeOverrides[r.building.trim()] && financeOverrides[r.building.trim()].income !== undefined) {
                financeOverrides[r.building.trim()].income += amountVal;
            }
            
            if(!r.logs) r.logs = [];
            r.logs.push({date: timeStr, content: `ÊâπÈáèÊî∂Áßü ${amountVal}ÂÖÉ`});
            
            addFinanceLog(r.building, `ÊàøÊ∫êÊî∂Áßü(ÊâπÈáè): ${r.room} (+¬•${amountVal})`);
            updateBuildingTs(r.building);

            let current = new Date(r.nextPayDate); current.setMonth(current.getMonth() + 1);
            r.nextPayDate = current.toISOString().split('T')[0];
            r.updateTime = Date.now();
            addToCurrentRent(r.id, amountVal);
        });



        selectedRoomIds.clear();
        saveData();
        renderAll();
        alert(`ÊàêÂäüÂ§ÑÁêÜ‰∫Ü ${validTargets.length} ‰∏™Â∑≤Ë∂ÖÊúüÊàøÊ∫êÁöÑÊî∂Áßü„ÄÇ`);
    }

        function confirmRent(id) {
        const r = rooms.find(x => x.id === id); if (!r) return;
        if (!confirm(`Á°ÆËÆ§Êî∂Âèñ [${r.building} - ${r.room}] ÁöÑÁßüÈáë ¬•${r.price} ÂêóÔºü`)) return;
        pushHistory();
        if(r.status === 1) {
            r.payCount = (r.payCount || 0) + 1; 
            const todayStr = new Date().toISOString().split('T')[0];
            const amountVal = parseFloat(r.price);
            paymentHistory.push({ date: todayStr, amount: amountVal, building: r.building.trim(), room: r.room, type: 'income' });
            
            // ‚òÖ‚òÖ‚òÖ ‰øÆÂ§çÔºöÂ¶ÇÊûúËØ•Ê•ºÊ†ãÊúâÊâãÂä®‰øÆÊîπËøáÁöÑË¥¢Âä°Êï∞ÊçÆÔºåÈúÄË¶ÅÂêåÊ≠•Êõ¥Êñ∞Êî∂ÂÖ•ÂÄº ‚òÖ‚òÖ‚òÖ
            if (financeOverrides && financeOverrides[r.building.trim()] && financeOverrides[r.building.trim()].income !== undefined) {
                financeOverrides[r.building.trim()].income += amountVal;
            }
            
            if(!r.logs) r.logs = [];
            const timeStr = new Date().toLocaleString('zh-CN', {hour12:false});
            r.logs.push({date: timeStr, content: `Êî∂Áßü ${amountVal}ÂÖÉ`});
            
            addFinanceLog(r.building, `ÊàøÊ∫êÊî∂Áßü: ${r.room} (+¬•${amountVal})`);
            updateBuildingTs(r.building);

            let current = new Date(r.nextPayDate); current.setMonth(current.getMonth() + 1);
            r.nextPayDate = current.toISOString().split('T')[0];
            r.updateTime = Date.now();
            addToCurrentRent(id, amountVal);
            saveData(); renderAll();
        }
    }



        function confirmLandlordPay(idx) {
        const p = plans[idx];
        if(!confirm(`Á°ÆÂÆöË¶ÅÁ°ÆËÆ§Âêë [${p.building}] ÁöÑÊàø‰∏ú‰∫§ÁßüÂêóÔºü`)) return;
        pushHistory();
        p.payCount = (p.payCount || 0) + 1;
        const amountVal = parseFloat(p.amount);
        paymentHistory.push({ date: new Date().toISOString().split('T')[0], amount: amountVal, building: p.building.trim(), type: 'expense_landlord', remark: 'Â§ßÊàø‰∏ú‰∫§Áßü' });
        
        // ‚òÖ‚òÖ‚òÖ ‰øÆÂ§çÔºö‰∫§ÁßüÊó∂‰πüÈúÄË¶ÅÂêåÊ≠•Êõ¥Êñ∞ financeOverrides ‚òÖ‚òÖ‚òÖ
        if (financeOverrides && financeOverrides[p.building.trim()] && financeOverrides[p.building.trim()].landlord !== undefined) {
            financeOverrides[p.building.trim()].landlord += amountVal;
        }
        
        if(!p.logs) p.logs = [];
        const timeStr = new Date().toLocaleString('zh-CN', {hour12:false});
        p.logs.push({date: timeStr, content: `‰∫§Áßü ${amountVal}ÂÖÉ`});
        
        addFinanceLog(p.building, `Â§ßÊàø‰∏ú‰∫§Áßü (-¬•${amountVal})`);
        updateBuildingTs(p.building);

        let current = new Date(p.nextPayDate); current.setMonth(current.getMonth() + 3); 
        p.nextPayDate = current.toISOString().split('T')[0];
        p.updateTime = Date.now();
        saveData(); renderAll();
    }


                function saveCost() {
        pushHistory();
        const id = document.getElementById('c_id').value; 
        const type = document.getElementById('c_type').value; 
        const amt = parseFloat(document.getElementById('c_amount').value)||0;
        const b = document.getElementById('c_building').value.trim();
        const now = Date.now(); 

        const data = { 
            id: id ? parseFloat(id) : now, 
            building: b, 
            content: document.getElementById('c_content').value, 
            date: document.getElementById('c_date').value, 
            type, 
            decoCost: type==='decoration' ? amt : 0, 
            mainCost: type==='maintenance' ? amt : 0, 
            refundCost: type==='refund' ? amt : 0, 
            notes: document.getElementById('c_notes').value,
            updateTime: now 
        };
        
        if(id) {
            const idx = repairs.findIndex(r => r.id == id);
            if (idx > -1) { 
                repairs[idx] = { ...repairs[idx], ...data }; 
            }
        } else {
            repairs.push(data);
        }
        
        const typeName = type==='decoration'?'Ë£Ö‰øÆ':(type==='maintenance'?'Áª¥Êä§':'ÈÄÄÁßü');
        addFinanceLog(b, `${id?'ÁºñËæë':'Êñ∞Â¢û'}${typeName}ÊàêÊú¨: ${data.content} (¬•${amt})`);
        updateBuildingTs(b);
        
        // ‚òÖ‚òÖ‚òÖ ÈáçÁΩÆË¥¢Âä°Ê±áÊÄªÊéíÂ∫èÔºåÁ°Æ‰øù‰øÆÊîπÁöÑÊ•ºÊ†ã‰∏äÊµÆËá≥È°∂ÈÉ® ‚òÖ‚òÖ‚òÖ
        if (currentSort.type === 'finance') {
            currentSort.type = null;
            currentSort.col = null;
            currentSort.dir = 1;
        }

        saveData(); 
        closeModal('costModal'); 
        renderAll();
    }




    function saveFinanceEdit() {
        pushHistory(); const b = document.getElementById('fe_building').value.trim();
        const oldData = calculateFinanceData().find(d => d.building === b);
        if(!financeOverrides[b]) financeOverrides[b]={};
        
        const newVals = {
            income: parseFloat(document.getElementById('fe_income').value),
            landlord: parseFloat(document.getElementById('fe_landlord').value),
            deco: parseFloat(document.getElementById('fe_deco').value),
            repair: parseFloat(document.getElementById('fe_repair').value),
            refund: parseFloat(document.getElementById('fe_refund').value)
        };

        let changes = [];
        if(newVals.income !== oldData.cumulativeIncome) changes.push(`Êî∂ÂÖ•: ${oldData.cumulativeIncome}->${newVals.income}`);
        if(newVals.landlord !== oldData.cumulativeLandlord) changes.push(`‰∫§Áßü: ${oldData.cumulativeLandlord}->${newVals.landlord}`);
        if(newVals.deco !== oldData.decoration) changes.push(`Ë£Ö‰øÆ: ${oldData.decoration}->${newVals.deco}`);
        if(newVals.repair !== oldData.repair) changes.push(`Áª¥Êä§: ${oldData.repair}->${newVals.repair}`);
        if(newVals.refund !== oldData.refund) changes.push(`ÈÄÄÁßü: ${oldData.refund}->${newVals.refund}`);

        if(changes.length > 0) addFinanceLog(b, `ÊâãÂä®‰øÆÊ≠£: ${changes.join('; ')}`);
        updateBuildingTs(b);

        financeOverrides[b].income = newVals.income; financeOverrides[b].landlord = newVals.landlord;
        financeOverrides[b].decoration = newVals.deco; financeOverrides[b].repair = newVals.repair;
        financeOverrides[b].refund = newVals.refund;
        
        saveData(); closeModal('financeEditModal'); renderAll();
    }

    function openBulkEditModal() {
        const select = document.getElementById('bulk_old_building');
        select.innerHTML = '<option value="">ËØ∑ÈÄâÊã©ÂéüÊ•ºÊ†ã</option>';
        const bds = [...new Set(rooms.map(r => r.building))];
        bds.forEach(b => {
            const opt = document.createElement('option');
            opt.value = b;
            opt.textContent = b;
            select.appendChild(opt);
        });
        document.getElementById('bulk_new_building').value = '';
        document.getElementById('bulkEditModal').style.display = 'flex';
    }

    function saveBulkEdit() {
        const oldName = document.getElementById('bulk_old_building').value;
        const newName = document.getElementById('bulk_new_building').value.trim();

        if(!oldName || !newName) {
            alert('ËØ∑ÈÄâÊã©ÂéüÊ•ºÊ†ãÂπ∂ËæìÂÖ•Êñ∞ÂêçÁß∞');
            return;
        }

        if(confirm(`Á°ÆËÆ§Â∞ÜÊâÄÊúâ "${oldName}" ÁöÑËÆ∞ÂΩï‰øÆÊîπ‰∏∫ "${newName}" ÂêóÔºü\nÊ≠§Êìç‰ΩúÂ∞ÜÊõ¥Êñ∞ÊàøÊ∫ê„ÄÅ‰ªòÊ¨æËÆ°Âàí„ÄÅÁª¥‰øÆËÆ∞ÂΩïÂèäÂéÜÂè≤Ë¥¶Âçï„ÄÇ`)) {
            pushHistory();
            
            rooms.forEach(r => { if(r.building === oldName) { r.building = newName; r.updateTime = Date.now(); } });
            plans.forEach(p => { if(p.building === oldName) { p.building = newName; p.updateTime = Date.now(); } });
            repairs.forEach(r => { if(r.building === oldName) { r.building = newName; r.updateTime = Date.now(); } });
            paymentHistory.forEach(ph => { if(ph.building === oldName) ph.building = newName; });
            
            if(financeOverrides[oldName]) {
                financeOverrides[newName] = financeOverrides[oldName];
                delete financeOverrides[oldName];
            }
            if(financeLogs[oldName]) {
                financeLogs[newName] = financeLogs[oldName];
                delete financeLogs[oldName];
            }
             if(financeArchivedLogs[oldName]) {
                financeArchivedLogs[newName] = financeArchivedLogs[oldName];
                delete financeArchivedLogs[oldName];
            }
            if(buildingTimestamps[oldName]) {
                buildingTimestamps[newName] = Date.now();
                delete buildingTimestamps[oldName];
            }

            saveData();
            closeModal('bulkEditModal');
            updateBuildingList();
            renderAll();
            alert('‰øÆÊîπÊàêÂäüÔºåÊâÄÊúâÂÖ≥ËÅîÊï∞ÊçÆÂ∑≤ÂêåÊ≠•„ÄÇ');
        }
    }

    function adjustCardHeight(val) {
        document.documentElement.style.setProperty('--card-height', val + 'px');
    }

    function renderRooms() {
        let d = getCurrentFilteredRooms();

        if (!currentSort.col || currentSort.type !== 'room') {
            d.sort((a, b) => (b.updateTime || 0) - (a.updateTime || 0));
        } else {
            d = sortDataArray(d, 'room');
        }

        renderTableGeneric('room', d, roomColOrder, roomColDefs, roomColWidths, document.getElementById('roomHead'), document.getElementById('roomBody'), () => true);
        
        const masterChk = document.getElementById('roomSelectAll');
        if(masterChk) {
            if(d.length > 0 && d.every(r => selectedRoomIds.has(r.id))) {
                masterChk.checked = true; masterChk.indeterminate = false;
            } else if (d.some(r => selectedRoomIds.has(r.id))) {
                masterChk.checked = false; masterChk.indeterminate = true;
            } else {
                masterChk.checked = false; masterChk.indeterminate = false;
            }
        }

            let t=0, stats={overdue:0, urgency:0, wait:0, vacant:0}, counts={total:0, overdue:0, urgency:0, wait:0, vacant:0}; 
        d.forEach(r=>{ 
            let p=parseFloat(r.price)||0; 
            t+=p; 
            counts.total++; 
            let st=getRentStatus(r); 
            if(st.text==='Â∑≤Ë∂ÖÊúü'){stats.overdue+=p; counts.overdue++;}
            else if(st.text==='ÂèØÂÇ¨Áßü'){stats.urgency+=p; counts.urgency++;}
            else if(st.text==='ÂÜçÁ≠âÁ≠â'){stats.wait+=p; counts.wait++;}
            else {stats.vacant+=p; counts.vacant++;}
        });
        document.getElementById('sum-total').innerHTML='¬•'+t+' <span style="font-size:11px;color:var(--text-muted);">('+counts.total+'Èó¥)</span>'; 
        document.getElementById('sum-overdue').innerHTML='¬•'+stats.overdue+' <span style="font-size:11px;color:var(--text-muted);">('+counts.overdue+'Èó¥)</span>'; 
        document.getElementById('sum-urgency').innerHTML='¬•'+stats.urgency+' <span style="font-size:11px;color:var(--text-muted);">('+counts.urgency+'Èó¥)</span>'; 
        document.getElementById('sum-wait').innerHTML='¬•'+stats.wait+' <span style="font-size:11px;color:var(--text-muted);">('+counts.wait+'Èó¥)</span>'; 
        document.getElementById('sum-vacant').innerHTML='¬•'+stats.vacant+' <span style="font-size:11px;color:var(--text-muted);">('+counts.vacant+'Èó¥)</span>';
        updateCurrentRentDisplay();
    }

    function renderPlans() {
        let d = plans.filter(p => { const s=document.getElementById('searchPlan').value.toLowerCase(); return !s||(p.building&&p.building.includes(s))||(p.paymentInfo&&p.paymentInfo.toLowerCase().includes(s)); });
        
        if (!currentSort.col || currentSort.type !== 'plan') {
            d.sort((a, b) => (b.updateTime || 0) - (a.updateTime || 0));
        } else {
            d = sortDataArray(d, 'plan');
        }

        renderTableGeneric('plan', d, planColOrder, planColDefs, planColWidths, document.getElementById('planHead'), document.getElementById('planBody'), () => true);
    }
    
    function renderFinance() {
        let d = calculateFinanceData(); 
        
        if (!currentSort.col || currentSort.type !== 'finance') {
            d.sort((a, b) => b.lastModified - a.lastModified);
        } else {
            d = sortDataArray(d, 'finance');
        }

        renderTableGeneric('finance', d, financeColOrder, financeColDefs, financeColWidths, document.getElementById('financeHead'), document.getElementById('financeBody'), () => true);
        let t = d.reduce((a,c)=>{ a.income+=c.cumulativeIncome; a.landlord+=c.cumulativeLandlord; a.deco+=c.decoration; a.repair+=c.repair; a.refund+=c.refund; a.profit+=c.profit; return a; }, {income:0,landlord:0,deco:0,repair:0,refund:0,profit:0});
        document.getElementById('financeHeaderStats').innerHTML = `<div class="summary-item si-income"><span class="summary-label">Á¥ØËÆ°ÂÆûÊî∂ÁßüÈáë</span><span class="summary-value">¬•${t.income}</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°ÂÆû‰∫§ÊàøÁßü</span><span class="summary-value">¬•${t.landlord}</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°Ë£Ö‰øÆÊàêÊú¨</span><span class="summary-value">¬•${t.deco}</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°Áª¥Êä§ÊàêÊú¨</span><span class="summary-value">¬•${t.repair}</span></div><div class="summary-item si-expense"><span class="summary-label">Á¥ØËÆ°ÈÄÄÁßüÊäºÈáë</span><span class="summary-value">¬•${t.refund}</span></div><div class="summary-item si-profit"><span class="summary-label">ÂéÜÂè≤ÊÄªÂà©Ê∂¶</span><span class="summary-value">¬•${t.profit}</span></div>`;
        document.getElementById('totalBalance').innerText=t.profit; document.getElementById('monthlyIncome').innerText=t.income;
    }
    
    function renderCosts() {
        const sB = document.getElementById('filterCostBuilding'); const cB = sB.value;
        const bds = [...new Set(rooms.map(r => r.building))]; sB.innerHTML='<option value="">ÂÖ®ÈÉ®Ê•ºÊ†ã</option>'; bds.forEach(b=>{const o=document.createElement('option');o.value=b;o.textContent=b;if(b===cB)o.selected=true;sB.appendChild(o);});
        
        let d = repairs.filter(r => {
            const bF = document.getElementById('filterCostBuilding').value; const tF = document.getElementById('filterCostType').value;
            const sD = document.getElementById('filterCostStart').value; const eD = document.getElementById('filterCostEnd').value;
            return (!bF||r.building===bF) && (!tF||r.type===tF) && (!sD||r.date>=sD) && (!eD||r.date<=eD);
        });

        if (!currentSort.col || currentSort.type !== 'cost') {
            d.sort((a, b) => {
                const timeA = a.updateTime || a.id || 0;
                const timeB = b.updateTime || b.id || 0;
                return timeB - timeA; 
            });
        } else {
            d = sortDataArray(d, 'cost');
        }

        renderTableGeneric('cost', d, costColOrder, costColDefs, costColWidths, document.getElementById('costHead'), document.getElementById('costBody'), () => true);
        const sum = d.reduce((a,r)=>a+((r.decoCost||0)+(r.mainCost||0)+(r.refundCost||0)),0);
        document.getElementById('costFoot').innerHTML = d.length>0?`<tr>${costColOrder.map(c=>c==='amount'?`<td style="color:#dc2626">¬•${sum}</td>`:(c==='building'?'<td>Ê±áÊÄª:</td>':'<td></td>')).join('')}</tr>`:'';
    }

    function renderPetty() {
        let bal=0; let d = [...pettyCash].sort((a,b)=>new Date(a.date)-new Date(b.date));
        d.forEach(p=>{ if(p.type==='in')bal+=p.amount; else bal-=p.amount; p.balanceSnapshot=bal; });
        document.getElementById('pettyBalanceDisplay').innerText='¬•'+bal;
        const h = document.getElementById('pettyHeader'); if(bal<0) h.classList.add('negative'); else h.classList.remove('negative');
        if(!currentSort.col || currentSort.type!=='petty') d.sort((a,b)=>new Date(b.date)-new Date(a.date)); else d=sortDataArray(d, 'petty');
        renderTableGeneric('petty', d, pettyColOrder, pettyColDefs, pettyColWidths, document.getElementById('pettyHead'), document.getElementById('pettyBody'), () => true);
    }
    function renderAlerts() {
        const rBox = document.getElementById('rentAlerts'); rBox.innerHTML='';
        let hasU = false; rooms.filter(r=>r.status===1).forEach(r=>{ const st=getRentStatus(r); if(st.text==='Â∑≤Ë∂ÖÊúü'||st.text==='ÂèØÂÇ¨Áßü'){hasU=true; rBox.innerHTML+=`<div class="alert-item ${st.class==='rent-overdue'?'alert-danger':'alert-warning'}"><span>${r.building}-${r.room}</span><b>${st.text}</b></div>`;}});
        if(!hasU) rBox.innerHTML='<div style="text-align:center;color:var(--text-muted);padding:10px">Êó†Á¥ßÊÄ•‰∫ãÈ°π</div>';
        const lBox = document.getElementById('landlordAlerts'); lBox.innerHTML='';
        let hasP = false; plans.forEach(p=>{ const st=getPlanStatus(p); if(st.text!=='ÂÜçÁ≠âÁ≠â'){hasP=true; lBox.innerHTML+=`<div class="alert-item ${st.class==='rent-overdue'?'alert-danger':'alert-warning'}"><span>${p.building}</span><b>${st.text}</b></div>`;}});
        if(!hasP) lBox.innerHTML='<div style="text-align:center;color:var(--text-muted);padding:10px">Êó†Á¥ßÊÄ•‰∫ãÈ°π</div>';
    }
    function renderAll() { renderRooms(); renderPlans(); renderFinance(); renderAlerts(); renderCosts(); renderPetty(); }
    
        function saveData() {
        if (_saveTimer) clearTimeout(_saveTimer);
        _saveTimer = setTimeout(() => saveToFileSystem(), 2000);
    }
    
    function collectAllData() {
        return {
            rooms, plans, repairs, paymentHistory, pettyCash,
            financeOverrides, financeLogs, financeArchivedLogs,
            buildingTimestamps, settings, toolbarBtnOrder,
            roomColOrder, roomColWidths, planColOrder, planColWidths,
            financeColOrder, financeColWidths, costColOrder, costColWidths,
            pettyColOrder, pettyColWidths, roomHiddenCols, planHiddenCols, 
            currentRentData, currentFontSize,
            lastSaved: new Date().toLocaleString()
        };
    }

    
    function generateHtmlContent() {
        const allData = collectAllData();
        let html = document.documentElement.outerHTML;
        const dataJson = JSON.stringify(allData);
        const regex = /(<script id="EMBEDDED_DATA" type="application\/json">)([\s\S]*?)(<\/script>)/;
        if (regex.test(html)) {
            html = html.replace(regex, `$1${dataJson}$3`);
        }
        return '<!DOCTYPE html>\n' + html;
    }
    
    async function saveToFileSystem() {
        if (_isSaving) return;
        _isSaving = true;
        try {
            if ('showSaveFilePicker' in window && _fileHandle) {
                const writable = await _fileHandle.createWritable();
                await writable.write(generateHtmlContent());
                await writable.close();
                showSaveStatus('‚úì Â∑≤Ëá™Âä®‰øùÂ≠ò', 'success');
            } else if ('showSaveFilePicker' in window) {
                showSaveStatus('ËØ∑ÁÇπÂáªÂè≥‰∏ãËßíÊåâÈíÆÂêØÁî®Ëá™Âä®‰øùÂ≠ò', 'warning');
            } else {
                fallbackDownload();
            }
        } catch (e) {
            if (e.name !== 'AbortError') showSaveStatus('‰øùÂ≠òÂ§±Ë¥•', 'error');
        }
        _isSaving = false;
    }
    
    async function initFileHandle() {
        if (!('showSaveFilePicker' in window)) {
            alert('ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËá™Âä®‰øùÂ≠òÔºåËØ∑‰ΩøÁî®ChromeÊàñEdgeÊµèËßàÂô®');
            return;
        }
        try {
            _fileHandle = await window.showSaveFilePicker({
                suggestedName: '‰∫åÊàø‰∏úÊî∂ÁßüPRO.html',
                types: [{ description: 'HTMLÊñá‰ª∂', accept: { 'text/html': ['.html'] } }]
            });
            const writable = await _fileHandle.createWritable();
            await writable.write(generateHtmlContent());
            await writable.close();
            showSaveStatus('‚úì Ëá™Âä®‰øùÂ≠òÂ∑≤ÂêØÁî®', 'success');
            updateSaveButton(true);
            alert('Ëá™Âä®‰øùÂ≠òÂ∑≤ÂêØÁî®ÔºÅ‰πãÂêéÊâÄÊúâ‰øÆÊîπÈÉΩ‰ºöËá™Âä®‰øùÂ≠òÂà∞ËØ•Êñá‰ª∂„ÄÇ');
        } catch (e) {}
    }
    
    function fallbackDownload() {
        const blob = new Blob([generateHtmlContent()], { type: 'text/html;charset=utf-8' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = '‰∫åÊàø‰∏úÊî∂ÁßüPRO.html';
        a.click();
        URL.revokeObjectURL(a.href);
        showSaveStatus('Â∑≤‰∏ãËΩΩÔºåËØ∑ÊõøÊç¢ÂéüÊñá‰ª∂', 'warning');
    }
    
    function showSaveStatus(msg, type) {
        let el = document.getElementById('saveStatusTip');
        if (!el) {
            el = document.createElement('div');
            el.id = 'saveStatusTip';
            el.style.cssText = 'position:fixed;bottom:80px;right:20px;padding:10px 18px;border-radius:8px;font-size:14px;z-index:99999;transition:opacity 0.3s;box-shadow:0 3px 12px rgba(0,0,0,0.3);';
            document.body.appendChild(el);
        }
        el.textContent = msg;
        el.style.background = type === 'success' ? '#16a34a' : type === 'warning' ? '#f59e0b' : '#dc2626';
        el.style.color = 'white';
        el.style.opacity = '1';
        setTimeout(() => { el.style.opacity = '0'; }, 3000);
    }
    
    function updateSaveButton(enabled) {
        const btn = document.getElementById('floatSaveBtn');
        if (btn) {
            btn.innerHTML = enabled ? '<i class="fas fa-check-circle"></i>' : '<i class="fas fa-save"></i>';
            btn.title = enabled ? 'Ëá™Âä®‰øùÂ≠òÂ∑≤ÂêØÁî®' : 'ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠ò';
            btn.style.background = enabled ? '#16a34a' : '#4f46e5';
        }
    }

    function getRentStatus(r) {
        if (!r.nextPayDate) return { text: 'Á©∫ÁΩÆ', class: 'st-0' };
        const diff = Math.ceil((new Date(r.nextPayDate) - new Date().setHours(0,0,0,0)) / (86400000));
        if (diff <= 1) return { text: 'Â∑≤Ë∂ÖÊúü', class: 'rent-overdue' };
        if (diff > 7) return { text: 'ÂÜçÁ≠âÁ≠â', class: 'rent-wait' };
        return { text: 'ÂèØÂÇ¨Áßü', class: 'rent-urgency' };
    }
    function getPlanStatus(p) {
        const diff = Math.ceil((new Date(p.nextPayDate) - new Date().setHours(0,0,0,0)) / (86400000));
        if (diff < 3) return { text: 'Â∑≤ÈÄæÊúü', class: 'rent-overdue' }; else if (diff > 7) return { text: 'ÂÜçÁ≠âÁ≠â', class: 'rent-wait' }; return { text: 'Âç≥Â∞ÜÂà∞Êúü', class: 'rent-urgency' };
    }
    function handleSort(type, colId) {
        if (event.target.classList.contains('resizer')) return;
        if (currentSort.type === type && currentSort.col === colId) currentSort.dir *= -1;
        else { currentSort.type = type; currentSort.col = colId; currentSort.dir = 1; }
        renderAll();
    }
    function sortDataArray(d, type) {
        if (currentSort.type !== type || !currentSort.col) return d;
        const col = currentSort.col; const dir = currentSort.dir;
        return d.sort((a, b) => {
            let vA = a[col], vB = b[col];
            if (col === 'amount' || col === 'totalCost') { vA = (a.decoCost||0)+(a.mainCost||0)+(a.refundCost||0); vB = (b.decoCost||0)+(b.mainCost||0)+(b.refundCost||0); }
            
            if (col === 'rentStatus') {
                const map = { 'Â∑≤Ë∂ÖÊúü': 0, 'ÂèØÂÇ¨Áßü': 1, 'ÂÜçÁ≠âÁ≠â': 2, 'Á©∫ÁΩÆ': 3 };
                const tA = getRentStatus(a).text; const tB = getRentStatus(b).text;
                return (map[tA] - map[tB]) * dir;
            }
            
            if (col === 'occupancy') {
                vA = parseFloat(a.occupancy) || 0;
                vB = parseFloat(b.occupancy) || 0;
                return (vA - vB) * dir;
            }

            if (vA == null) vA = ''; if (vB == null) vB = '';
            return (typeof vA === 'number' && typeof vB === 'number' ? vA - vB : String(vA).localeCompare(String(vB), 'zh-CN')) * dir;
        });
    }

    function switchTab(tab) { 
        document.querySelectorAll('.table-wrapper').forEach(t => t.classList.add('hidden')); 
        document.getElementById('tab-' + tab).classList.remove('hidden'); 
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); 
        event.currentTarget.classList.add('active'); 
        
                const dashboard = document.getElementById('globalDashboard');
        if (['rooms', 'landlord'].includes(tab)) {
            dashboard.style.display = 'none';
        } else {
            dashboard.style.display = 'none';
        }


        renderAll(); 
    }
    function adjustFont(d) { currentFontSize = Math.max(10, Math.min(20, currentFontSize + d)); localStorage.setItem('rent_fontsize', currentFontSize); applyFontSize(); }
    function applyFontSize() { document.documentElement.style.setProperty('--base-font', currentFontSize + 'px'); }
    function updateBuildingList() {
        const list = document.getElementById('buildList'); const select = document.getElementById('filterBuilding');
        const bds = [...new Set(rooms.map(r => r.building))];
        list.innerHTML = ''; bds.forEach(b => { list.innerHTML += `<option value="${b}">`; });
        const cur = select.value; select.innerHTML = '<option value="">ÂÖ®ÈÉ®Ê•ºÊ†ã</option>';
        bds.forEach(b => { const o = document.createElement('option'); o.value=b; o.textContent=b; if(b===cur)o.selected=true; select.appendChild(o); });
    }
    function openColumnSetup() {
    const c = document.getElementById('colSetupContainer'); 
    c.innerHTML = `
        <h4 style="margin-top:0; margin-bottom:20px; text-align:center; color:var(--primary);">
            <i class="fas fa-columns"></i> ÊàøÊ∫êÁÆ°ÁêÜÈ°µÈù¢ÂàóËÆæÁΩÆ
        </h4>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px 25px; padding: 10px;">
    `;
    
    // Ê∑ªÂä†ÂÖ®ÈÄâÂàóÔºàchkÔºâ
    const chkWidth = roomColWidths['chk'] || 50;
    const chkItem = document.createElement('div');
    chkItem.style.cssText = 'display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;';
    chkItem.innerHTML = `
        <input type="checkbox" value="chk" checked disabled style="flex-shrink: 0; opacity: 0.6;"> 
        <span style="flex: 1; font-weight: 500;">ÂÖ®ÈÄâ</span>
        <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
        <input type="number" 
               class="col-width-input" 
               data-col="chk" 
               data-type="room"
               value="${chkWidth}" 
               min="30" 
               max="100" 
               style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
        <span style="color: var(--text-secondary); font-size: 10px;">px</span>
    `;
    c.appendChild(chkItem);
    
    roomColOrder.forEach(colId => { 
        if(colId==='op' || colId==='chk')return; 
        const def=roomColDefs[colId]; 
        if(!def)return; 
        const chk=!roomHiddenCols.includes(colId); 
        const currentWidth = roomColWidths[colId] || 100;
        const i=document.createElement('div'); 
        i.style.cssText = 'display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;';
        i.innerHTML=`
            <input type="checkbox" value="${colId}" ${chk?'checked':''} style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">${def.title}</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" 
                   class="col-width-input" 
                   data-col="${colId}" 
                   data-type="room"
                   value="${currentWidth}" 
                   min="30" 
                   max="500" 
                   style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        `; 
        c.appendChild(i); 
    });
    
    c.innerHTML += '</div>';
    document.getElementById('columnSetupModal').style.display = 'flex';
}


    function saveColumnSetup() {
    const isPlan = document.querySelector('#colSetupContainer input[data-type="plan"]');
    if(isPlan) {
        savePlanColumnSetup();
    } else {
        const newHidden = []; 
        document.querySelectorAll('#colSetupContainer input[type="checkbox"]:not([disabled])').forEach(i => { 
            if(!i.checked) newHidden.push(i.value); 
        });
        roomHiddenCols = newHidden;
        
        // ‰øùÂ≠òÂàóÂÆΩËÆæÁΩÆÔºàÂåÖÊã¨ÂÖ®ÈÄâÂàóÔºâ
        document.querySelectorAll('#colSetupContainer .col-width-input[data-type="room"]').forEach(input => {
            const colId = input.dataset.col;
            const width = parseInt(input.value) || 100;
            if(colId === 'chk') {
                roomColWidths[colId] = Math.max(30, Math.min(100, width)); // ÂÖ®ÈÄâÂàóÈôêÂà∂Âú®30-100‰πãÈó¥
            } else {
                roomColWidths[colId] = Math.max(30, Math.min(500, width)); // ÂÖ∂‰ªñÂàóÈôêÂà∂Âú®30-500‰πãÈó¥
            }
        });
        
        saveData(); 
        closeModal('columnSetupModal'); 
        renderRooms();
    }
}



function openPlanColumnSetup() {
    const c = document.getElementById('colSetupContainer'); 
    c.innerHTML = `
        <h4 style="margin-top:0; margin-bottom:20px; text-align:center; color:var(--primary);">
            <i class="fas fa-bell"></i> ‰ªòÊ¨æÊèêÈÜíÈ°µÈù¢ÂàóËÆæÁΩÆ
        </h4>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px 25px; padding: 10px;">
    `;
    
    planColOrder.forEach(colId => { 
        if(colId==='op')return; 
        const def=planColDefs[colId]; 
        if(!def)return; 
        const chk=!planHiddenCols.includes(colId); 
        const currentWidth = planColWidths[colId] || 100;
        const i=document.createElement('div'); 
        i.style.cssText = 'display: flex; align-items: center; gap: 8px; padding: 8px; background: var(--table-header-bg); border-radius: 6px;';
        i.innerHTML=`
            <input type="checkbox" value="${colId}" data-type="plan" ${chk?'checked':''} style="flex-shrink: 0;"> 
            <span style="flex: 1; font-weight: 500;">${def.title}</span>
            <span style="color: var(--text-secondary); font-size: 10px;">ÂàóÂÆΩ:</span>
            <input type="number" 
                   class="col-width-input" 
                   data-col="${colId}" 
                   data-type="plan"
                   value="${currentWidth}" 
                   min="30" 
                   max="500" 
                   style="width: 60px; padding: 3px 6px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--input-bg); color: var(--text-primary); font-size: 11px;">
            <span style="color: var(--text-secondary); font-size: 10px;">px</span>
        `; 
        c.appendChild(i); 
    });
    
    c.innerHTML += '</div>';
    document.getElementById('columnSetupModal').style.display = 'flex';
}


    
    function savePlanColumnSetup() {
    const newHiddenPlan = [];
    document.querySelectorAll('#colSetupContainer input[type="checkbox"][data-type="plan"]').forEach(i => { 
        if(!i.checked) newHiddenPlan.push(i.value);
    });
    planHiddenCols = newHiddenPlan;
    
    // ‰øùÂ≠òÂàóÂÆΩËÆæÁΩÆ
    document.querySelectorAll('#colSetupContainer .col-width-input[data-type="plan"]').forEach(input => {
        const colId = input.dataset.col;
        const width = parseInt(input.value) || 100;
        planColWidths[colId] = Math.max(30, Math.min(500, width)); // ÈôêÂà∂Âú®30-500‰πãÈó¥
    });
    
    saveData(); 
    closeModal('columnSetupModal'); 
    renderPlans();
}


    function screenshotRent() { 
        const start = document.getElementById('searchStart').value; const end = document.getElementById('searchEnd').value;
        let targets = rooms.filter(r => { const st = getRentStatus(r); return st.text === 'Â∑≤Ë∂ÖÊúü' && (!start || r.nextPayDate >= start) && (!end || r.nextPayDate <= end); });
        if(targets.length === 0) return alert('Êó†Â∑≤Ë∂ÖÊúüÊàøÊ∫ê');
        targets.sort((a,b) => (a.building||'').localeCompare(b.building||'', 'zh-CN') || (a.nextPayDate||'').localeCompare(b.nextPayDate||''));
        createScreenshot(targets, 'Ë∂ÖÊúüÂÇ¨Ê¨æÈÄöÁü•Âçï', {totalMoney: targets.reduce((a,r)=>a+(parseFloat(r.price)||0),0), count: targets.length, dateRange: `${start||'ÊúÄÂàù'} Ëá≥ ${end||'ÊúÄÂêé'}`});
    }
    
    function screenshotVacant() { 
        let targets = rooms.filter(r=>getRentStatus(r).text==='Á©∫ÁΩÆ'); 
        
        targets.sort((a, b) => {
            const buildA = (a.building || '').toString();
            const buildB = (b.building || '').toString();
            const buildCompare = buildA.localeCompare(buildB, 'zh-CN');
            
            if (buildCompare !== 0) {
                return buildCompare;
            }
            return (a.room || '').localeCompare(b.room || '', undefined, {numeric: true});
        });

        createScreenshot(targets, 'ÊàøÊ∫êÁ©∫ÁΩÆÊãõÁßüÂçï', {
            totalMoney: targets.reduce((a,r)=>a+(parseFloat(r.price)||0),0), 
            count: targets.length, 
            dateRange: `Êà™Ëá≥ ${new Date().toISOString().split('T')[0]}`
        }); 
    }

    function createScreenshot(targets, title, stats) {
        const c = document.createElement('div'); c.style.cssText = "position:absolute;top:0;left:-9999px;width:900px;background:#f8fafc;padding:30px;font-family:sans-serif;";
        let statsHtml = stats ? `<div style="display:flex; justify-content:space-between; gap:15px; margin: 25px 0;"><div style="flex:1; border:2px solid #3b82f6; border-radius:8px; padding:15px; text-align:center; background:white;"><div style="font-size:12px; color:#64748b; margin-bottom:5px;">Êó∂Èó¥ËåÉÂõ¥</div><div style="font-size:14px; font-weight:bold; color:#1e293b;">${stats.dateRange}</div></div><div style="flex:1; border:2px solid #f97316; border-radius:8px; padding:15px; text-align:center; background:white;"><div style="font-size:12px; color:#64748b; margin-bottom:5px;">ÊàøÈó¥Êï∞Èáè</div><div style="font-size:18px; font-weight:bold; color:#f97316;">${stats.count} Èó¥</div></div><div style="flex:1; border:2px solid #dc2626; border-radius:8px; padding:15px; text-align:center; background:white;"><div style="font-size:12px; color:#64748b; margin-bottom:5px;">Ê∂âÂèäÈáëÈ¢ù</div><div style="font-size:18px; font-weight:bold; color:#dc2626;">¬•${stats.totalMoney}</div></div></div>` : '';
        const visibleCols = roomColOrder.filter(c=>c!=='op' && c!=='chk' && !roomHiddenCols.includes(c));
        
        c.innerHTML = `<h2 style="text-align:center; margin-bottom:10px; color:#334155; font-size:24px;">${title}</h2>${statsHtml}<table style="width:100%;border-collapse:collapse;font-size:12px;background:white; border-radius:8px; overflow:hidden; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><thead style="background:#e2e8f0; color:#475569;"><tr>${visibleCols.map(c=>`<th style="border:1px solid #cbd5e1;padding:10px;text-align:center;">${roomColDefs[c].title}</th>`).join('')}</tr></thead><tbody>${targets.map(r=>{const st=getRentStatus(r); return `<tr>${visibleCols.map(c => { let cc = roomColDefs[c].render(r).replace(/<[^>]*>/g,'').trim(); let cs = "border:1px solid #cbd5e1;padding:10px;text-align:center;"; if (cc === 'Â∑≤Ë∂ÖÊúü' || cc === 'Á©∫ÁΩÆ' || (c === 'rentStatus' && (st.text === 'Â∑≤Ë∂ÖÊúü' || st.text === 'Á©∫ÁΩÆ'))) cs += "font-weight:bold; color:#dc2626; background:#fef2f2;"; return `<td style="${cs}">${cc}</td>`; }).join('')}</tr>`; }).join('')}</tbody></table><div style="margin-top:20px; text-align:right; color:#94a3b8; font-size:11px;">ÁîüÊàêÊó∂Èó¥: ${new Date().toLocaleString()}</div>`;
        document.body.appendChild(c); html2canvas(c).then(cvs => { const a = document.createElement('a'); a.download = `${title}.png`; a.href = cvs.toDataURL(); a.click(); document.body.removeChild(c); });
    }
    
    function closeModal(m) { document.getElementById(m).style.display = 'none'; }
    function openRoomModal(id=null) {
        document.getElementById('roomModal').style.display='flex';
        if(id) { const r=rooms.find(x=>x.id===id); document.getElementById('m_id').value=r.id; document.getElementById('m_building').value=r.building; document.getElementById('m_room').value=r.room; document.getElementById('m_price').value=r.price; document.getElementById('m_tenant').value=r.tenant; document.getElementById('m_phone').value=r.phone; document.getElementById('m_nextPayDate').value=r.nextPayDate; document.getElementById('m_contractPeriod').value=r.contractPeriod; document.getElementById('m_notes').value=r.notes; document.getElementById('btnDeleteRoom').style.display='block'; }
        else { document.getElementById('m_id').value=''; document.getElementById('btnDeleteRoom').style.display='none'; document.querySelectorAll('#roomModal input').forEach(i=>i.value=''); }
    }
    function saveRoom() {
        pushHistory(); const id = document.getElementById('m_id').value;
        const d = { id: id?parseInt(id):Date.now(), building: document.getElementById('m_building').value.trim(), room: document.getElementById('m_room').value.trim(), price: parseFloat(document.getElementById('m_price').value)||0, tenant: document.getElementById('m_tenant').value.trim(), phone: document.getElementById('m_phone').value.trim(), nextPayDate: document.getElementById('m_nextPayDate').value, contractPeriod: document.getElementById('m_contractPeriod').value.trim(), status: document.getElementById('m_nextPayDate').value?1:0, notes: document.getElementById('m_notes').value.trim(), updateTime: Date.now() };
        if(id) { const i=rooms.findIndex(x=>x.id==id); rooms[i]={...rooms[i], ...d}; } else rooms.push({...d, payCount:0, logs:[], archivedLogs:[]});
        saveData(); closeModal('roomModal'); updateBuildingList(); renderAll();
    }
    function deleteRoom() { if(confirm('Âà†Èô§Ê≠§ÊàøÊ∫êÔºü')) { pushHistory(); rooms=rooms.filter(r=>r.id!=document.getElementById('m_id').value); saveData(); closeModal('roomModal'); renderAll(); }}
    
    // ‚òÖ‚òÖ‚òÖ ‰øÆÂ§çÔºöÂêåÊó∂Ê∏ÖÁ©∫ input Âíå textarea ÂÖÉÁ¥†ÔºåÁ°Æ‰øùÊñ∞Â¢ûËÆ°ÂàíË°®ÂçïÂÆåÂÖ®Á©∫ÁôΩ ‚òÖ‚òÖ‚òÖ
    function openPlanModal() { 
        document.getElementById('p_index').value=''; 
        document.querySelectorAll('#planModal input').forEach(i=>i.value=''); 
        document.querySelectorAll('#planModal textarea').forEach(t=>t.value=''); // ‰øÆÂ§çÔºöÊ∏ÖÁ©∫ textarea
        document.getElementById('p_date').value=new Date().toISOString().split('T')[0]; 
        document.getElementById('p_payCount').value='0'; // ÈáçÁΩÆ‰∫§ÁßüÊ¨°Êï∞‰∏∫0
        document.getElementById('planModal').style.display='flex'; 
        document.getElementById('btnDeletePlan').style.display='none'; 
    }
    
    function savePlan() {
        pushHistory(); const idx=document.getElementById('p_index').value;
        const d={ building: document.getElementById('p_building').value.trim(), paymentInfo: document.getElementById('p_info').value, amount: parseFloat(document.getElementById('p_amount').value)||0, nextPayDate: document.getElementById('p_date').value, payCount: parseInt(document.getElementById('p_payCount').value)||0, notes: document.getElementById('p_notes').value, updateTime: Date.now() };
        if(idx!=='') plans[idx]={...plans[idx], ...d}; else plans.push({...d, logs:[], archivedLogs:[]});
        saveData(); closeModal('planModal'); renderAll();
    }
    function deletePlan() { if(confirm('Âà†Èô§ËÆ°ÂàíÔºü')) { pushHistory(); plans.splice(document.getElementById('p_index').value,1); saveData(); closeModal('planModal'); renderAll(); }}
    function openCostModal(id=null) { document.getElementById('costModal').style.display='flex'; if(id) { const r=repairs.find(x=>x.id==id); document.getElementById('c_id').value=r.id; document.getElementById('c_building').value=r.building; document.getElementById('c_content').value=r.content||r.item; document.getElementById('c_amount').value=(r.decoCost||0)+(r.mainCost||0)+(r.refundCost||0); document.getElementById('c_type').value=r.type; document.getElementById('c_date').value=r.date; document.getElementById('c_notes').value=r.notes||''; } else { document.getElementById('c_id').value=''; document.getElementById('c_date').value=new Date().toISOString().split('T')[0]; document.getElementById('c_type').value='maintenance'; document.getElementById('c_amount').value=''; document.getElementById('c_building').value=''; document.getElementById('c_content').value=''; document.getElementById('c_notes').value=''; } }
            function deleteCost(id) { 
        if(confirm('Âà†Èô§Ôºü')) { 
            pushHistory(); 
            const cost = repairs.find(r => r.id == id);
            if(cost) {
                const typeName = cost.type==='decoration'?'Ë£Ö‰øÆ':(cost.type==='maintenance'?'Áª¥Êä§':'ÈÄÄÁßü');
                const amt = parseFloat(cost.decoCost || cost.mainCost || cost.refundCost || 0);
                addFinanceLog(cost.building, `Âà†Èô§${typeName}ÊàêÊú¨: ${cost.content} (¬•${amt})`);
                updateBuildingTs(cost.building);
                
                // ‚òÖ‚òÖ‚òÖ ÈáçÁΩÆË¥¢Âä°Ê±áÊÄªÊéíÂ∫èÔºåÁ°Æ‰øù‰øÆÊîπÁöÑÊ•ºÊ†ã‰∏äÊµÆËá≥È°∂ÈÉ® ‚òÖ‚òÖ‚òÖ
                if (currentSort.type === 'finance') {
                    currentSort.type = null;
                    currentSort.col = null;
                    currentSort.dir = 1;
                }
            }
            repairs=repairs.filter(r=>r.id!=id); 
            saveData(); 
            renderAll(); 
        }
    }


    function openPettyModal(type) { document.getElementById('pt_id').value=''; document.getElementById('pt_type').value=type; document.getElementById('pt_type_display').innerText=type==='in'?'üü¢ ÂÄüÁî®':'üî¥ ÊîØÂá∫'; document.getElementById('pt_type_display').className=type==='in'?'trans-in':'trans-out'; document.getElementById('pt_date').value=new Date().toISOString().split('T')[0]; document.getElementById('pt_amount').value=''; document.getElementById('pt_reason').value=''; document.getElementById('pettyModal').style.display='flex'; }
    function editPetty(id) { const p=pettyCash.find(x=>x.id==id); if(!p)return; document.getElementById('pt_id').value=p.id; document.getElementById('pt_type').value=p.type; document.getElementById('pt_amount').value=p.amount; document.getElementById('pt_reason').value=p.reason; document.getElementById('pt_date').value=p.date; document.getElementById('pt_type_display').innerText=p.type==='in'?'üü¢ ÂÄüÁî®':'üî¥ ÊîØÂá∫'; document.getElementById('pt_type_display').className=p.type==='in'?'trans-in':'trans-out'; document.getElementById('pettyModal').style.display='flex'; }
    function savePettyTrans() { pushHistory(); const id=document.getElementById('pt_id').value; const d={ id: id?parseInt(id):Date.now(), type: document.getElementById('pt_type').value, amount: parseFloat(document.getElementById('pt_amount').value)||0, reason: document.getElementById('pt_reason').value, date: document.getElementById('pt_date').value }; if(id) pettyCash[pettyCash.findIndex(p=>p.id==id)]=d; else pettyCash.push(d); saveData(); closeModal('pettyModal'); renderAll(); }
    function deletePetty(id) { if(confirm('Âà†Èô§Ôºü')) { pushHistory(); pettyCash=pettyCash.filter(p=>p.id!=id); saveData(); renderAll(); }}
    
    function openLogModal(type, id) { document.getElementById('log_type').value=type; document.getElementById('log_id').value=id; document.getElementById('logModal').style.display='flex'; renderLogs(type, id); }
    function renderLogs(type, id) {
        let logs=[], archived=[];
        if(type==='room'){const r=rooms.find(x=>x.id==id);if(r){logs=r.logs;archived=r.archivedLogs;}}
        else if(type==='plan'){const p=plans[id];if(p){logs=p.logs;archived=p.archivedLogs;}}
        else if(type==='finance'){logs=financeLogs[id]||[];archived=financeArchivedLogs[id]||[];}
        const list=document.getElementById('logList'); list.innerHTML='';
        if(!logs||logs.length===0) list.innerHTML='<li style="padding:20px;text-align:center;color:var(--text-muted)">ÊöÇÊó†ËÆ∞ÂΩï</li>';
        else {
            [...logs].reverse().forEach((l,i)=>list.innerHTML+=`<li class="log-item"><span class="log-idx">${i+1}.</span><div><span class="log-date">${l.date}</span><span class="log-content">${l.content}</span></div></li>`);
        }
        document.getElementById('btnRestoreLogs').style.display=(archived&&archived.length>0)?'inline-block':'none';
    }
    function clearLogs() { if(!confirm('Ê∏ÖÁ©∫ÂΩìÂâçËÆ∞ÂΩïÔºü'))return; pushHistory(); const t=document.getElementById('log_type').value, id=document.getElementById('log_id').value; if(t==='room'){const r=rooms.find(x=>x.id==id);r.archivedLogs=[...(r.archivedLogs||[]),...r.logs];r.logs=[];} else if(t==='plan'){const p=plans[id];p.archivedLogs=[...(p.archivedLogs||[]),...p.logs];p.logs=[];} else if(t==='finance'){financeArchivedLogs[id]=[...(financeArchivedLogs[id]||[]),...(financeLogs[id]||[])];financeLogs[id]=[];} saveData(); renderLogs(t,id); }
    function restoreLogs() { if(!confirm('ÊÅ¢Â§çÂéÜÂè≤ËÆ∞ÂΩïÔºü'))return; pushHistory(); const t=document.getElementById('log_type').value, id=document.getElementById('log_id').value; if(t==='room'){const r=rooms.find(x=>x.id==id);r.logs=[...r.archivedLogs,...r.logs];r.archivedLogs=[];} else if(t==='plan'){const p=plans[id];p.logs=[...p.archivedLogs,...p.logs];p.archivedLogs=[];} else if(t==='finance'){financeLogs[id]=[...financeArchivedLogs[id],...financeLogs[id]];financeArchivedLogs[id]=[];} saveData(); renderLogs(t,id); }
    
    function openFinanceEditModal(b) { const d=calculateFinanceData().find(x=>x.building===b); if(!d)return; document.getElementById('fe_building').value=b; document.getElementById('fe_income').value=d.cumulativeIncome; document.getElementById('fe_landlord').value=d.cumulativeLandlord; document.getElementById('fe_deco').value=d.decoration; document.getElementById('fe_repair').value=d.repair; document.getElementById('fe_refund').value=d.refund; document.getElementById('financeEditModal').style.display='flex'; }
    function openDateModal(id) { document.getElementById('d_roomId').value=id; document.getElementById('dateModal').style.display='flex'; }
    function clearDateInput() { document.getElementById('d_newDate').value=''; }
    function saveNewDate() { pushHistory(); const r=rooms.find(x=>x.id==document.getElementById('d_roomId').value); r.nextPayDate=document.getElementById('d_newDate').value; r.status=r.nextPayDate?1:0; r.updateTime = Date.now(); saveData(); closeModal('dateModal'); renderAll(); }
    function openPlanDateModalWrapper(i) { document.getElementById('pd_index').value=i; document.getElementById('planDateModal').style.display='flex'; }
    function savePlanNewDate() { pushHistory(); plans[document.getElementById('pd_index').value].nextPayDate=document.getElementById('pd_newDate').value; plans[document.getElementById('pd_index').value].updateTime = Date.now(); saveData(); closeModal('planDateModal'); renderAll(); }
    function editPlan(i) { document.getElementById('p_index').value=i; const p=plans[i]; document.getElementById('p_building').value=p.building; document.getElementById('p_info').value=p.paymentInfo||''; document.getElementById('p_amount').value=p.amount; document.getElementById('p_date').value=p.nextPayDate; document.getElementById('p_payCount').value=p.payCount; document.getElementById('p_notes').value=p.notes||''; document.getElementById('btnDeletePlan').style.display='block'; document.getElementById('planModal').style.display='flex'; }

    function pushHistory() { undoStack.push(JSON.stringify({rooms,plans,repairs,paymentHistory,pettyCash,financeOverrides,financeLogs,financeArchivedLogs, buildingTimestamps})); if(undoStack.length>20) undoStack.shift(); redoStack=[]; updateUndoRedoButtons(); }
    function performUndo() { if(undoStack.length===0)return; redoStack.push(JSON.stringify({rooms,plans,repairs,paymentHistory,pettyCash,financeOverrides,financeLogs,financeArchivedLogs, buildingTimestamps})); const d=JSON.parse(undoStack.pop()); restoreDataState(d); }
    function performRedo() { if(redoStack.length===0)return; undoStack.push(JSON.stringify({rooms,plans,repairs,paymentHistory,pettyCash,financeOverrides,financeLogs,financeArchivedLogs, buildingTimestamps})); const d=JSON.parse(redoStack.pop()); restoreDataState(d); }
    function restoreDataState(d) { rooms=d.rooms;plans=d.plans;repairs=d.repairs;paymentHistory=d.paymentHistory;pettyCash=d.pettyCash;financeOverrides=d.financeOverrides;financeLogs=d.financeLogs;financeArchivedLogs=d.financeArchivedLogs;buildingTimestamps=d.buildingTimestamps||{}; saveData(); renderAll(); updateUndoRedoButtons(); }
    function updateUndoRedoButtons() { document.getElementById('btnUndo').disabled=undoStack.length===0; document.getElementById('btnUndo').classList.toggle('btn-disabled',undoStack.length===0); document.getElementById('btnRedo').disabled=redoStack.length===0; document.getElementById('btnRedo').classList.toggle('btn-disabled',redoStack.length===0); }
    function applySettings() { document.getElementById('appTitle').innerText=settings.appTitle; document.getElementById('settingAppTitle').value=settings.appTitle; document.getElementById('menu-rooms').innerText=settings.menuNames.rooms; document.getElementById('menu-landlord').innerText=settings.menuNames.landlord; document.getElementById('menu-finance').innerText=settings.menuNames.finance; document.getElementById('menu-repair').innerText=settings.menuNames.repair; document.getElementById('menu-petty').innerText=settings.menuNames.petty; document.getElementById('title-rooms').innerHTML=`üè† ${settings.menuNames.rooms}`; document.getElementById('settingBackupInterval').value=settings.backupInterval; document.getElementById('set_menu_rooms').value=settings.menuNames.rooms; document.getElementById('set_menu_landlord').value=settings.menuNames.landlord; document.getElementById('set_menu_finance').value=settings.menuNames.finance; document.getElementById('set_menu_repair').value=settings.menuNames.repair; document.getElementById('set_menu_petty').value=settings.menuNames.petty; }
    function updateSettings() { settings={appTitle:document.getElementById('settingAppTitle').value, menuNames:{rooms:document.getElementById('set_menu_rooms').value,landlord:document.getElementById('set_menu_landlord').value,finance:document.getElementById('set_menu_finance').value,repair:document.getElementById('set_menu_repair').value,petty:document.getElementById('set_menu_petty').value}, backupInterval:parseFloat(document.getElementById('settingBackupInterval').value), theme: settings.theme || 'auto'}; saveData(); applySettings(); setupAutoBackup(); }
    function setupAutoBackup() { if(autoBackupTimer)clearInterval(autoBackupTimer); if(settings.backupInterval>0) autoBackupTimer=setInterval(backupData, settings.backupInterval*60000); }
    function initiateSafeWipe() { document.getElementById('wipeModal').style.display='flex'; let t=30; document.getElementById('wipeTimer').innerText=t; const b=document.getElementById('btnConfirmWipe'); b.disabled=true; b.classList.add('act-disabled'); const i=setInterval(()=>{t--;document.getElementById('wipeTimer').innerText=t;if(t<=0){clearInterval(i);b.disabled=false;b.classList.remove('act-disabled');}},1000); }
    function cancelWipe() { document.getElementById('wipeModal').style.display='none'; }
        function executeWipe() { 
        rooms=[]; plans=[]; repairs=[]; paymentHistory=[]; pettyCash=[];
        financeOverrides={}; financeLogs={}; financeArchivedLogs={}; buildingTimestamps={};
        settings={appTitle:'‰∫åÊàø‰∏ú‰ºÅ‰∏öÊî∂ÁßüÁ≥ªÁªü',menuNames:{rooms:'ÊàøÊ∫êÁÆ°ÁêÜ',landlord:'‰ªòÊ¨æÊèêÈÜí',finance:'Ë¥¢Âä°Ê±áÊÄª',repair:'ÊàêÊú¨ÁÆ°ÁêÜ',petty:'Â§áÁî®ÊµÅÊ∞¥'},backupInterval:0,theme:'auto'};
        toolbarBtnOrder=[...defaultToolbarBtnOrder];
        roomColOrder=[...defaultRoomColOrder]; roomColWidths={'chk':40};
        planColOrder=[...defaultPlanColOrder]; planColWidths={'info':200};
        financeColOrder=[...defaultFinanceColOrder]; financeColWidths={'occupancy':120,'building':150};
        costColOrder=[...defaultCostColOrder]; costColWidths={};
        pettyColOrder=[...defaultPettyColOrder]; pettyColWidths={};
        roomHiddenCols=[];
        if(_fileHandle){ saveToFileSystem(); setTimeout(()=>location.reload(),500); }
        else{ fallbackDownload(); alert('Êï∞ÊçÆÂ∑≤Ê∏ÖÁ©∫ÔºåËØ∑Áî®‰∏ãËΩΩÁöÑÊñá‰ª∂ÊõøÊç¢ÂéüÊñá‰ª∂'); }
    }

    function downloadTemplate() { const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet([['Ê•ºÊ†ã','ÊàøÂè∑','ÁßüÂÆ¢ÂßìÂêç','ÁîµËØù','Âá∫Áßü‰ª∑Ê†º','ÂêàÂêåËµ∑Ê≠¢Êó∂Èó¥','‰∏ãÊ¨°‰∫§ÁßüÊó•(Âπ¥-Êúà-Êó•)'],['Á§∫‰æãÂÖ¨ÂØìA','101','Âº†‰∏â','13800000000',3000,'2025.01.01-2026.01.01','2026-02-15']]), "ÂØºÂÖ•Ê®°Êùø"); XLSX.writeFile(wb, "ÊàøÊ∫êÂØºÂÖ•Ê®°Êùø.xlsx"); }
    
    function exportToExcel() {
        const wb = XLSX.utils.book_new();
        const generateSheetData = (data, colOrder, colDefs) => {
            const visibleCols = colOrder.filter(c => c !== 'op' && c !== 'chk');
            const headers = visibleCols.map(c => colDefs[c].title);
            const rows = data.map(item => { return visibleCols.map(c => { return colDefs[c].getValue ? colDefs[c].getValue(item) : ''; }); });
            return [headers, ...rows];
        };
        const roomData = generateSheetData(rooms, roomColOrder, roomColDefs); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(roomData), "ÊàøÊ∫êÁÆ°ÁêÜ");
        const planData = generateSheetData(plans, planColOrder, planColDefs); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(planData), "‰ªòÊ¨æÊèêÈÜí");
        const finDataRaw = calculateFinanceData(); const finData = generateSheetData(finDataRaw, financeColOrder, financeColDefs); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(finData), "Ë¥¢Âä°Ê±áÊÄª");
        const costData = generateSheetData(repairs, costColOrder, costColDefs); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(costData), "ÊàêÊú¨ÁÆ°ÁêÜ");
        const pettyData = generateSheetData(pettyCash, pettyColOrder, pettyColDefs); XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(pettyData), "Â§áÁî®ÊµÅÊ∞¥");
        XLSX.writeFile(wb, `Êàø‰∏úÁÆ°ÂÆ∂Pro_ÂÖ®Êï∞ÊçÆÂØºÂá∫_${new Date().toISOString().slice(0,10)}.xlsx`);
    }

    function importExcel(i) { const f=i.files[0]; if(!f)return; const r=new FileReader(); r.onload=e=>{ pushHistory(); const d=XLSX.utils.sheet_to_json(XLSX.read(new Uint8Array(e.target.result),{type:'array'}).Sheets[XLSX.read(new Uint8Array(e.target.result),{type:'array'}).SheetNames[0]],{header:1}); for(let j=1;j<d.length;j++){const row=d[j];if(row&&row[0]&&row[1])rooms.push({id:Date.now()+j,building:row[0],room:row[1],tenant:row[2]||'',phone:row[3]||'',price:parseFloat(row[4])||0,contractPeriod:row[5]||'',nextPayDate:row[6]||new Date().toISOString().split('T')[0],status:row[2]?1:0,logs:[],archivedLogs:[], updateTime: Date.now()});} saveData(); updateBuildingList(); renderAll(); alert('ÂØºÂÖ•ÊàêÂäü'); }; r.readAsArrayBuffer(f); }
    function backupData() { const blob=new Blob([JSON.stringify({rooms,plans,repairs,paymentHistory,pettyCash,financeOverrides,financeLogs,financeArchivedLogs,buildingTimestamps,settings,toolbarBtnOrder,roomColOrder,roomColWidths,planColOrder,planColWidths,financeColOrder,financeColWidths,costColOrder,costColWidths,pettyColOrder,pettyColWidths,roomHiddenCols,timestamp:new Date().toLocaleString()})],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=`‰∫åÊàø‰∏úÁ≥ªÁªüÂ§á‰ªΩ_${new Date().toISOString().slice(0,10)}.json`; a.click(); }
        function restoreData(i) { const f=i.files[0]; if(!f)return; const r=new FileReader(); r.onload=async e=>{ try{const d=JSON.parse(e.target.result); if(confirm(`ÊÅ¢Â§çÂ§á‰ªΩÊó∂Èó¥Ôºö${d.timestamp}ÔºåÁ°ÆÂÆöÂêóÔºü`)){pushHistory();rooms=d.rooms||[];plans=d.plans||[];repairs=d.repairs||[];paymentHistory=d.paymentHistory||[];pettyCash=d.pettyCash||[];financeOverrides=d.financeOverrides||{};financeLogs=d.financeLogs||{};financeArchivedLogs=d.financeArchivedLogs||{};buildingTimestamps=d.buildingTimestamps||{};if(d.settings)settings=d.settings;if(d.toolbarBtnOrder)toolbarBtnOrder=d.toolbarBtnOrder;if(d.roomColOrder)roomColOrder=d.roomColOrder;if(d.roomColWidths)roomColWidths=d.roomColWidths;if(d.financeColOrder)financeColOrder=d.financeColOrder;if(d.financeColWidths)financeColWidths=d.financeColWidths;if(d.roomHiddenCols)roomHiddenCols=d.roomHiddenCols;if(d.planColOrder)planColOrder=d.planColOrder;if(d.planColWidths)planColWidths=d.planColWidths;if(d.costColOrder)costColOrder=d.costColOrder;if(d.costColWidths)costColWidths=d.costColWidths;if(d.pettyColOrder)pettyColOrder=d.pettyColOrder;if(d.pettyColWidths)pettyColWidths=d.pettyColWidths;if(d.currentFontSize)currentFontSize=d.currentFontSize;if(_fileHandle){try{const writable=await _fileHandle.createWritable();await writable.write(generateHtmlContent());await writable.close();alert('Â§á‰ªΩÊÅ¢Â§çÊàêÂäüÔºÅ');location.reload();}catch(err){fallbackDownload();alert('Â§á‰ªΩÂ∑≤ÊÅ¢Â§çÔºåËØ∑Áî®‰∏ãËΩΩÁöÑÊñá‰ª∂ÊõøÊç¢ÂéüÊñá‰ª∂ÂêéÈáçÊñ∞ÊâìÂºÄ');}}else{fallbackDownload();alert('Â§á‰ªΩÂ∑≤ÊÅ¢Â§çÔºåËØ∑Áî®‰∏ãËΩΩÁöÑÊñá‰ª∂ÊõøÊç¢ÂéüÊñá‰ª∂ÂêéÈáçÊñ∞ÊâìÂºÄ');}}}catch(e){alert('Â§á‰ªΩÊñá‰ª∂Êó†ÊïàÔºö'+e.message);}}; r.readAsText(f); }

    // ========== ÊµÆÂä®‰øùÂ≠òÊåâÈíÆ ==========
    document.addEventListener('DOMContentLoaded', function() {
        const btn = document.createElement('button');
        btn.id = 'floatSaveBtn';
        btn.innerHTML = '<i class="fas fa-save"></i>';
        btn.title = 'ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂';
        btn.style.cssText = 'position:fixed;bottom:20px;right:20px;width:56px;height:56px;border-radius:50%;background:#4f46e5;color:white;border:none;cursor:pointer;box-shadow:0 4px 15px rgba(79,70,229,0.4);font-size:22px;z-index:99998;transition:all 0.3s;';
        btn.onmouseover = () => btn.style.transform = 'scale(1.1)';
        btn.onmouseout = () => btn.style.transform = 'scale(1)';
        btn.onclick = initFileHandle;
        document.body.appendChild(btn);
        
        if (_embedded && _embedded.lastSaved) {
            setTimeout(() => showSaveStatus('Êï∞ÊçÆÂ∑≤Âä†ËΩΩÔºåÁÇπÂáªÂè≥‰∏ãËßíüíæÂêØÁî®Ëá™Âä®‰øùÂ≠ò', 'warning'), 1500);
        }
    });
// ========== Êú¨Ê¨°Êî∂ÁßüÂäüËÉΩ ==========
    let currentRentData = (_embedded && _embedded.currentRentData) || { rooms: [], total: 0, count: 0 };
    let currentRentBackup = null;

    function updateCurrentRentDisplay() {
        const elem = document.getElementById('sum-current-rent');
        if (elem) {
            elem.innerHTML = '¬•' + currentRentData.total + ' <span style="font-size:11px;color:var(--text-muted);">(' + currentRentData.count + 'Èó¥)</span>';
        }
    }

    function addToCurrentRent(roomId, amount) {
        if (!currentRentData.rooms.includes(roomId)) {
            currentRentData.rooms.push(roomId);
            currentRentData.total += amount;
            currentRentData.count++;
            saveData();
            updateCurrentRentDisplay();
        }
    }

    function clearCurrentRent() {
        if (currentRentData.count === 0) {
            alert('ÂΩìÂâçÊ≤°ÊúâÊî∂ÁßüËÆ∞ÂΩï');
            return;
        }
        if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫Êú¨Ê¨°Êî∂ÁßüËÆ∞ÂΩïÂêóÔºü\n\nÂΩìÂâçËÆ∞ÂΩïÔºö' + currentRentData.count + 'Èó¥ÊàøÔºåÂÖ±¬•' + currentRentData.total)) {
            currentRentBackup = JSON.parse(JSON.stringify(currentRentData));
            currentRentData = { rooms: [], total: 0, count: 0 };
            saveData();
            updateCurrentRentDisplay();
        }
    }

    function restoreCurrentRent() {
        if (!currentRentBackup || currentRentBackup.count === 0) {
            alert('Ê≤°ÊúâÂèØÊÅ¢Â§çÁöÑËÆ∞ÂΩï');
            return;
        }
        currentRentData = JSON.parse(JSON.stringify(currentRentBackup));
        saveData();
        updateCurrentRentDisplay();
        alert('Â∑≤ÊÅ¢Â§çÔºö' + currentRentData.count + 'Èó¥ÊàøÔºåÂÖ±¬•' + currentRentData.total);
    }

</script>

<button id="floatSaveBtn" title="Ëá™Âä®‰øùÂ≠òÂ∑≤ÂêØÁî®" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(22, 163, 74); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s;"><i class="fas fa-check-circle"></i></button><div id="saveStatusTip" style="position: fixed; bottom: 80px; right: 20px; padding: 10px 18px; border-radius: 8px; font-size: 14px; z-index: 99999; transition: opacity 0.3s; box-shadow: rgba(0, 0, 0, 0.3) 0px 3px 12px; background: rgb(22, 163, 74); color: white; opacity: 0;">‚úì Ëá™Âä®‰øùÂ≠òÂ∑≤ÂêØÁî®</div><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1.1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s;"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1.1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1.1);"><i class="fas fa-save"></i></button><button id="floatSaveBtn" title="ÁÇπÂáªÂêØÁî®Ëá™Âä®‰øùÂ≠òÂà∞Êñá‰ª∂" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: rgb(79, 70, 229); color: white; border: none; cursor: pointer; box-shadow: rgba(79, 70, 229, 0.4) 0px 4px 15px; font-size: 22px; z-index: 99998; transition: 0.3s; transform: scale(1);"><i class="fas fa-save"></i></button></body></html>